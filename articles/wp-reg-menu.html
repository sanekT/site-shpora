<div class="wrap">
   
   <h2 class="header-stle">Регистрация меню и динамическое добавление меню из ВП</h2>
   <p>Адрес страницы articles/wp-reg-menu.html</p>
   
    <h3 class="header-style2">Регистрация меню</h3>
    <p>Когда мы активируем нашу новую тему, то в консоли во Внешнем виде нет подпункта Меню. Потому что мы не зарегистрировали ещё не одно меню. Давайте сделаем это. Чтобы найти функции отвечающие за регистрацию меню в яндекс поиске можем так и написать -> вордпресс регистрация меню. Находим и добавляем в <b>functions.php</b> action хук:</p>
    <p><b>functions.php</b></p>
    <div class="code-style">
        <pre>
        add_action('after_setup_theme', 'my_menu');
        
        function my_menu(){
            register_nav_menu('top_menu', 'меню в шапке');
            register_nav_menu('bottom_menu', 'меню в подвале');
        }
        </pre>
    </div>
    <p><b>top_menu</b> - это идентификатор к которому мы будем в вёрстке привязываться</p>
    <p><b>меню в шапке</b> - это описание меню, к которому мы в админке также будем привязываться.</p>
    <p>В админке теперь появился подпункт Меню в разделе Внешний вид. Зайдя в него мы можем теперь создать своё меню, дать название(например, "Верхнее меню"), вложить в него страницы или просто произвольные пока ссылки, записи, рубрики. Далее жмём создать меню и появляется вверху новая вкладка - Управление областями, вот там как раз и будет видна наша меню с описанием - "меню в шапке", напротив неё будет селект в котором и выбираем из списка наших созданных менюшек в админке, то меню котрое мы только что создали - "Верхнее меню". Всё теперь мы связали наши 2 менюшки, ту что в админке -  "Верхнее меню" с той что создали в functions.php - "меню в шапке". Осталось отобразить наше связанное меню в вёрстке по идентификатору "top_menu"</p>
    <p>Чтобы отобразить в вёрстке для этого есть функция <b>wp_nav_menu()</b>. Если её вот так и написать. то выведется первое попавшееся меню из админки. Чтобы вывести конкретное меню, то нужно указать рад настроек:</p>
    <div class="code-style">
        <pre>
            wp_nav_menu([
                'theme_location'  => '',
                'menu'            => '', 
                'container'       => 'div', 
                'container_class' => '', 
                'container_id'    => '',
                'menu_class'      => 'menu', 
                'menu_id'         => '',
                'echo'            => true,
                'fallback_cb'     => 'wp_page_menu',
                'before'          => '',
                'after'           => '',
                'link_before'     => '',
                'link_after'      => '',
                'items_wrap'      =>'< ul id="%1$s"class="%2$s">%3$s< /ul>',
                'depth'           => 0,
                'walker'          => '',
            ]);
        </pre>
    </div>
    <p>Этот список настроек по умолчанию, но нам нужны не все настройки.</p>
    <p><b>'theme_location'</b> - это как раз то место, где мы указываем идентификатор зарегистрированной меню - 'top_menu'</p>
    <p><b>'container'</b> - эта опция говорит о том в какой тег будет обёрнут наш список меню, если посмотреть в нашу вёрстку на то как сейчас выглядет меню:</p>
    <img src="../img/42.jpg" alt="" class="screen">
    <p>В ней помимо самого меню ещё есть и 2 ссылки, поэтому нам нужно отказаться от контейнера и прописать его в null(пока плохо разбираюсь в этом, позже уточню когда узнаю больше).</p>
    <p>Так как в вёрстке у спика ul есть и id и class, также значит прописываем их в опциях.</p>
    <p>Пока у нашего админского меню не выделяется активным выбранный элемент меню, на странице которого мы находимся. Для этого идём в DOM  и там ищем среди многих классов расставленных вордпрессом у li название такого класса как - "current-menu-item" и дальше в стилях нам нужно заменить наш класс "current" на "current-menu-item". С помощью инструментов разоаботчика находим где находится этот класс, нашли, он в файле layout.css  и меняем его на "current-menu-item"</p>
    <p>Дальше в принципе и идёт процесс подгонки стилей к нашему админовскому меню, а старое меню мы удаляем.</p>
    <p>Итоговые настройки для нашей менюшки:</p>
    <div class="code-style">
        <pre>
           &lt;?php
            wp_nav_menu([
                'theme_location'  => 'top_menu',
                'container'       => null,
                'menu_class'      => 'nav', 
                'menu_id'         => 'nav',
            ]);
            ?&gt;
        </pre>
    </div>
    <img src="../img/43.jpg" alt="" class="screen">
    <p class="note">Ещё хотел сказать такую вещь, вордпресс когда генерирует своё меню, то он навешивает свои классы на li, так вот если посмотреть на те классы, котрые он навешал, то там их будет куча целая. Среди них есть такой класс как "current-menu-item", он отвечает за стили текущей выбранной лишки. Поэтому если где то у нас в вёрстке есть класс "active" отвечающий за стили активной лишки, то этот класс "active" и нужно будет заменить на вордпрессовский "current-menu-item".</p>
    <p class="note">Ещё одно замечание. Когда при добалении в меню в админке новых страниц, мы можем добалять подстраницы для какой нибудь страницы и потом когда вордпресс создаст эту менюшку, то у страницы, у которой есть вложенные страницы, будет среди кучи других классов такой класс как "menu-item-has-children".</p>
    <p>Если надо посмотреть процесс подгонки стилей то можно посмотреть в видео начиная с 00:09:10</p>
    <iframe class="video" width="560" height="315" src="https://www.youtube.com/embed/JQcxO81ojBM" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
    
    
    
    <h3 class="header-style2">Добавляем динамически меню</h3>
    <p class="note">Это меню выводится в зависимости от количества созданых страниц. Если мы создадим какую нибудь страницу, то в меню она автоматически добавится, но тут и минус есть, заказчик может добавлять себе какие нибудь страницы и они будут просто кучей вылазить в меню.</p>
    <p>Это немного другой способ добавить меню, его мы уже не можем изменять из админки, оно только добавляется или удаляется в зависимости от добавления или удаления страниц(запись page). Например у нас есть вёрстака меню, удалим эту вёрстку и на её месте напишем код:</p>
    <div class="code-style">
        <pre>
        &lt;?php wp_nav_menu( [
            'container'       => 'ul', 
            'menu_class'      => 'top-nav-menu', 
            'menu_id'         => '',
            'echo'            => true,
            'fallback_cb'     => 'wp_page_menu',
            'before'          => '',
            'after'           => '',
            'link_before'     => '',
            'link_after'      => '',
            'items_wrap'      => '< ul id="%1$s" class="%2$s">%3$s< /ul>',
            'depth'           => 0,
            'walker'          => '',
        ] ); ?&gt;
        </pre>
    </div>
    <p>Указываем контейнер ul как у нас в вёрстке  и класс. Затем надо создать страницы точно такие как у нас в меню называются ссылки и главное, чтобы страницы шли в том порядке в какой они у нас в меню, нужно у каждой страницы нажать Свойство и выбрать порядок, начиная с 0. Сохраняем и должно на сайте вывестись точно такое же меню меню как и в вёрстке. если что в видео посмотреть с 00:09:05</p>
    <iframe class="video" width="560" height="315" src="https://www.youtube.com/embed/T1rIaG4asvg" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
</div>