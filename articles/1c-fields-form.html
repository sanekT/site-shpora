<div class="wrap">
   
    <h2 class="header-style">Реквизиты(поля) формы</h2>

    <p>Почему я вынес реквизиты формы в отдельную статью? Потому что они оказались не такими простыми как я думал. Поля, которые мы создаём не в объекте(справочник, документ и т.д.), а именно в форме этих объектов в закладке "Реквизиты", не сохраняются в БД, имеют более расширенные свойства, чем реквизиты объекта, для них доступны многие типы данных, которых нет у реквизита объекта. Реквизиты объекта, которые находятся в форме в главном реквизите "Объект", вообще не имеет свойств, там пусто, потому что для них уже свойства определены в миг их создания в объекте. В форме для реквизитов объекта есть лишь свойства оформительного характера, для этого реквизит нужно выделить в левой части формы в закладке "Элементы".</p>
    <img src="../img/1С-1/2023-02-24_14-24-49.png" alt="">
    <p>Как я понял, реквизиты формы предназначены для отображения какой то информации(в графическом, в табличном или ещё в каком то виде). Эту информацию они берут из других объектов, таблицы которых находятся в БД. Если пользователь как то меняет данные в этих реквизитах для записи их в БД, то эти поля используют для записи другие объекты, такие как документы, справочники, регистры.</p>
    <p>Реквизиты, которые находятся в объекте Объект служат для того, чтобы доставить первоначальные данные из БД для выбранного объекта.</p>
    <p>Ниже буду приводить примеры, как мы через реквизиты формы отображаем какие то данные.</p>
    <ul class="list">
        <li><a href="#1">Поле формы с типом "Динамический список"</a></li>
        <li><a href="#2">Поле формы с типом "Планировщик"</a>
            <p>Про сам планировщик можно посмотреть во внешней обработке "ЖурналЗаписей.epf". В этой обработке в форме создавали планировщик для конфигурации "КомнатаКрасоты". Там я описывал в модуле формы процедуры и функции, что они делают. События Планировщика:</p>
            <ul class="list">
                <li><a href="#1p">Событие "ПередСозданием"(перед созданием нового элемента планировщика)</a></li>
                <li><a href="#2p">Событие "ПередНачаломРедактирования"(перед началом изменения элемента планировщика)</a></li>
                <li><a href="#3p">Событие "ПередУдалением"(перед удалением элемента планировщика)</a></li>
                <li><a href="#4p">Событие "ПриОкончанииРедактирования"(при переносе элемента планировщика мышкой на другую позицию сетки)</a></li>
                <li><a href="#5p"></a></li>
                <li><a href="#"></a></li>
            </ul>
        </li>
        <li><a href="#3">Поле формы с типом "Диаграмма"</a></li>
        <li><a href="#4">Поле формы с типом "Цвет". Сохраняем цвет в базу.</a></li>
        <li><a href="#5">Поле формы с типом "ТабличныйДокумент"</a></li>
        <li><a href="#6">Поле формы с типом "ТаблицаЗначений"</a></li>
        <li><a href="#"></a></li>
        <li><a href="#"></a></li>
        <li><a href="#"></a></li>
        <li><a href="#"></a></li>
    </ul>












    <h2 class="header-style" id="1">Поле с типом "Динамический список". Отобразим через реквизит формы динамический список.</h2>
    <p>Динамический список это список, который отображают в форме списка документов, справочников. Когда мы открываем форму списка документа, то там вместо стандартного реквизита "Объект" отображается реквизит "Список" с типом "Динамический список".</p>
    <p>Часто бывает нужно отобразить список документов где то в другой форме(пусть это будет форма обработки "АБВ"). Для этого в этой другой форме создадим свой реквизит формы и назовём его "Список", дадаим ему тип "ДинамическийСписок" и в свойствах на закладке "Объект" укажем из какого объекта мы будем получать данные, для этого в свойстве "Основная таблица" выберем таблицу, например, из таблицы документа "Запись". И далее перетаскиваем этот реквизит влево к элементам формы. Сохраняем и если в 1с предприятии открыть форму обработки "АБВ", то увидим список документов Запись. Вот так легко мы отобразили список документов в поле "Список" формы обработки "АБВ".</p>
    <p>Можно не выбирать основную таблицу для отображения, а поставить галочку на свойстве "ПроизвольныйЗапрос" и  появится свойство рядом "НастройкаСписка" жмём "Открыть". Откроется окно динамического списка, в котром через конструктор запроса составляем запрос и также указываем основную таблицу. В чём разница между этими 2мя подходами? В том, что при произвольном запросе мы может отрегулировать отбор по полям, условиям, а при указании просто из "ОсновнойТаблицы" выводится вся таблица. Ну это как я понял.</p>














    <h2 class="header-style" id="1p">Событие &lt;ПередСозданием></h2>
    <p>На первый взгляд не понятно когда срабатывает это событие. Оно сработает, когда мы в планировщике мышью кликнем по пустому месту на сетке планировщика. Не сверху по элементам измерения, не слева по периодам, а именно по элементам планировщика на сетке, когда открывается окошко для создания нового элемента. Если есть уже элементы на сетке, то клик по ним ничего не даст, а сработает клик по пустому месту перед созданием нового элемента.</p>
    <p>Когда мы вешаем обработку на это событие, то система автоматом создаёт процедуру с несколькими аргументами. 2й и 3й аргумент это даты начала и конца времени. 4й аргумент "ЗначениеИзмерения" это фиксированное соответствие, где в ключе название измерения, а в значении элемент измерения. Последний аргумент это "Стандартная обработка". Этот параметр вызывает открытие окошка для создания нового элемента планировщика. Отключить стандартную обработку можно присвоив Ложь этому параметру.</p>












    <h2 class="header-style" id="2p">Событие &lt;ПередНачаломРедактирования></h2>
    <p>Это событие наступает в миг, когда кликаем 2 раза левой кнопкой мыши по элементу планировщика. По этому клику вылетает окно редактирования элемента планировщика. В обработчик этого события передаётся последним параметром переменная "СтандартнаяОбработка", она и отвечает за вылет окошка редактирования. Если этой переменной присвоить Ложь, то окошко не будет вылетать.</p>
    <p>Чтобы найти элемент планировщика, который мы редактируем в данный миг, то нужно обратится к 1му параметра обработчика "Элемент". Этот параметр содержит поле формы с типом Планировщик, у этого параметра есть свойство "ВыделенныеЭлементы", оно возвращает фиксированный массив с одним элементом массива. Там под индексом 0 и лежит значение элемента планировщика, по которому мы кликнули 2 раза. Это похоже как у поля формы с табличной частью есть свойство ТекущиеДанные или ТекущаяСтрока.</p>
    <p>Когда ещё срабатывает это событие? При одинарном клике по элементу планировщика открывается стандартное окошко с кнопками редиктирования, удаления и закрытия. Вот когда жмём кнопку редактирования сработает событие "ПередНачаломРедактирования".</p>












    <h2 class="header-style" id="3p">Событие &lt;ПередУдалением></h2>
    <p>Когда кликаем один раз по элементу планировщика, то открывается стандартное окошко с краткой информацией о элементе и 3мя кнопками: редактирование, удаление и закрытие. Вот при нажатии на кнопку Удаление и сработает это событие. Чтобы отменить удаление нужно в обработчике параметру "Отказ" задать Истина.</p>












    <h2 class="header-style" id="4p">Событие &lt;ПриОкончанииРедактирования></h2>
    <p>Событие возникает при перетаскивании мышью элемента планировщика и при растягивании элемента планировщика.</p>









    <h2 class="header-style" id="3">Поле формы с типом "Диаграмма".</h2>
    <p>Создадим реквизит "Диаграмма" в форме обработки "АБВ", задаим тип для этого поля "Диаграмма". В свойствах этого поля на закладке "Объект" нажмём Настройка - Открыть. Откроется ещё много закладок для настройки диаграммы. Не буду все настройки описывать, если будет нужно то в этом видео - https://www.youtube.com/watch?v=spclh5KlqYI&t=3287s  смотреть с 03:05:00.</p>
    <p>Отображать будем, например, деньги пришедшие к нам за один день. Отображать будем деньги наличные и безналичные. Брать эти данные будем из регистра накопления "Деньги". Этот регистр накапливает все деньги приходящие и уходящие. Чтобы взять данные из базы, будем использовать табличную модель запроса. Также брать данные будем из виртуальной таблицы "Деньги.Обороты".</p>
    <div class="code-style">
        <pre>
            <span class="vue-g">//диаграмма будет отображать наличные и безналичные деньги, поступающие к нам за день
            //данные будем брать из регистра накопления "Деньги" </span>
            <span class="vue-b"><span class="vue-r">&НаСервере
            Процедура</span> ЗаполнитьДиаграмму<span class="vue-r">()</span>
                Диаграмма<span class="vue-r">.</span>Очистить<span class="vue-r">();</span>
                
                Запрос <span class="vue-r">= Новый</span> Запрос;
                Запрос<span class="vue-r">.</span>Текст <span class="vue-r">=</span> 
                    <span class="vue-bl">"ВЫБРАТЬ
                    |	ДеньгиОбороты.ТипДенежныхСредств КАК ТипДенежныхСредств,
                    |	ДеньгиОбороты.СуммаОборот КАК СуммаОборот
                    |ИЗ
                    |	РегистрНакопления.Деньги.Обороты(НАЧАЛОПЕРИОДА(&Дата, ДЕНЬ), КОНЕЦПЕРИОДА(&Дата, ДЕНЬ), День, ) КАК ДеньгиОбороты"</span><span class="vue-r">;</span>
                
                Запрос<span class="vue-r">.</span>УстановитьПараметр<span class="vue-r">(</span><span class="vue-bl">"Дата"</span>, Дата<span class="vue-r">);</span>
                РезультатЗапроса <span class="vue-r">=</span> Запрос<span class="vue-r">.</span>Выполнить<span class="vue-r">();</span>
                Выборка <span class="vue-r">=</span> РезультатЗапроса<span class="vue-r">.</span>Выбрать<span class="vue-r">();</span>

                <span class="vue-g">//далее тут будем описывать как программно составить диагрумму
                //в нашем случае у нас диаграмма круговая кольцевая. Точка у нас бедет одна в центре круга
                //каждый сектор на круге это серия</span>
                Точка <span class="vue-r">=</span> Диаграмма<span class="vue-r">.</span>Точки<span class="vue-r">.</span>Добавить<span class="vue-r">(</span><span class="vue-bl">""</span><span class="vue-r">);</span>

                <span class="vue-r">Пока</span> Выборка<span class="vue-r">.</span>Следующий<span class="vue-r">() Цикл</span>
                    <span class="vue-g">//далее создаём серии. Серии будут отображать тип денежных средств</span>
                    Серия <span class="vue-r">=</span> Диаграмма<span class="vue-r">.</span>Серии<span class="vue-r">.</span>Добавить<span class="vue-r">(</span>Строка<span class="vue-r">(</span>Выборка<span class="vue-r">.</span>ТипДенежныхСредств<span class="vue-r">));</span>

                    <span class="vue-g">//на пересечении точки - начало серии и точки - конец серии это сумма типа денежных средств</span>
                    Диаграмма<span class="vue-r">.</span>УстановитьЗначение<span class="vue-r">(</span>Точка, Серия, Выборка<span class="vue-r">.</span>СуммаОборот<span class="vue-r">);
                КонецЦикла;
                
            КонецПроцедуры</span></span>                  
        </pre>
    </div>










    <h2 class="header-style" id="4">Поле формы с типом "Цвет". Сохраняем цвет в базу.</h2>
    <p>Предположим у нас есть документ с реквизитами, один из реквизитов "ЦветФона", мы в каком то месте системы(в режиме 1сПредприятие) вызываем форму этого документа и хотим выбрать цвет в рекизите "ЦветФона". Тут загвоздка в чём? В том что когда мы создаём реквизит "ЦветФона" у документа, то ему не доступен тип "Цвет"(чтобы была возможность из списка выбирать цвета), но такое поле можно добавить в форме документа в закладке "Реквизиты". Добавляем новое поле "Цвет" и ставим ему тип "Цвет", перенесём это поле в левую область в элементы, а поле "ЦветФона" уберем оттуда. Теперь при открытии формы документа в системе мы увидим поле "Цвет" и можем в списке выбрать сам цвет. Но система так устроенна, что реквизиты, которые добавленны в форме не сохраняются в базе. Нам надо как то сохранить выбранный цвет в базе. Мы уже выше создали реквизит "ЦветФона" у документа, ему нужно поставить тип "ХранилищеЗначения". В этом поле и будем хранить выбранный цвет из поля формы.</p>
    <p>У формы документа есть событие "ПередЗаписьюНаСервере", это событие доступно из расширения документа для формы. Создаём обработчик этого события, он будет иметь 3 параметра. Нам нужен 2й - ТекущийОбъект, который содержит текущий ДокументОбъект.</p>
    <div class="code-style">
        <pre>
            <span class="vue-b"><span class="vue-r">&НаСервере
            Процедура</span> ПередЗаписьюНаСервере<span class="vue-r">(</span>Отказ, ТекущийОбъект, ПараметрыЗаписи<span class="vue-r">)</span>
                <span class="vue-g">//реквизит "ЦветФона" уже имеет тип ХранилищеЗначений, значит в него можно положить объект класса ХранилищеЗначений
                //в качестве параметра для класса передадим цвет выбранный в поле формы "Цвет"</span>
                ТекущийОбъект<span class="vue-r">.</span>ЦветФона <span class="vue-r">= Новый</span> ХранилищеЗначения<span class="vue-r">(</span>Цвет<span class="vue-r">);	
            КонецПроцедуры</span></span>
        </pre>
    </div>
    <p>Также, когда мы открываем уже созданный ранее объект документа в форме, то поле "Цвет" надо заполнить ранее выбранным цветом. Этот цвет должен уже храниться в базе в поле "ЦветФона" с типом "ХранилищеЗначений". Для этого будем использовать ещё одно событие "ПриЧтенииНаСервере".</p>
    <div class="code-style">
        <pre>
            <span class="vue-b"><span class="vue-r">&НаСервере
            Процедура</span> ПриЧтенииНаСервере<span class="vue-r">(</span>ТекущийОбъект<span class="vue-r">)</span>
                <span class="vue-g">//при открытии формы документа нужно заполнить поле формы "Цвет" значением из базы из поля "ЦветФормы", куда мы ранее
                //уже записали значение цвета. Если там ещё нет цвета, то мы можем установить наш цвет по умолчанию</span>
                <span class="vue-r">Если</span> ТекущийОбъект<span class="vue-r">.</span>ЦветФона<span class="vue-r">.</span>Получить<span class="vue-r">() &lt;></span> Неопределено <span class="vue-r">Тогда</span>
                    Цвет <span class="vue-r">=</span> ТекущийОбъект<span class="vue-r">.</span>ЦветФона<span class="vue-r">.</span>Получить<span class="vue-r">();
                Иначе</span>
                    Цвет <span class="vue-r">=</span> WebЦвета<span class="vue-r">.</span>СинеСерый<span class="vue-r">;
                КонецЕсли;
            КонецПроцедуры</span></span>
        </pre>
    </div>











    <h2 class="header-style" id="5">Поле формы с типом "ТабличныйДокумент".</h2>
    <p>В рекизит с типом "табличный документ" можно загружать данные из файла excel. Об этом рассказано в статье про файлы.</p>
    <p><span class="vue-b">1й пример</span>.</p>
    <p>Создадим внутреннюю обработку ТабличныйДокумент, добавим форму. В форме добавим команду ВыполнитьЗапрос, также добавим реквизит формы ТабДок(назвали так потому что по умолчанию конструктор заполняет переменную именно с таким именем). На команду вешаем обработчик с процедурой на клиенте и на сервере. Открываем конструктор запроса и выбираем Тип обработки - Вывод в табличный документ. Всё, составляем запрос и выводим код. Автоматом раскроется код с запросом и выводом его ответа в табличный документ, ещё и макет создастся в объекте Макеты, в котром можно поправлять что и куда выводить:</p>
    <div class="code-style">
        <pre>
            &НаКлиенте
            Процедура ВыполнитьЗапрос(Команда)
                ВыполнитьЗапросНаСервере();
            КонецПроцедуры

            &НаСервере
            Процедура ВыполнитьЗапросНаСервере()	
                Макет = Обработки.ТабличныйДокумент.ПолучитьМакет("Макет1");
                Запрос = Новый Запрос;
                Запрос.Текст = 
                    "ВЫБРАТЬ
                    |	ПоступлениеТоваровТовары.Товар КАК Товар,
                    |	ПРЕДСТАВЛЕНИЕ(ПоступлениеТоваровТовары.Товар) КАК ТоварПредставление,
                    |	СУММА(ПоступлениеТоваровТовары.Количество) КАК Количество,
                    |	СУММА(ПоступлениеТоваровТовары.Сумма) КАК Сумма
                    |ИЗ
                    |	Документ.ПоступлениеТоваров.Товары КАК ПоступлениеТоваровТовары
                    |
                    |СГРУППИРОВАТЬ ПО
                    |	ПоступлениеТоваровТовары.Товар";
                
                РезультатЗапроса = Запрос.Выполнить();
                
                ОбластьЗаголовок = Макет.ПолучитьОбласть("Заголовок");
                ОбластьПодвал = Макет.ПолучитьОбласть("Подвал");
                ОбластьШапкаТаблицы = Макет.ПолучитьОбласть("ШапкаТаблицы");
                ОбластьПодвалТаблицы = Макет.ПолучитьОбласть("ПодвалТаблицы");
                ОбластьДетальныхЗаписей = Макет.ПолучитьОбласть("Детали");
                
                ТабДок.Очистить();
                ТабДок.Вывести(ОбластьЗаголовок);
                ТабДок.Вывести(ОбластьШапкаТаблицы);
                ТабДок.НачатьАвтогруппировкуСтрок();
                
                Выборка = РезультатЗапроса.Выбрать();
                
                Пока Выборка.Следующий() Цикл
                    ОбластьДетальныхЗаписей.Параметры.Заполнить(Выборка);
                    ТабДок.Вывести(ОбластьДетальныхЗаписей, Выборка.Уровень());
                КонецЦикла;
                
                ТабДок.ЗакончитьАвтогруппировкуСтрок();
                ТабДок.Вывести(ОбластьПодвалТаблицы);
                ТабДок.Вывести(ОбластьПодвал);    
            КонецПроцедуры
        </pre>
    </div>

    <p><span class="vue-b">2й пример</span>.</p>
    <p>Не будем делать никуда никакие запросы, сразу на клиенте по клику на кнопку заполняем табличный документ. Источник данных можно подобрать любой, либо из файла excel, либо из таблицы БД, либо ещё откуда то.</p>
    <p>Также в форме обработчика создадим реквизит "Excel" и зададим ему тип "ТабличныйДокумент". Рядом создадим кнопку "ЗаполнитьТабличныйДокумент". Зададим кнопке обработчик на клиенте:</p>
    <div class="code-style">
        <pre>
            &НаКлиенте
            Процедура ЗаполнитьТабличныйДокумент(Команда)
                //а переменную получили объект реквизита "Excel" для удобства
                ТабДок = Excel;
                
                //обращаемся к ячейке первой строки и первого столбца 
                //и через точку будут доступны свойства и методы для работы с ячейкой
                ТабДок.Область("R1C1").Текст = "Какой то текст";
            
                //выводим в цикле в одном столбце вниз 
                Для Шаг = 2 По 10 Цикл
                   ТабДок.Область("R"+ Шаг + "C1").Текст = "Какой то текст";
                КонецЦикла;
            КонецПроцедуры            
        </pre>
    </div>

    <p><span class="vue-b">3й пример</span >.</p>
    <p>Будем программно составлть отчёт без использования СКД. Для этого создадим Отчет "ОстаткиТоваров". Создадим форму отчёта(в конструкторе выбираем Форма отчета). В форме создадим кнопку для формирования отчёта и также создаём реквизит ТабДок с типом "ТабличныйДокумент" и размещаем их на форме. На кнопку вешаем обработчик, в котором нам нужно вызвать процедуру из модуля объекта этого отчёта. Для этого основной реквизит формы Отчет переделываем в объект:</p>
    <div class="code-style">
        <pre>
            <span class="vue-b"><span class="vue-r">&НаКлиенте
            Процедура</span> СформироватьОтчёт<span class="vue-r">(</span>Команда<span class="vue-r">)</span>
                СформироватьОтчётНаСервере<span class="vue-r">();
            КонецПроцедуры

            &НаСервере
            Процедура</span> СформироватьОтчётНаСервере<span class="vue-r">()</span>
                ОтчетОбъект <span class="vue-r">=</span> РеквизитФормыВЗначение<span class="vue-r">(</span><span class="vue-bl">"Отчет"</span><span class="vue-r">);</span>
                ОтчетОбъект<span class="vue-r">.</span>СформироватьОтчет<span class="vue-r">(</span>ТабДок<span class="vue-r">);
            КонецПроцедуры</span></span>
        </pre>
    </div>
    <p>Теперь нам нужно создать макет "ТабличныйДокумент", обозначит там шапку таблицы и строки таблицы. Затем идём в модуль объекта отчета и пишем процедуру, которая получает из макета данные и записывает в реквизит формы ТабДок:</p>
    <div class="code-style">
        <pre>
            --модуль объекта отчета
            <span class="vue-b"><span class="vue-r">Процедура</span> СформироватьОтчет<span class="vue-r">(</span>ТабДок<span class="vue-r">) Экспорт</span>
                ТабДок<span class="vue-r">.</span>Очистить<span class="vue-r">();</span>

                <span class="vue-g">//первый шаг - прочитать данные из БД</span>	
                Запрос <span class="vue-r">= Новый</span> Запрос<span class="vue-r">;</span>
                Запрос<span class="vue-r">.</span>Текст <span class="vue-r">=</span> 
                    <span class="vue-bl">"ВЫБРАТЬ
                    |	ПРЕДСТАВЛЕНИЕССЫЛКИ(ТоварыНаСкладахОстатки.Номенклатура) КАК Номенклатура,
                    |	ПРЕДСТАВЛЕНИЕССЫЛКИ(ТоварыНаСкладахОстатки.Склад) КАК Склад,
                    |	ТоварыНаСкладахОстатки.КоличествоОстаток КАК Остаток
                    |ИЗ
                    |	РегистрНакопления.ТоварыНаСкладах.Остатки(&Период, ) КАК ТоварыНаСкладахОстатки"</span><span class="vue-r">;</span>
                
                ВыбраннаяДата <span class="vue-r">= ?(</span>ЗначениеЗаполнено<span class="vue-r">(</span>ДатаОстатков<span class="vue-r">),</span> КонецДня<span class="vue-r">(</span>ДатаОстатков<span class="vue-r">) +</span> 1<span class="vue-r">,</span> ТекущаяДата<span class="vue-r">());</span>
                Запрос<span class="vue-r">.</span>УстановитьПараметр<span class="vue-r">(</span><span class="vue-bl">"Период"</span><span class="vue-r">,</span> ВыбраннаяДата<span class="vue-r">);</span>	
                РезультатЗапроса <span class="vue-r">=</span> Запрос<span class="vue-r">.</span>Выполнить<span class="vue-r">();</span>
                Выборка <span class="vue-r">=</span> РезультатЗапроса<span class="vue-r">.</span>Выбрать<span class="vue-r">();</span>

                <span class="vue-g">//второй шаг - вывести данные в табличный документ
                
                //получаем макет связанный с этим отчётом</span>
                МакетОстатки <span class="vue-r">=</span> ПолучитьМакет<span class="vue-r">(</span><span class="vue-bl">"Остатки"</span><span class="vue-r">);</span>

                <span class="vue-g">//получаем область шапки из макета</span>
                ОбластьШапки <span class="vue-r">=</span> МакетОстатки<span class="vue-r">.</span>ПолучитьОбласть<span class="vue-r">(</span><span class="vue-bl">"ШапкаТаблицы"</span><span class="vue-r">);</span>

                <span class="vue-g">//выводим область шапки в табличный документ</span>
                ТабДок<span class="vue-r">.</span>Вывести<span class="vue-r">(</span>ОбластьШапки<span class="vue-r">);</span>

                <span class="vue-g">//до цикла мы должны вывести шапку таблицы, чтобы её вывести нужно выше по коду получить макет, связанный с этим отчётом</span>	
                <span class="vue-r">Пока</span> Выборка<span class="vue-r">.</span>Следующий<span class="vue-r">() Цикл</span>
                    ОбластьСтроки <span class="vue-r">=</span> МакетОстатки<span class="vue-r">.</span>ПолучитьОбласть<span class="vue-r">(</span><span class="vue-bl">"СтрокаТаблицы"</span><span class="vue-r">);</span>
                    <span class="vue-g">//так как Выборка это объект с данными из БД, то он подойдёт для заполнения параметров в строках макета
                    //только нужно чтобы имена получаемых полей из БД совпадали с именами параметров в макете</span>
                    ОбластьСтроки<span class="vue-r">.</span>Параметры<span class="vue-r">.</span>Заполнить<span class="vue-r">(</span>Выборка<span class="vue-r">);</span>
                    ТабДок<span class="vue-r">.</span>Вывести<span class="vue-r">(</span>ОбластьСтроки<span class="vue-r">);	
                КонецЦикла;	
            КонецПроцедуры</span></span>
        </pre>
    </div>

    <p><span class="vue-b">4й пример</span >.</p>
    <p><span class="vue-r">Чтобы дать имя области в макете и область слева от линейки была видна, нужно выделять ячейки не внутри линейки, а захватывать и линейку тоже, т.е. кликать по цифрам на линейке и строки будут выделяться</span>.</p>
    <p>Этот пример будет очень похож на 3й, только выводить буду другое и модуль объекта отчета трогать не буду, а всё будет в модуле формы. Также будем вручную создавать отчет не испоользуя СКД.</p>
    <p>Есть справочник Номенклатура и у этого справочника есть помимо других ещё и реквизит ЦенаТовара. Пользователь попросил нас сделать таблицу этих цен для распечатки. Вообще можно и не делать всё то, что мы хотим делать, можно в пользовательской части открыть список товаров и в подменю "Ещё" выбрать пункт "Вывести список", откроется окно настройки, в нём выбираем нужные нам реквизиты, указываем "С подчинёнными" и указываем в какой формат нам выводить, а именно в Табличный документ, жмём ОК. Откроется табличные документ с таблицей наших товаров и цен и жмём "Печать" в подменю "Ещё" или в другом месте. Всё, таблица готова для печати. Но это самый простой и малонастраиваемый способ. Это вот прям когда быстро надо.</p>
    <p>Мы же сделаем таблицу с ценами в виде отчета. Делаем то же самое, создаём отчет "СписокЦен", создаём форму, в форме создаём реквизит ТабДок с типом Табличный документ. Делаем кнопку "СформироватьСписок" и размещаем на форме. Создаём обработчик для кнопки на клиенте и на сервере. На сервере получаем выборку из справочника и модно выводить в табличный документ. Можно обойтись и без макета и выводит самому в табличный документ, но это долго. Макет позволяет как бы от руки накидать где шапака, а где элементы. Создаём макет у этого отчета.</p>
    <p>Отсортировать выборку можно несколькими способами. Можно в методе Выбрать() 4м параметром указать "Код ВОЗР", что приведёт к сортированию по полю Код по возрастанию. Можно указать вместо метода Выбрать() метод ВыбратьИерархически(), что приведёт к тому, что записи будут точно так как они находятся в форме списка справочника, т.е. идут группы, потом элементы принадлежащие этой группе и т.д. Метод Выбрать() просто по азбуке выстраивал записи, т.е. вразброс группы и элементы.</p>
    <p>графическая схема:</p>
    <img src="../img/1С-1/2023-05-29_10-08-59.png" class="screen" alt="">
    <p>По условию нужно ещё сделать поле с галочкой Услуги, по которому мы или показываем в отчете услуги или нет. Также нужно выделить группы жирным шрифтом. Есть 2 способа сделать жирный шрифт для групп, программный и через макет. Макеты вообще в своё время придумали для того, чтобы уйти от сложного программного кода для табличного документа. В макете от руки накидываем что нам нужно и программировать уже легче. В первом способе программно рисуем жирный шрифт, во втором в макете:</p>
    <div class="code-style">
        <pre>
            --первый способ
            <span class="vue-b"><span class="vue-r">&НаКлиенте
            Процедура</span> СформироватьСписок<span class="vue-r">(</span>Команда<span class="vue-r">)</span>
                СформироватьСписокНаСервере<span class="vue-r">(</span>ТабДок<span class="vue-r">,</span> Услуги<span class="vue-r">);
            КонецПроцедуры

            &НаСервере
            Процедура</span> СформироватьСписокНаСервере<span class="vue-r">(</span>ТабДок<span class="vue-r">,</span> Услуги<span class="vue-r">) </span>
                ТабДок<span class="vue-r">.</span>Очистить<span class="vue-r">();</span>

                Выборка <span class="vue-r">=</span> Справочники<span class="vue-r">.</span>Номенклатура<span class="vue-r">.</span>ВыбратьИерархически<span class="vue-r">();</span>   
                
                МакетСпискаЦен <span class="vue-r">=</span> Отчеты<span class="vue-r">.</span>СписокЦен<span class="vue-r">.</span>ПолучитьМакет<span class="vue-r">(</span><span class="vue-bl">"ПечатьСпискаЦен"</span><span class="vue-r">);</span>
                
                ОблШапка <span class="vue-r">=</span> МакетСпискаЦен<span class="vue-r">.</span>ПолучитьОбласть<span class="vue-r">(</span><span class="vue-bl">"Шапка"</span><span class="vue-r">); </span>
                ОблШапка<span class="vue-r">.</span>Параметры<span class="vue-r">.</span>ДатаЗаголовка <span class="vue-r">=</span> Формат<span class="vue-r">(</span>ТекущаяДата<span class="vue-r">(),</span> <span class="vue-bl">"ДЛФ=DD"</span><span class="vue-r">);</span> 
                ТабДок<span class="vue-r">.</span>Вывести<span class="vue-r">(</span>ОблШапка<span class="vue-r">);</span>

                ОблЭлементы <span class="vue-r">=</span> МакетСпискаЦен<span class="vue-r">.</span>ПолучитьОбласть<span class="vue-r">(</span><span class="vue-bl">"Элементы"</span><span class="vue-r">);</span>	
                
                <span class="vue-r">Пока</span> Выборка<span class="vue-r">.</span>Следующий<span class="vue-r">() Цикл</span>
                    ОблЭлементы<span class="vue-r">.</span>Параметры<span class="vue-r">.</span>Заполнить<span class="vue-r">(</span>Выборка<span class="vue-r">); </span>

                    <span class="vue-g">//если Услуга не отмечана, значит пропускаем круг цикла</span>
                    <span class="vue-r">Если НЕ</span> Услуги <span class="vue-r">И</span> Выборка<span class="vue-r">.</span>Услуга <span class="vue-r">Тогда
                        Продолжить;		
                    КонецЕсли;</span>

                    <span class="vue-r">Если</span> Выборка<span class="vue-r">.</span>ЭтоГруппа <span class="vue-r">Тогда</span>
                        <span class="vue-g">//если это группа, то рисуем жирный шрифт</span>
                        ОблЭлементы<span class="vue-r">.</span>Области<span class="vue-r">.</span>Элементы<span class="vue-r">.</span>Шрифт <span class="vue-r">= Новый</span> Шрифт<span class="vue-r">(</span><span class="vue-bl">"Arial"</span><span class="vue-r">,</span> 10<span class="vue-r">,</span>Истина<span class="vue-r">);</span>
                        ТабДок<span class="vue-r">.</span>Вывести<span class="vue-r">(</span>ОблЭлементы<span class="vue-r">);
                        Продолжить;
                    КонецЕсли;</span>
                    <span class="vue-g">//если не группа, то обычный шрифт</span>
                    ОблЭлементы<span class="vue-r">.</span>Области<span class="vue-r">.</span>Элементы<span class="vue-r">.</span>Шрифт <span class="vue-r">= Новый</span> Шрифт<span class="vue-r">(</span><span class="vue-bl">"Arial"</span><span class="vue-r">,</span> 8<span class="vue-r">);</span>
                    ТабДок<span class="vue-r">.</span>Вывести<span class="vue-r">(</span>ОблЭлементы<span class="vue-r">); 
                КонецЦикла;
            КонецПроцедуры</span></span>
        </pre>
    </div>
    <p>Во 2й способе мы в макете просто копируем область "Элементы" и ниже её вставляем и даём другое имя, например, "Группы". Для области "Группы" поставим жирный шрифт. Всё, теперь в коде мы просто выбираем нужную нам область в зависимости от того, группа сейчас в выборке в цикле или нет. Я такого не знал раньше. По сути в макете можно понаделать кучу разных областей и по разному их оформить и затем в коде под разные случаи выбирать нужную область и выводить её в ТабДок. Получается как выглядит макет не означает, что также будет выглядеть инфа в табличном документе, макет это как черновик, где мы от руки оформляем и выводим то что нам нужно в ТабДок:</p>
    <img src="../img/1С-1/2023-05-29_19-29-23.png" class="screen" alt="">
    <p>В области "Элементы" можно даже выделить ячейку с параметром "Наименование" и в палитре свойств на закладке "Положение" для свойства "ОтступСлева" задать 2. Теперь у нас товары будут немного сдвинуты вправо, делая видимость вложенности в группы.</p>
    <div class="code-style">
        <pre>
            --второй способ через макет
            <span class="vue-b"><span class="vue-r">&НаКлиенте
            Процедура</span> СформироватьСписок<span class="vue-r">(</span>Команда<span class="vue-r">)</span>
                СформироватьСписокНаСервере<span class="vue-r">(</span>ТабДок<span class="vue-r">,</span> Услуги<span class="vue-r">);
            КонецПроцедуры

            &НаСервере
            Процедура</span> СформироватьСписокНаСервере<span class="vue-r">(</span>ТабДок<span class="vue-r">,</span> Услуги<span class="vue-r">) </span>
                ТабДок<span class="vue-r">.</span>Очистить<span class="vue-r">();</span>

                Выборка <span class="vue-r">=</span> Справочники<span class="vue-r">.</span>Номенклатура<span class="vue-r">.</span>ВыбратьИерархически<span class="vue-r">();</span>   
                
                МакетСпискаЦен <span class="vue-r">=</span> Отчеты<span class="vue-r">.</span>СписокЦен<span class="vue-r">.</span>ПолучитьМакет<span class="vue-r">(</span><span class="vue-bl">"ПечатьСпискаЦен"</span><span class="vue-r">);</span>
                
                ОблШапка <span class="vue-r">=</span> МакетСпискаЦен<span class="vue-r">.</span>ПолучитьОбласть<span class="vue-r">(</span><span class="vue-bl">"Шапка"</span><span class="vue-r">); </span>
                ОблШапка<span class="vue-r">.</span>Параметры<span class="vue-r">.</span>ДатаЗаголовка <span class="vue-r">=</span> Формат<span class="vue-r">(</span>ТекущаяДата<span class="vue-r">(),</span> <span class="vue-bl">"ДЛФ=DD"</span><span class="vue-r">);</span> 
                ТабДок<span class="vue-r">.</span>Вывести<span class="vue-r">(</span>ОблШапка<span class="vue-r">);</span>

                ОблЭлементы <span class="vue-r">=</span> МакетСпискаЦен<span class="vue-r">.</span>ПолучитьОбласть<span class="vue-r">(</span><span class="vue-bl">"Элементы"</span><span class="vue-r">);</span>	
                <span style="text-decoration:underline;">ОблГруппа <span class="vue-r">=</span> МакетСпискаЦен<span class="vue-r">.</span>ПолучитьОбласть<span class="vue-r">(</span><span class="vue-bl">"Группы"</span><span class="vue-r">);</span></span>	
                
                <span class="vue-r">Пока</span> Выборка<span class="vue-r">.</span>Следующий<span class="vue-r">() Цикл</span>
                    <span class="vue-g">//если Услуга не отмечана, значит пропускаем круг цикла</span>
                    <span class="vue-r">Если НЕ</span> Услуги <span class="vue-r">И</span> Выборка<span class="vue-r">.</span>Услуга <span class="vue-r">Тогда
                        Продолжить;		
                    КонецЕсли;</span>

                    <span class="vue-r">Если</span> Выборка<span class="vue-r">.</span>ЭтоГруппа <span class="vue-r">Тогда</span>
                        <span class="vue-g">//если это группа, то рисуем жирный шрифт заполняя и выводя область "Группы"</span>
                        <span style="text-decoration:underline;">ОблГруппа<span class="vue-r">.</span>Параметры<span class="vue-r">.</span>Заполнить<span class="vue-r">(</span>Выборка<span class="vue-r">); </span></span>
                        ТабДок<span class="vue-r">.</span>Вывести<span class="vue-r">(</span>ОблГруппа<span class="vue-r">);
                        Продолжить;
                    КонецЕсли;</span>
                    <span class="vue-g">//если не группа, то обычный шрифт заполняя и выводя область "Элементы"</span>
                    ОблЭлементы<span class="vue-r">.</span>Параметры<span class="vue-r">.</span>Заполнить<span class="vue-r">(</span>Выборка<span class="vue-r">); </span>
                    ТабДок<span class="vue-r">.</span>Вывести<span class="vue-r">(</span>ОблЭлементы<span class="vue-r">); 
                КонецЦикла;
            КонецПроцедуры</span></span>
        </pre>
    </div>
    <p>Всё это можно сделать и с помощью конструктора запроса. Выбираем в контекстном меню "Конструктор запроса с обработкой результата" и в конструкторе выбираем вывод в табличный документ. Получится всё тоже самое с макетои прочее только через конструктор, ну правда самому придётся чуть подшаманить с жирными шрифтами и прочими приблудами.</p>

    <p><span class="vue-b">5й пример</span >.</p>
    <p>Выводим закупки товаров из документа "ПоступлениеТоваров". В запросе выбираем также представление ссылок на контрагентов и на номенклатуру, чтобы потом в цикле система сама не бегеле к БД и не получала отдельно представление для этих ссылок. В запросе можно было бы и не выбирать сами ссылки, но ссылки нам нужны для группировки.</p>
    <p><span class="vue-r">Важно!!! Реквизит с табличным документом можно и не создавать, можно прям в коде создать объект от класса Табличный документ в него всё записать и под конец показать с помощью метода Показать(). В пользовательсой части табличный документ с данными откроется в новом окне.</span></p>
    <div class="code-style">
        <pre>
            <span class="vue-b"><span class="vue-r">&НаКлиенте
            Процедура</span> СформироватьОтчет<span class="vue-r">(</span>Команда<span class="vue-r">)</span>
                СформироватьОтчетНаСервере<span class="vue-r">(</span>ТабДок<span class="vue-r">);
            КонецПроцедуры

            &НаСервереБезКонтекста
            Процедура</span> СформироватьОтчетНаСервере<span class="vue-r">(</span>ТабДок<span class="vue-r">)</span>
                ТабДок<span class="vue-r">.</span>Очистить<span class="vue-r">();</span>

                МакетДляЗакупок <span class="vue-r">=</span> Отчеты<span class="vue-r">.</span>ЗакупкиПоДокументам<span class="vue-r">.</span>ПолучитьМакет<span class="vue-r">(</span><span class="vue-bl">"МакетДляЗакупок"</span><span class="vue-r">);</span>

                ОблШапка <span class="vue-r">=</span> МакетДляЗакупок<span class="vue-r">.</span>ПолучитьОбласть<span class="vue-r">(</span><span class="vue-bl">"Шапка"</span><span class="vue-r">);</span>
                ОблШапка<span class="vue-r">.</span>Параметры<span class="vue-r">.</span>ДатаШапки <span class="vue-r">=</span> ТекущаяДата<span class="vue-r">();</span>
                ТабДок<span class="vue-r">.</span>Вывести<span class="vue-r">(</span>ОблШапка<span class="vue-r">);</span>

                Запрос <span class="vue-r">= Новый</span> Запрос<span class="vue-r">;</span>
                Запрос<span class="vue-r">.</span>Текст <span class="vue-r">=</span> 
                    <span class="vue-bl">"ВЫБРАТЬ
                    |	ПоступлениеТоваровТовары.Ссылка.Контрагент,
                    |	ПРЕДСТАВЛЕНИЕ(ПоступлениеТоваровТовары.Ссылка.Контрагент) КАК Контрагент,
                    |	ПоступлениеТоваровТовары.Номенклатура,
                    |	ПРЕДСТАВЛЕНИЕ(ПоступлениеТоваровТовары.Номенклатура) КАК Номенклатура,
                    |	СУММА(ПоступлениеТоваровТовары.Количество) КАК Количество,
                    |	СУММА(ПоступлениеТоваровТовары.Сумма) КАК Сумма
                    |ИЗ
                    |	Документ.ПоступлениеТоваров.Товары КАК ПоступлениеТоваровТовары  
                    |СГРУППИРОВАТЬ ПО
                    |	ПоступлениеТоваровТовары.Ссылка.Контрагент,
                    |	Номенклатура
                    |	
                    |ИТОГИ СУММА(Сумма) 
                    |ПО ОБЩИЕ, Контрагент	"</span><span class="vue-r">;</span>
                
                РезультатЗапроса <span class="vue-r">=</span> Запрос<span class="vue-r">.</span>Выполнить<span class="vue-r">();</span>
                Выборка <span class="vue-r">=</span> РезультатЗапроса<span class="vue-r">.</span>Выбрать<span class="vue-r">();</span>
                
                ОблЭлементы <span class="vue-r">=</span> МакетДляЗакупок<span class="vue-r">.</span>ПолучитьОбласть<span class="vue-r">(</span><span class="vue-bl">"Элементы"</span><span class="vue-r">);</span>
                ОблИтоги <span class="vue-r">=</span> МакетДляЗакупок<span class="vue-r">.</span>ПолучитьОбласть<span class="vue-r">(</span><span class="vue-bl">"Итоги"</span><span class="vue-r">);</span>
                ОблИтогиКонтрагенты <span class="vue-r">=</span> МакетДляЗакупок<span class="vue-r">.</span>ПолучитьОбласть<span class="vue-r">(</span><span class="vue-bl">"ИтогиКонтрагенты"</span><span class="vue-r">);</span>

                <span class="vue-r">Пока</span> Выборка<span class="vue-r">.</span>Следующий<span class="vue-r">() Цикл</span>
                    <span class="vue-r">Если</span> Выборка<span class="vue-r">.</span>Номенклатура <span class="vue-r">=</span> <span class="vue-lg">Null</span> <span class="vue-r">И</span> Выборка<span class="vue-r">.</span>Контрагент <span class="vue-r">=</span> <span class="vue-lg">Null</span> <span class="vue-r">Тогда</span>
                        ОблИтоги<span class="vue-r">.</span>Параметры<span class="vue-r">.</span>Заполнить<span class="vue-r">(</span>Выборка<span class="vue-r">);</span>
                        ТабДок<span class="vue-r">.</span>Вывести<span class="vue-r">(</span>ОблИтоги<span class="vue-r">);
                        Продолжить;
                    КонецЕсли;</span>

                    <span class="vue-r">Если</span> Выборка<span class="vue-r">.</span>Номенклатура <span class="vue-r">=</span> <span class="vue-lg">Null</span> <span class="vue-r">Тогда</span>
                        ОблИтогиКонтрагенты<span class="vue-r">.</span>Параметры<span class="vue-r">.</span>Заполнить<span class="vue-r">(</span>Выборка<span class="vue-r">);</span>
                        ТабДок<span class="vue-r">.</span>Вывести<span class="vue-r">(</span>ОблИтогиКонтрагенты<span class="vue-r">);
                        Продолжить;	
                    КонецЕсли;</span>

                    ОблЭлементы<span class="vue-r">.</span>Параметры<span class="vue-r">.</span>Заполнить<span class="vue-r">(</span>Выборка<span class="vue-r">);</span>
                    ТабДок<span class="vue-r">.</span>Вывести<span class="vue-r">(</span>ОблЭлементы<span class="vue-r">);
                КонецЦикла;	
            КонецПроцедуры</span></span>
        </pre>
    </div>
    <img src="../img/1С-1/2023-06-01_11-06-25.png" class="screen" alt="">
    <img src="../img/1С-1/2023-06-01_11-06-10.png" class="screen" alt="">
    <hr>
    <p>А вот так выводит система, если указать в контсрукторе запросы выод в табличный документ:</p>
    <div class="code-style">
        <pre>
            <span class="vue-b"><span class="vue-r">&НаКлиенте
            Процедура</span> СформироватьОтчет<span class="vue-r">(</span>Команда<span class="vue-r">)</span>
                СформироватьОтчетНаСервере<span class="vue-r">(</span>ТабДок<span class="vue-r">);
            КонецПроцедуры

            &НаСервереБезКонтекста
            Процедура</span> СформироватьОтчетНаСервере<span class="vue-r">(</span>ТабДок<span class="vue-r">)</span>
                Макет <span class="vue-r">=</span> Отчеты<span class="vue-r">.</span>ЗакупкиПоДокументам<span class="vue-r">.</span>ПолучитьМакет<span class="vue-r">(</span>"МакетДляЗакупок"<span class="vue-r">);</span>
                Запрос <span class="vue-r">= Новый</span> Запрос<span class="vue-r">;</span>
                Запрос<span class="vue-r">.</span>Текст <span class="vue-r">=</span> 
                    <span class="vue-bl">"ВЫБРАТЬ
                    |	ПоступлениеТоваровТовары.Ссылка.Контрагент КАК Контрагент1,
                    |	ПРЕДСТАВЛЕНИЕ(ПоступлениеТоваровТовары.Ссылка.Контрагент) КАК Контрагент,
                    |	ПоступлениеТоваровТовары.Номенклатура КАК Номенклатура1,
                    |	ПРЕДСТАВЛЕНИЕ(ПоступлениеТоваровТовары.Номенклатура) КАК Номенклатура,
                    |	СУММА(ПоступлениеТоваровТовары.Количество) КАК Количество,
                    |	СУММА(ПоступлениеТоваровТовары.Сумма) КАК Сумма
                    |ИЗ
                    |	Документ.ПоступлениеТоваров.Товары КАК ПоступлениеТоваровТовары
                    |
                    |СГРУППИРОВАТЬ ПО
                    |	ПоступлениеТоваровТовары.Ссылка.Контрагент,
                    |	ПоступлениеТоваровТовары.Номенклатура
                    |ИТОГИ
                    |	СУММА(Сумма)
                    |ПО
                    |	ОБЩИЕ,
                    |	Контрагент"</span><span class="vue-r">;</span>
                    
                РезультатЗапроса <span class="vue-r">=</span> Запрос.Выполнить<span class="vue-r">();</span>
                
                ОбластьЗаголовок <span class="vue-r">=</span> Макет<span class="vue-r">.</span>ПолучитьОбласть<span class="vue-r">(</span><span class="vue-bl">"Заголовок"</span><span class="vue-r">);</span>
                ОбластьПодвал <span class="vue-r">=</span> Макет<span class="vue-r">.</span>ПолучитьОбласть<span class="vue-r">(</span><span class="vue-bl">"Подвал"</span><span class="vue-r">);</span>
                ОбластьШапкаТаблицы <span class="vue-r">=</span> Макет<span class="vue-r">.</span>ПолучитьОбласть<span class="vue-r">(</span><span class="vue-bl">"ШапкаТаблицы"</span><span class="vue-r">);</span>
                ОбластьПодвалТаблицы <span class="vue-r">=</span> Макет<span class="vue-r">.</span>ПолучитьОбласть<span class="vue-r">(</span><span class="vue-bl">"ПодвалТаблицы"</span><span class="vue-r">);</span>
                ОбластьОбщийИтог <span class="vue-r">=</span> Макет<span class="vue-r">.</span>ПолучитьОбласть<span class="vue-r">(</span><span class="vue-bl">"ОбщиеИтоги"</span><span class="vue-r">);</span>
                ОбластьКонтрагент <span class="vue-r">=</span> Макет<span class="vue-r">.</span>ПолучитьОбласть<span class="vue-r">(</span><span class="vue-bl">"Контрагент"</span><span class="vue-r">);</span>
                ОбластьДетальныхЗаписей <span class="vue-r">=</span> Макет<span class="vue-r">.</span>ПолучитьОбласть<span class="vue-r">(</span><span class="vue-bl">"Детали"</span><span class="vue-r">);</span>
                
                ТабДок<span class="vue-r">.</span>Очистить<span class="vue-r">();</span>
                ТабДок<span class="vue-r">.</span>Вывести<span class="vue-r">(</span>ОбластьЗаголовок<span class="vue-r">);</span>
                ТабДок<span class="vue-r">.</span>Вывести<span class="vue-r">(</span>ОбластьШапкаТаблицы<span class="vue-r">);</span>
                ТабДок<span class="vue-r">.</span>НачатьАвтогруппировкуСтрок<span class="vue-r">();</span>
                
                ВыборкаОбщийИтог <span class="vue-r">=</span> РезультатЗапроса<span class="vue-r">.</span>Выбрать<span class="vue-r">(</span>ОбходРезультатаЗапроса<span class="vue-r">.</span>ПоГруппировкам<span class="vue-r">);</span>
                
                ВыборкаОбщийИтог<span class="vue-r">.</span>Следующий<span class="vue-r">();</span>		// Общий итог
                ОбластьОбщийИтог<span class="vue-r">.</span>Параметры<span class="vue-r">.</span>Заполнить<span class="vue-r">(</span>ВыборкаОбщийИтог<span class="vue-r">);</span>
                ТабДок<span class="vue-r">.</span>Вывести<span class="vue-r">(</span>ОбластьОбщийИтог<span class="vue-r">,</span> ВыборкаОбщийИтог<span class="vue-r">.</span>Уровень<span class="vue-r">());</span>
                
                ВыборкаКонтрагент <span class="vue-r">=</span> ВыборкаОбщийИтог<span class="vue-r">.</span>Выбрать<span class="vue-r">(</span>ОбходРезультатаЗапроса<span class="vue-r">.</span>ПоГруппировкам<span class="vue-r">);</span>
                
                <span class="vue-r">Пока</span> ВыборкаКонтрагент<span class="vue-r">.</span>Следующий<span class="vue-r">() Цикл</span>
                    ОбластьКонтрагент<span class="vue-r">.</span>Параметры<span class="vue-r">.</span>Заполнить<span class="vue-r">(</span>ВыборкаКонтрагент<span class="vue-r">);</span>
                    ТабДок<span class="vue-r">.</span>Вывести<span class="vue-r">(</span>ОбластьКонтрагент<span class="vue-r">,</span> ВыборкаКонтрагент<span class="vue-r">.</span>Уровень<span class="vue-r">());</span>
                
                    ВыборкаДетальныеЗаписи <span class="vue-r">=</span> ВыборкаКонтрагент<span class="vue-r">.</span>Выбрать<span class="vue-r">();</span>
                
                    <span class="vue-r">Пока</span> ВыборкаДетальныеЗаписи<span class="vue-r">.</span>Следующий<span class="vue-r">() Цикл</span>
                        ОбластьДетальныхЗаписей<span class="vue-r">.</span>Параметры<span class="vue-r">.</span>Заполнить<span class="vue-r">(</span>ВыборкаДетальныеЗаписи<span class="vue-r">);</span>
                        ТабДок<span class="vue-r">.</span>Вывести<span class="vue-r">(</span>ОбластьДетальныхЗаписей<span class="vue-r">,</span> ВыборкаДетальныеЗаписи<span class="vue-r">.</span>Уровень<span class="vue-r">());
                    КонецЦикла;
                КонецЦикла;</span>
                
                ТабДок<span class="vue-r">.</span>ЗакончитьАвтогруппировкуСтрок<span class="vue-r">();</span>
                ТабДок<span class="vue-r">.</span>Вывести<span class="vue-r">(</span>ОбластьПодвалТаблицы<span class="vue-r">);</span>
                ТабДок<span class="vue-r">.</span>Вывести<span class="vue-r">(</span>ОбластьПодвал<span class="vue-r">);
            КонецПроцедуры</span></span>
        </pre>
    </div>
    <img src="../img/1С-1/2023-06-01_14-34-51.png" class="screen" alt="">
    <img src="../img/1С-1/2023-06-01_14-36-15.png" class="screen" alt="">
    <p>Выборка выбирает сначала группировку первого уровня, там будет итог, затем нужно ещё раз выбрать второй уровень, там будут группы контрагентов и затем выбираем детальные записи.</p>
















    <h2 class="header-style" id="6">Поле формы с типом "ТаблицаЗначений".</h2>
    <p id="table-1"><b>Работа с таблицей значений на форме</b>. Точно так как и список значений мы можем разместить на форме реквизит с типом "ТаблицаЗначений". Например создадим реквизит "ТаблицаОстатки" и укажем ей этот тип. Как только мы этому реквизиту указали тип "ТаблицаЗначений", то сверху в панельке кнопок стала доступка кнопка "Добавить колонку реквизита". Нажав на неё внутри реквизита появится колонка реквизит, ей зададим имя такое как и у регистра накопления называются измерения и русурс. Мы хотим показывать в этой таблице какую нибудь таблицу регистра накопления "ОстаткиНоменклатуры". У регистра есть 2 измерения Товар и Склад и ресурс Количество, значит называем реквизит колонку Товар с типом СправочникСсылка.Номенклатура, затем добавим реквизит колонку Склад, с типом СправочникСсылка.Склад и колонку Количество с типом Число. Перетаскиваем реквизит "ТаблицаОстатки" влево на элементы формы. Смотрим что получилось, пока это просто таблица, в которую можно добавлять товары и склады из справочников. Мы же хотим при открытии этой формы заполнения остатками из регистра. Для этого для события формы "ПриСозданииНаСервере" напишем обработчик. В обработчике конструируем запрос из таблицы регистра накопления ОстаткиНоменклатуры.Остатки. Обход результата запроса нам не нужен, а нужен метод РезультатЗапроса.Выгрузить();. Как известно этот метод выгружает результат в таблицы. Но просто так выгрузить в реквизит "ТаблицаОстатки" не получится, потому что у реквизита с типом таблица значений есть свой метод Загрузить(). Поэтому сначала выгружаем из результата во временную переменную, а потом в "ТаблицаОстатки" загружаем из этой временной переменной.</p>
    <div class="code-style">
        <pre>
            --1й сособ
            <span class="vue-b"><span class="vue-r">&НаСервере
            Процедура</span> ПриСозданииНаСервере<span class="vue-r">(</span>Отказ, СтандартнаяОбработка<span class="vue-r">)</span>	
                Запрос <span class="vue-r">= Новый</span> Запрос<span class="vue-r">;</span>
                Запрос<span class="vue-r">.</span>Текст <span class="vue-r">=</span> 
                    <span class="vue-bl">"ВЫБРАТЬ
                    |	ОстаткиНоменклатурыОстатки.Номенклатура КАК Номенклатура,
                    |	ОстаткиНоменклатурыОстатки.Склад КАК Склад,
                    |	ОстаткиНоменклатурыОстатки.КоличествоОстаток КАК Количество
                    |ИЗ
                    |	РегистрНакопления.ОстаткиНоменклатуры.Остатки КАК ОстаткиНоменклатурыОстатки"</span><span class="vue-r">;</span>
                
                РезультатЗапроса <span class="vue-r">=</span> Запрос<span class="vue-r">.</span>Выполнить<span class="vue-r">();</span>
                ТаблицаЗапроса <span class="vue-r">=</span> РезультатЗапроса<span class="vue-r">.</span>Выгрузить<span class="vue-r">();</span>
                ТаблицаОстатки<span class="vue-r">.</span>Загрузить<span class="vue-r">(</span>ТаблицаЗапроса<span class="vue-r">);
            КонецПроцедуры</span></span>

            --2й способ
            <span class="vue-b"><span class="vue-r">&НаСервере
            Процедура</span> ПриСозданииНаСервере<span class="vue-r">(</span>Отказ, СтандартнаяОбработка<span class="vue-r">)</span>	
                Запрос <span class="vue-r">= Новый</span> Запрос<span class="vue-r">;</span>
                Запрос<span class="vue-r">.</span>Текст <span class="vue-r">=</span> 
                    <span class="vue-bl">"ВЫБРАТЬ
                    |	ОстаткиНоменклатурыОстатки.Номенклатура КАК Номенклатура,
                    |	ОстаткиНоменклатурыОстатки.Склад КАК Склад,
                    |	ОстаткиНоменклатурыОстатки.КоличествоОстаток КАК Количество
                    |ИЗ
                    |	РегистрНакопления.ОстаткиНоменклатуры.Остатки КАК ОстаткиНоменклатурыОстатки"</span><span class="vue-r">;</span>
                
                РезультатЗапроса <span class="vue-r">=</span> Запрос<span class="vue-r">.</span>Выполнить<span class="vue-r">();</span>
                Выборка <span class="vue-r">=</span> РезультатЗапроса<span class="vue-r">.</span>Выбрать<span class="vue-r">();</span>

                <span class="vue-r">Пока </span>Выборка<span class="vue-r">.</span>Следующий<span class="vue-r">()</span> <span class="vue-r">Тогда</span>
                    СтрокаТаблицыЗначений <span class="vue-r">=</span> ТаблицаОстатки<span class="vue-r">.</span>Добавить<span class="vue-r">();</span>
                    СтрокаТаблицыЗначений<span class="vue-r">.</span>Номенклатура <span class="vue-r">=</span> Выборка<span class="vue-r">.</span>Номенклатура<span class="vue-r">;</span>
                    СтрокаТаблицыЗначений<span class="vue-r">.</span>Склад <span class="vue-r">=</span> Выборка<span class="vue-r">.</span>Склад<span class="vue-r">;</span>
                    СтрокаТаблицыЗначений<span class="vue-r">.</span>Количество <span class="vue-r">=</span> Выборка<span class="vue-r">.</span>Количество<span class="vue-r">;
                КонецЦикла;
            КонецПроцедуры</span></span>
        </pre>
    </div>
    <p>Хотя если посмотреть в форме какой тип показывает у реквизита "ТаблицаОстатки", то там в скобках написано (ТаблицаЗначений), если в таких скобках, значит это не совсем таблица значений, хотя методы у неё такие как и у таблицы занчений, но не все, например, метода Свернуть() нет. Посмторел в отладчике, тип на самом деле у этого реквизита  - ДанныеФормыКоллекция. Чтобы получить таблицу значений из этого реквизита, есть такой метод как <span class="vue-b">РеквизитФормыВЗначение("ТаблицаОстатки")</span> аернёт таблицу значений.</p>
    <p>Таким не хитрым способом можно отображать регистры(и не только) в формах обработки, документа или ещё где то.</p>

</div>