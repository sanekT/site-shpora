<div class="wrap">
   
    <h2 class="header-style">Печатные формы</h2>

    <ul class="list">
        <li><a href="#maket">Макет</a></li>
        <li><a href="#print-out-form">Внешняя печатная форма</a></li>
        <li><a href="#print-in-form">Внутренняя печатная форма и вывод в разные типы документа</a>
            <ul class="list2">
                <li><a href="#print-in-form-tab-d">Вывод в табличный документ</a></li>
                <li><a href="#print-in-form-text-d">Вывод в текстовый документ</a></li>
                <li><a href="#print-in-form-active-d">Вывод в active document</a></li>
                <li><a href="#print-in-form-ex">Как вставить шаблон печатной формы из Excel в 1С.</a></li>
            </ul>
        </li>
        <li><a href="#print-in-form-ex">Как вставить шаблон печатной формы из Excel в 1С</a></li>
        <li><a href="#example1">Сделать кнопку Печать для вывода табличной части документа на печать. Первый способ.</a></li>
        <li><a href="#example2">Сделать кнопку Печать для вывода табличной части документа на печать. Второй способ.</a></li>
        <li><a href="#example3"></a></li>
    </ul>









    <h3 class="header-style2" id="maket">Макет</h3>
    <p>Объект конфигурации Макет предназначен для хранения различных форм представления данных, которые могут потребоваться каким-либо объектам конфигурации или всему прикладному решению в целом.</p>
    <p>Макет может содержать табличный или текстовый документ, двоичные данные, HTML-документ или Active Document, графическую или географическую схему, схему компоновки данных или макет оформления схемы компоновки данных. </p>
    <p>Макеты могут существовать как сами по себе (общие макеты), так и быть подчинены какому-либо объекту конфигурации.</p>
    <p>Одно из предназначений макета, подчиненного объекту конфигурации и содержащего табличный документ, – создание печатной формы этого объекта. Создание печатной формы заключается в конструировании ее составных частей – именованных областей, из которых затем «собирается» готовая печатная форма. </p>
    <p>Порядок заполнения областей данными и вывода их в итоговую форму описывается при помощи встроенного языка. Печатная форма может включать в себя различные графические объекты: картинки, OLE-объекты, диаграммы и т.д.</p>
    <p>Помимо создания макета «вручную» конфигуратор предоставляет разработчику возможность воспользоваться специальным инструментом – конструктором печати, который берет на себя большинство рутинной работы по созданию макета.</p>












    <h3 class="header-style2" id="print-out-form">Внешняя печатная форма(ВПФ)</h3>
    <p>Делаю по видео - https://www.youtube.com/watch?v=LPpZ5hRYpvc&t=7s.   По типовой конфигурации Розница.</p>
    <p>Если открыть Файл - Новый, то в окошке увидим, что внешнее можно создать только обработку и отчёт, внешней печатной формы там нет. Её сделать немного сложней.</p>
    <p>В типовых решениях у многих документов и других объектов есть внутренние печатные формы, но если нам нужно что то в форме подправить, то у нас нету возможности изменить эти формы в типовой, да и в не типовой конфигурации, поэтому и делаются внешние печатные формы, чтобы в этой форме уже можно было под себя изменить форму.</p>
    <p>БСП имеет некий API(программный интерфейс), который позволяет нам подключить внешнюю печатную форму к пользовательскому интерфейсу. Чтобы в меню "Печать" у документа вместе с внутренними печатными формами отображалась и внешняя печатная форма. Чтобы подключить ВПФ нужно следовать некоторым требованиям.</p>
    <p>Как устроенно это взаимодействие? Когда у нас в меню "Печать" уже появится кнопка нашей ВПФ и мы жмём на эту кнопку, то БСП отправляет в нашу ВПФ массив ссылок на документы которые хотим распечатать. Если открыта форма документа то передаётся массив одной ссылки, если мы выделяем в форме списка документа несколько документов, то передаётся массив ссылок на выделенные документы. Наша ВПФ по этой ссылке получает данные из БД этого документа, строит табличный документ, выводит в него все данные и возвращает БСП этот табличный документ. Т.е наша ВПФ получает массив и возвращает табличный документ.</p>
    <p>Так что же такое ВПФ? Это обычная внешняя обработка. Создаём в конфе внешнюю обработку, например, для документа "ЗаказПокупателя" и назовём её "ПечатнаяФормаЗаказаПокупателя". Далее автор видео показал свой сайт, где описаны некоторые объяснения по работе с 1С, вот - <i>https://cs-develop.ru/manuals/</i>. Переходим и выбираем из списка Практики программирования -> Разработка внешних печатных форм для 1С 8.3. На странице будет описан весь процесс создания такой печатной формы. Самая первая функция СведенияОВнешнейОбработке() говорит БСП о своих параметрах, для печати чего она, какая версия, нужна ли безопасность и так далее:</p>
    <div class="code-style">
        <pre>
            --помещаем её в модуль объекта созданной внешней обработки
            <span class="vue-b"><span class="vue-r">Функция</span> СведенияОВнешнейОбработке<span class="vue-r">() Экспорт</span>
                ПараметрыРегистрации <span class="vue-r">=</span> ДополнительныеОтчетыИОбработки<span class="vue-r">.</span>СведенияОВнешнейОбработке<span class="vue-r">(</span><span class="vue-bl">"3.1.5.221"</span><span class="vue-r">);</span>
                ПараметрыРегистрации<span class="vue-r">.</span>Вид <span class="vue-r">=</span> ДополнительныеОтчетыИОбработкиКлиентСервер<span class="vue-r">.</span>ВидОбработкиПечатнаяФорма<span class="vue-r">();</span>

                МассивНазначений <span class="vue-r">= Новый</span> Массив<span class="vue-r">;</span>
                МассивНазначений<span class="vue-r">.</span>Добавить<span class="vue-r">(</span><span class="vue-bl">"Документ.РеализацияТоваров"</span><span class="vue-r">);</span>
                ПараметрыРегистрации<span class="vue-r">.</span>Вставить<span class="vue-r">(</span><span class="vue-bl">"Назначение"</span><span class="vue-r">,</span> МассивНазначений<span class="vue-r">);</span>

                ПараметрыРегистрации<span class="vue-r">.</span>Версия <span class="vue-r">=</span> <span class="vue-bl">"21.12.16"</span><span class="vue-r">;</span>
                
                НоваяКоманда <span class="vue-r">=</span> ПараметрыРегистрации<span class="vue-r">.</span>Команды<span class="vue-r">.</span>Добавить<span class="vue-r">();</span>
                НоваяКоманда<span class="vue-r">.</span>Представление <span class="vue-r">=</span> <span class="vue-bl">"Реализация товаров (доработанная)"</span><span class="vue-r">;</span>
                НоваяКоманда<span class="vue-r">.</span>Идентификатор <span class="vue-r">=</span> <span class="vue-bl">"РеализацияТоваровДоработанная"</span><span class="vue-r">;</span>
                НоваяКоманда<span class="vue-r">.</span>Использование <span class="vue-r">=</span> ДополнительныеОтчетыИОбработкиКлиентСервер<span class="vue-r">.</span>ТипКомандыВызовСерверногоМетода<span class="vue-r">();</span>
                НоваяКоманда<span class="vue-r">.</span>ПоказыватьОповещение <span class="vue-r">=</span> Истина<span class="vue-r">;</span>
                
                Разрешение <span class="vue-r">=</span> РаботаВБезопасномРежиме<span class="vue-r">.</span>РазрешениеНаИспользованиеКаталогаВременныхФайлов<span class="vue-r">(</span>Истина<span class="vue-r">,</span> Истина<span class="vue-r">);</span>
                ПараметрыРегистрации<span class="vue-r">.</span>Разрешения<span class="vue-r">.</span>Добавить<span class="vue-r">(</span>Разрешение<span class="vue-r">);</span>
                
                <span class="vue-r">Возврат</span> ПараметрыРегистрации<span class="vue-r">;   
            КонецФункции</span></span>
        </pre>
    </div>















    <h3 class="header-style2" id="print-in-form">Внутренняя печатная форма</h3>
    <p>Делаю по видео - https://www.youtube.com/watch?v=_gZ-8JTl948&list=RDCMUC124tAuP11GlaGpK3YGHzlw&start_radio=1</p>
    <p>Все тренироввочные примеры в инфобазе МебельДомТорг у документа "ПродажаТоваров".</p>
    <p>Поговорим про то как организовать печать документов, как создать печатную форму имея макет в Excel, как создать печатную форму и вывести в текстовый документ, а не в табличный, как организовать печать в Word.</p>
    <p>Печатная форма нужна для того, чтобы данные какого то документа представить в любом печатном виде, чтобы потом распечатать документ на принтере или отправить на электронную почту. Чтобы создать печать документа нужно 3 составляющие: макет, кнопка, код обработки кнопки.</p>
    <p>Саму простую печатную форму можно сделать используя такой инструмент как "Конструктор печати". Найти этот интсрумент можно при выделении объекта документа и в контекстном меню Кострукторы -> Коструктор печати, либо открываем редактор объекта документа и во вкладке Макет справа внизу увидим кнопку с этим коструктором. Конструктор нам создаст стандартную структуру печатной формы:</p>
    <img src="../img/1С-1/2023-07-13_08-48-32.png" class="screen" alt="">
    <p>Понятное дело не все печатные формы построенны по такой структуре, но эта структура как бы часто встречающаяся.</p>
    <p>Итак создадим по конструктору печатную форму. Пройдём по всем шагам конструктора, выберем группу куда хотим добавить команду. Если мы заранее не создавали свою группу в объекте "Группа команд" ветки Общие, то выбираем группу "Командная панель формы.Важное". Всё жмём готово и у нас появится 3 окна: 2 с кодом(в модуле команды и в модуле менеджера) и окно с макетом в табличном документе.</p>
    <p>Более подробно поговорим про макеты. Как говорит преподаватель из IronSkill, <span class="vue-r-b">макет предназначен для хранения в конфигурации различных данных, которые требуются для отображения в процессе работы как всего прикладного решения, так и отдельных его объектов. Также в частности макет позволяет сформировать шаблон печатной формы для последуюущего его заполнения</span>. Пока мне не понятно какие данные хранит в конфигурации макет. Ну наверняка не те данные, что лежат в БД. Нужно будет поинтересоваться. А вот с макетом, который позволяет сформировать шаблон и по этому шаблону потом заполнять табличную часть данными, вроде всё понятно. Такой макет с шаблоном мы и будем использовать для создания печатной формы.</p>
    <p>Для печатных форм используются 3 типа: <span class="vue-d-b">табличный документ</span>, <span class="vue-d-b">текстовый документ</span> и <span class="vue-d-b">active document</span>. Пройдёмся по ним по порядку.</p>

    <p><b id="print-in-form-tab-d">Табличный документ</b>.</p>
    <p><span class="vue-d-b">Табличный документ</span> представляет из себя что то похожее на таблицу Excel, т.е. состоит из ячеек, пересечения строк и колоной и у каждой ячейки есть свой адрес:</p>
    <img src="../img/1С-1/2023-07-13_16-57-32.png" class="screen" alt="">
    <p>Каждую ячейку или группу ячеек можно настраивать. Можно изменить размер, цвет шрифта в указанной ячейке. Можно покрасить фон в ячейке. Расположить текст в ячейке по горизонтали и вертикали. Можно выделить ячейку и вверху в панели инструментов задавать её настройки, а можно выделив ячейку открыть её палитру свойств и там задавать настройки.</p>
    <img src="../img/1С-1/2023-07-13_17-04-19.png" class="screen" alt="">
    <p>К тексту в ячейке можно применить одно из 3х заполнений: текст, параметр и шаблон. Текст стоит по умолчанию, если ячейке задать заполнение  - параметр, то текст становится именем переменной, которая заменится в дальнейшем значением подноимённой переменной, например, из БД. Шаблон задаётся для ячейки, в которой есть и просто текст и параметр, тогда весь текст берётся в угловые скобки, а параметр в квадаратных.</p>
    <img src="../img/1С-1/2023-07-13_19-06-16.png" class="screen" alt="">
    <p>Удобная и мощная возможность табличного документа это возможность задавать для каждой строки или столбца свой формат. Например, выделив строку 2 мы можем увеличить ширину столбца 4 только для этой строки. Это позволяет строить в макете разные таблицы не мучаясь.</p>
    <p><span class="vue-d-b">Формат для ячейки макета</span>. У нас есть ячейка, в ней переменная, позже в программном коде вместо переменной подставляется число ввиде 100, но мы хотим, чтобы подставлялось 100,00, с точночтью до 2х знаков. Для ячейки в её свойствах есть свойство Формат, вот там и выбираем нужный формат.</p>
    <p><span class="vue-d-b">Области табличного документа</span>. области нужны для того, чтобы при работе с печатной формой мы работали не с одной какой то ячейкой, а сразу с группой ячеек, как с единым целым. Можно вообще создавать печатную форму без макета, а сразу в табличном документе, но тогда придётся работать с каждой ячейков по отдельности и программировать придётся очень много. Макет на базе табличного документа позволяет от руки накидать по областям что нам нужно и потом эти области заполнять данными и выводить уже эти заполненые области в табличный документ пользователю. Т.е. мы берём область с шапкой таблицы, если там нет переменных, то выводим её в табличный документ вот прям вот так - ТабДок.Вывести(ШапкаТаблицы) и всё в табличный документ пользователю выведется сразу группа ячеек объединённая в эту область,т.е. не нужно выводить каждый столбик шакпи таблицы по отдельности.</p>
    <p>Как <span class="vue-d-b">добавить область</span> в макет? Выделяем строку или строки, только выделять нужно нажимая прям на цифры строк, а не просто ячейки:</p>
    <img src="../img/1С-1/2023-07-13_19-32-23.png" class="screen" alt="">
    <p>Также можно выбрать в верхнем меню Таблица - Имена - Назначить имя. Имя долно соответствовать правилам именования переменных, потому что дальше в коде имя области будет переменной.</p>
    <p>Чтобы убрать область, просто выделяем область и применяем кнопку "Убрать имя", она рядом с кнопкой "Назначить имя".</p>
    <p>Область может состоять даже из одной ячейки, для это просто выделяем ячейку и даём ей имя. Но её в макете не будет видно, чтобы она как то выделялась можно нажать на кнопку "Отображать именнованные ячейки", эта кнопка рядом с кнопкой "Назначить имя" и тогда подсветятся все такие области. Такой способ задания области нужен при сложных формах отчётности, например, регламентированной отчётности. Где в шаблоне есть в определённом месте какое то число и его нужно там вывести.</p>
    <p><span class="vue-d-b">Работа с областями в программном коде</span>.</p>
    <p>Не буду расписывать как работать с макетом в коде, приведу пример, где и так вроде всё понятно:</p>
    <div class="code-style">
        <pre>
            <span class="vue-b"><span class="vue-r">&НаКлиенте
            Процедура</span> ОбработкаКоманды<span class="vue-r">(</span>ПараметрКоманды<span class="vue-r">,</span> ПараметрыВыполненияКоманды<span class="vue-r">)</span>
                ТабДок <span class="vue-r">= Новый</span> ТабличныйДокумент<span class="vue-r">;</span>
                ПечатьТорг12<span class="vue-r">(</span>ПараметрКоманды<span class="vue-r">,</span> ТабДок<span class="vue-r">);</span>

                <span class="vue-g">//если мы создали свой объект ТабДок от класса ТабличныйДокумент, то когда он заполнится его нужно показать,
                //а если мы создали реквизит в форме с типом ТабличныйДокумент, то его нужно просто заполнить, метод Показать() уже не нужен</span>
                ТабДок<span class="vue-r">.</span>Показать<span class="vue-r">();		
            КонецПроцедуры 

            &НаСервере
            Процедура</span> ПечатьТорг12<span class="vue-r">(</span>ПараметрКоманды<span class="vue-r">,</span> ТабДок<span class="vue-r">)</span>
                <span class="vue-g">//получаем макет</span>
                Макет <span class="vue-r">=</span> Документы<span class="vue-r">.</span>ПродажаТоваров<span class="vue-r">.</span>ПолучитьМакет<span class="vue-r">(</span><span class="vue-bl">"МакетТорг12"</span><span class="vue-r">);</span>
                Запрос <span class="vue-r">= Новый</span> Запрос<span class="vue-r">;</span>
                Запрос<span class="vue-r">.</span>Текст <span class="vue-r">=</span> 
                    <span class="vue-bl">"ВЫБРАТЬ
                    |	ПродажаТоваровТовары.Номенклатура КАК Номенклатура,
                    |	ПРЕДСТАВЛЕНИЕ(ПродажаТоваровТовары.Номенклатура) КАК НоменклатураПредставление,
                    |	ПродажаТоваровТовары.Цена КАК Цена,
                    |	ПродажаТоваровТовары.Количество КАК Количество,
                    |	ПродажаТоваровТовары.Всего КАК Всего
                    |ИЗ
                    |	Документ.ПродажаТоваров.Товары КАК ПродажаТоваровТовары
                    |ГДЕ
                    |	ПродажаТоваровТовары.Ссылка = &Ссылка"</span><span class="vue-r">;</span>
                
                <span class="vue-g">//если мы кликаем на кнопку "ПечатьТорг12" из формы документа, то в параметре
                //ПараметрКоманды лежит ссылка на этот объект документа</span>
                Запрос<span class="vue-r">.</span>УстановитьПараметр<span class="vue-r">(</span><span class="vue-bl">"Ссылка"</span><span class="vue-r">,</span> ПараметрКоманды<span class="vue-r">);</span> 
                РезультатЗапроса <span class="vue-r">=</span> Запрос<span class="vue-r">.</span>Выполнить<span class="vue-r">();</span>
                
                <span class="vue-g">//получаем области макета. Имена областей должны быть такие как в макете</span>
                ОбластьЗаголовок <span class="vue-r">=</span> Макет<span class="vue-r">.</span>ПолучитьОбласть<span class="vue-r">(</span><span class="vue-bl">"Заголовок"</span><span class="vue-r">);</span>
                ОбластьПодвал <span class="vue-r">=</span> Макет<span class="vue-r">.</span>ПолучитьОбласть<span class="vue-r">(</span><span class="vue-bl">"Подвал"</span><span class="vue-r">);</span>
                ОбластьШапкаТаблицы <span class="vue-r">=</span> Макет<span class="vue-r">.</span>ПолучитьОбласть<span class="vue-r">(</span><span class="vue-bl">"ШапкаТаблицы"</span><span class="vue-r">);</span>
                ОбластьПодвалТаблицы <span class="vue-r">=</span> Макет<span class="vue-r">.</span>ПолучитьОбласть<span class="vue-r">(</span><span class="vue-bl">"ПодвалТаблицы"</span><span class="vue-r">);</span>
                ОбластьДетальныхЗаписей <span class="vue-r">=</span> Макет<span class="vue-r">.</span>ПолучитьОбласть<span class="vue-r">(</span><span class="vue-bl">"Детали"</span><span class="vue-r">);</span>
                
                ТабДок<span class="vue-r">.</span>Очистить<span class="vue-r">();</span>
                ТабДок<span class="vue-r">.</span>Вывести<span class="vue-r">(</span>ОбластьЗаголовок<span class="vue-r">);</span>
                ТабДок<span class="vue-r">.</span>Вывести<span class="vue-r">(</span>ОбластьШапкаТаблицы<span class="vue-r">);</span>
                ТабДок<span class="vue-r">.</span>НачатьАвтогруппировкуСтрок<span class="vue-r">();</span>
                
                ВыборкаДетальныеЗаписи <span class="vue-r">=</span> РезультатЗапроса<span class="vue-r">.</span>Выбрать<span class="vue-r">();</span>
                
                <span class="vue-r">Пока</span> ВыборкаДетальныеЗаписи<span class="vue-r">.</span>Следующий<span class="vue-r">() Цикл</span>
                    ОбластьДетальныхЗаписей<span class="vue-r">.</span>Параметры<span class="vue-r">.</span>Заполнить<span class="vue-r">(</span>ВыборкаДетальныеЗаписи<span class="vue-r">);</span>
                    ТабДок<span class="vue-r">.</span>Вывести<span class="vue-r">(</span>ОбластьДетальныхЗаписей<span class="vue-r">,</span> ВыборкаДетальныеЗаписи<span class="vue-r">.</span>Уровень<span class="vue-r">());
                КонецЦикла;</span>
                
                ТабДок<span class="vue-r">.</span>ЗакончитьАвтогруппировкуСтрок<span class="vue-r">();</span>
                ТабДок<span class="vue-r">.</span>Вывести<span class="vue-r">(</span>ОбластьПодвалТаблицы<span class="vue-r">);</span>
                ТабДок<span class="vue-r">.</span>Вывести<span class="vue-r">(</span>ОбластьПодвал<span class="vue-r">);
            КонецПроцедуры</span></span>
        </pre>
    </div>
    <p>Есть 2 сособа заполнять параметры, какие я знаю. Первый способ показан в коде выше в цикле. Мы заполняем в цикле переменные из выборки, но нужно чтобы переменные в области были названы также как переменные в выборке. Второй способ это когда в макете переменные стоят одиночно, т.е. их заполнение не происходит в цикле, тогда заполняются вот так. Например у нас в области "Заголовок" есть параметр ДатаЗаголовка, его надо заполнить:</p>
    <div class="code-style">
        <pre>
            <span class="vue-b">ОбластьЗаголовок<span class="vue-r">.</span>Параметр<span class="vue-r">.</span>ДатаЗаголовка <span class="vue-r">=</span> ТекущаяДата<span class="vue-r">();</span>
            ТабДок<span class="vue-r">.</span>Вывести<span class="vue-r">(</span>ОбластьЗаголовок<span class="vue-r">);</span></span>
        </pre>
    </div>
    <p><span class="vue-d-b">Высота строк в табличном документе</span>. Если у нас например, будет длинное название товара, то у нас в итоговом табличном документе, который видит пользователь этот товар обрежется и видно будет только окончание слов товара. Это всё из за того, что не настроенна высота строки в макете. В макете для каждой новой строки стоит автовысота строки. Как это проверить? Выделем строку и в контекстном меню есть пункт "Высота строк", нажмём его и появится окошко:</p>
    <img src="../img/1С-1/2023-07-15_21-26-13.png" alt="">
    <p>Так и должно быть, строка должна сама растягиваться по вертикали, если название большое. Галочка с автовысоты убирается, когда мы макет заполняем копированием из таблицы Excel и других таблиц. Поэтому самостоятельно исправляем этот момент, ставя галочку автовысоты. И второе важное дополнение. Нужно выделить ячейку, где поставляется название товара, открыть его свойства и в первой вкладке первое свойство "Размещение текста", его значение нужно установить "Переносить". Также когда мы ставим галочку Автовысота, то ниже может стоять галочка максимальной высоты строки, вот её нужно убрать, иначе она будет ограничивать высоту.</p>
    <p><span class="vue-d-b">Приём, который позволяет быстро создать заготовку печатной формы и её программного текста</span>. Приём заключается в том, что когда мы составляем запрос, то ставим пункт "Тип обработки" в значение "Вывод в табличный докумет". В этом случае у нас и код напишется и макет создатся. Нам останется только под себя подшаманить макет и код.</p>
    <p><span class="vue-d-b">Где располагать код?</span> В примере выше у нас весь код находится в модуле команды, как клиентский так и сервеный. Но правильно делать так, чтобы серверный код, выполняющий запрос и затем выводящий данные в табличный документ, был расположен не в модуле команды, а в модуле менеджера, тогда эта процедура становится доступна и для других кнопок. А кнопок печатающих разные виды одного и того же документа бывает много и вот чтобы для каждой кнопки неписать свой запрос, будет существовать общий запрос, который и лежит в модуле менеджера.</p>
    <p>Но ведь можно код с запросом разместить и в модуле объекта, так куда правильно? Есть такой способ различать. Если код изменяет данные самого объекта документа, то размещается такой код в модуле объекта, если же код просто читает данные из БД не изменяя их, то такой код размещают в модуле менеджера.</p>

    <p><b id="print-in-form-text-d">Текстовый документ</b>.</p>
    <p>В видео начинается с 01:16:20.</p>
    <p>В этом случае вывод печатной формы происходит по сути как в блокнот. Для чего такой вывод печатной формы нужен? Такой вывод иногда бывает нужен при печати на матричном принтере, когда надо распечатать чек на фискальном регистраторе. И туда нужно вывести данные именно в текстовый формат.</p>
    <p>Для текстового документа точно также как и для табличного документа можно размечать области. Т.е. мы можем строку включать в область и этой области присваивать имя:</p>
    <img src="../img/1С-1/2023-07-16_08-35-16.png" class="screen" alt="">
    <p>Как показано на картинке, чтобы создать область нужно начать строку с "#Область" и через пробел имя области. Затем идёт строка или несколько строк включённые в эту область и заканчивается область "#КонецОбласти".</p>
    <p>Получение макета, получение областей из макета и установка параметров точно такая же как и с табличным документом. Одно отличие только это в классе, от которго мы получаем объект, вместо ТабличныйДокумент, мы используем класс ТекстовыйДокумент. Ну ещё отличия в разметке макета и в оформлении макета, текстовый документ нельзя никак украшать, только текст.</p>
    <p><span class="vue-d-b">Рассмотрим пример с выводом в текстовый документ</span>.</p>
    <img src="../img/1С-1/2023-07-16_08-48-29.png" class="screen" alt="">
    <p>Я сделал в блокноте такой же макет чека, чтобы повторить действия того, что нам заказчик передал в блокноте вид печатной формы и нам нужно из блокнота перенести в макет всю эту разметку.</p>
    <p>Итак для документа "ПродажаТоваров" создадим новый макет, но уже с типом "Текстовый документ". Откроется редактор текстового документа, выглядит всё как в блокноте. Поэтому берём шаблон из блокнота, присланный заказчиком , копируем его и вставляем в макет. Нарезаем шаблон на области, но нужно учитывать то, что если в табличном документе есть такие понятия как высота строки, то тут такого нет и нам при задании параметров пробелами нужно самому отступить столько сколько примерно нужно для значения параметра. Подробно про редактор текстовых макетов можно почитать в справке Справка - Содержание - Специализированные редакторы - Редактор текстовых макетов. Итак вот такой макет получился:</p>
    <img src="../img/1С-1/2023-07-16_10-32-41.png" class="screen" alt="">
    <p>Далее создаём команду "ПечатьЧекаККМ" и описываем код:</p>
    <div class="code-style">
        <pre>
            --модуль команды "ПечатьЧекаККМ"
            <span class="vue-b"><span class="vue-r">&НаКлиенте
            Процедура</span> ОбработкаКоманды<span class="vue-r">(</span>ПараметрКоманды<span class="vue-r">,</span> ПараметрыВыполненияКоманды<span class="vue-r">)</span>
                ТекДок <span class="vue-r">= Новый</span> ТекстовыйДокумент<span class="vue-r">;</span>

                ПолучитьДанныеДокумента<span class="vue-r">(</span>ТекДок<span class="vue-r">,</span> ПараметрКоманды<span class="vue-r">);</span>

                ТекДок<span class="vue-r">.</span>Показать<span class="vue-r">(</span><span class="vue-bl">"ЧекККМ"</span><span class="vue-r">);
            КонецПроцедуры 

            &НаСервере
            Процедура</span> ПолучитьДанныеДокумента<span class="vue-r">(</span>ТекДок<span class="vue-r">,</span> ПараметрКоманды<span class="vue-r">)</span>
                Документы<span class="vue-r">.</span>ПродажаТоваровИУслуг<span class="vue-r">.</span>ПечатьТекДок<span class="vue-r">(</span>ТекДок<span class="vue-r">,</span> ПараметрКоманды<span class="vue-r">);
            КонецПроцедуры</span></span>


            --модуль менеджера документа "ПродажаТоваров"
            <span class="vue-b"><span class="vue-r">Процедура</span> ПечатьТекДок<span class="vue-r">(</span>ТекДок<span class="vue-r">,</span> ПараметрКоманды<span class="vue-r">) Экспорт</span>
                Запрос <span class="vue-r">= Новый</span> Запрос<span class="vue-r">;</span>
                Запрос<span class="vue-r">.</span>Текст <span class="vue-r">=</span> 
                    <span class="vue-bl">"ВЫБРАТЬ
                    |	ПРЕДСТАВЛЕНИЕ(ПродажаТоваровИУслугТовары.Товар) КАК НаименованиеТовара,
                    |	ПродажаТоваровИУслугТовары.Количество КАК Количество,
                    |	ПродажаТоваровИУслугТовары.Цена КАК Цена,
                    |	ПродажаТоваровИУслугТовары.Сумма КАК Сумма,
                    |	ПродажаТоваровИУслугТовары.Ссылка.СуммаДокумента КАК СуммаДокумента,
                    |	ПРЕДСТАВЛЕНИЕ(ПродажаТоваровИУслугТовары.Ссылка.Покупатель) КАК НазваниеКонтрагента,
                    |	ПродажаТоваровИУслугТовары.Ссылка.Номер КАК Номер,
                    |	ПродажаТоваровИУслугТовары.Ссылка.Дата КАК Дата
                    |ИЗ
                    |	Документ.ПродажаТоваровИУслуг.Товары КАК ПродажаТоваровИУслугТовары
                    |ГДЕ
                    |	ПродажаТоваровИУслугТовары.Ссылка = &Ссылка"</span><span class="vue-r">;</span>
                
                Запрос<span class="vue-r">.</span>УстановитьПараметр<span class="vue-r">(</span><span class="vue-bl">"Ссылка"</span><span class="vue-r">,</span> ПараметрКоманды<span class="vue-r">);</span>
                РезультатЗапроса <span class="vue-r">=</span> Запрос<span class="vue-r">.</span>Выполнить<span class="vue-r">();</span>

                <span class="vue-r">Если НЕ</span> РезультатЗапроса<span class="vue-r">.</span>Пустой<span class="vue-r">() Тогда</span> 
                    Макет <span class="vue-r">=</span> Документы<span class="vue-r">.</span>ПродажаТоваровИУслуг<span class="vue-r">.</span>ПолучитьМакет<span class="vue-r">(</span>"МакетДляПечатиЧекККМ"<span class="vue-r">);</span>
                    Выборка <span class="vue-r">=</span> РезультатЗапроса<span class="vue-r">.</span>Выбрать<span class="vue-r">();</span>

                    ОбластьШапка <span class="vue-r">=</span> Макет<span class="vue-r">.</span>ПолучитьОбласть<span class="vue-r">(</span><span class="vue-bl">"Шапка"</span><span class="vue-r">);</span>
                    ОбластьШапкаТаблицы <span class="vue-r">=</span> Макет<span class="vue-r">.</span>ПолучитьОбласть<span class="vue-r">(</span><span class="vue-bl">"ШапкаТаблицы"</span><span class="vue-r">);</span>
                    ОбластьТоварыТаблицы <span class="vue-r">=</span> Макет<span class="vue-r">.</span>ПолучитьОбласть<span class="vue-r">(</span><span class="vue-bl">"ТоварыТаблицы"</span><span class="vue-r">);</span>
                    ОбластьПодвалТаблицы <span class="vue-r">=</span> Макет<span class="vue-r">.</span>ПолучитьОбласть<span class="vue-r">(</span><span class="vue-bl">"ПодвалТаблицы"</span><span class="vue-r">);</span>
                    
                    Выборка<span class="vue-r">.</span>Следующий<span class="vue-r">();</span>

                    СуммаДокумента <span class="vue-r">=</span> Выборка<span class="vue-r">.</span>СуммаДокумента<span class="vue-r">;</span>

                    ОбластьШапка<span class="vue-r">.</span>Параметры<span class="vue-r">.</span>Номер <span class="vue-r">=</span> Выборка<span class="vue-r">.</span>Номер<span class="vue-r">;</span>
                    ОбластьШапка<span class="vue-r">.</span>Параметры<span class="vue-r">.</span>Дата <span class="vue-r">=</span> Выборка<span class="vue-r">.</span>Дата<span class="vue-r">;</span>
                    ОбластьШапка<span class="vue-r">.</span>Параметры<span class="vue-r">.</span>НазваниеКонтрагента <span class="vue-r">=</span> Выборка<span class="vue-r">.</span>НазваниеКонтрагента<span class="vue-r">;</span>
                    ТекДок<span class="vue-r">.</span>Вывести<span class="vue-r">(</span>ОбластьШапка<span class="vue-r">);</span>
                    ТекДок<span class="vue-r">.</span>Вывести<span class="vue-r">(</span>ОбластьШапкаТаблицы<span class="vue-r">);</span>    

                    Выборка<span class="vue-r">.</span>Сбросить<span class="vue-r">();</span>
                    
                    СуммаКоличеств <span class="vue-r">=</span> 0<span class="vue-r">;</span>
                    <span class="vue-r">Пока</span> Выборка<span class="vue-r">.</span>Следующий<span class="vue-r">() Цикл</span>
                        ОбластьТоварыТаблицы<span class="vue-r">.</span>Параметры<span class="vue-r">.</span>Заполнить<span class="vue-r">(</span>Выборка<span class="vue-r">);</span>
                        ТекДок<span class="vue-r">.</span>Вывести<span class="vue-r">(</span>ОбластьТоварыТаблицы<span class="vue-r">);</span>
                        СуммаКоличеств <span class="vue-r">=</span> СуммаКоличеств <span class="vue-r">+</span> Выборка<span class="vue-r">.</span>Количество<span class="vue-r">;	
                    КонецЦикла; </span>
                    
                    ОбластьПодвалТаблицы<span class="vue-r">.</span>Параметры<span class="vue-r">.</span>СуммаКоличеств <span class="vue-r">=</span> СуммаКоличеств<span class="vue-r">;</span>
                    ОбластьПодвалТаблицы<span class="vue-r">.</span>Параметры<span class="vue-r">.</span>СуммаДокумента <span class="vue-r">=</span> СуммаДокумента<span class="vue-r">;
                    ТекДок<span class="vue-r">.</span>Вывести<span class="vue-r">(</span>ОбластьПодвалТаблицы<span class="vue-r">);</span>
                Иначе</span>
                    Сообщить<span class="vue-r">(</span>"Для разработчика. Результат запроса пустой"<span class="vue-r">);
                КонецЕсли;
            КонецПроцедуры</span></span>
        </pre>
    </div>
    <p>Вот такой результат мы увидим в пользовательской части:</p>
    <img src="../img/1С-1/2023-07-16_11-06-14.png" class="screen" alt="">
    <p><span class="vue-b">Внимание!!! От себя добавлю. Как видно на картинке выше, количество и сумма количества в итоге немного стоят криво. Получилось их выровнять только после того как в переменной [Количество   ] добавил несколько пробелов, также и для суммы количества добавил пробелов и числа сразу прижались к левому краю, как и остальные числа. Если пробелы не поставить, то числа будут ровно в том месте, где заканчивается имя переменной. Имя переменной СуммаКоличеств имеет больше букв, поэтому и число стоит дальше чем число переменной Количество. Поэтому нужно ставить пробелы</span>.</p>

    <p><b id="print-in-form-active-d">Вывод в active document(вывод в Word)</b></p>
    <p>В видео начинается с 01:33:00. Видео - https://www.youtube.com/watch?v=_gZ-8JTl948&list=RDCMUC124tAuP11GlaGpK3YGHzlw&start_radio=1</p>
    <p>В этом случае бывает необходимость вывести печать в виде файла Microsoft Word. Это часто нужно, когда формируется коммерческое предложение, или формируется договор, где важно, чтобы он был оформлен как то красиво. Хотя и в табличном документе можно красиво сделать. Ну короче есть заказчики, которые хотят вывести в Word печатный документ. Чтобы сделать печать документа в файл ворд, нужно использовать тип макета Active Document. Указав такой тип макету, мы превращаем макет в оболочку, которая позволяет работать с внешним приложением Word. В макете нам остаётся сделать точно также переменные, куда будут выводиться данные.</p>
    <p>Итак, создадим новый макет для документа "ПродажаТоваров" и дадим ему тип Active Document. Когда нажмём Готово, вылетит окошко, в котором нужно выбрать какой объект внешнего приложения мы будем использовать внутри 1С. Чтобы вставлять объекты внешних приложений, надо, чтобы эти приложения были установлены на компе. У меня офис установлен. На выбор из Word есть 3 объекта, выбираем Microsoft Word Document. Жмём Готово и в макете откроется панель иструментов прям как в Word и галвное окно с тоже как в ворд. Т.е. внутри 1С открылся Word. Напишем там просто одну строку "Договор на поставку товаров № 12 от 01.09.2023", но вместо номера и даты, нам надо будет подставлять их из документа "ПродажаТоваров".</p>
    <p>Далее добавим команду для вывода печатной формы пользователю. В модуле формы пишем код. Он будет уже совсем другим по сравнению с текстовыми и табличными. Потому что работать уже нужно не с объектом встроенного языка 1С, а с объектом внешнего приложения, а значит свойства и методы уже будут стороннего приложения и будут они на англ. языке. Итак получим макет:</p>
    <div class="code-style">
        <pre>
            --модуль команды
            <span class="vue-b"><span class="vue-r">&НаКлиенте
            Процедура</span> ОбработкаКоманды<span class="vue-r">(</span>ПараметрКоманды<span class="vue-r">,</span> ПараметрыВыполненияКоманды<span class="vue-r">)</span>
                ПечатьВWord<span class="vue-r">(</span>ПараметрКоманды<span class="vue-r">);
            КонецПроцедуры


            &НаСервере
            Процедура</span> ПечатьВWord<span class="vue-r">(</span>ПараметрКоманды<span class="vue-r">)</span>
                Макет <span class="vue-r">=</span> Документы<span class="vue-r">.</span>ПродажаТоваровИУслуг<span class="vue-r">.</span>ПолучитьМакет<span class="vue-r">(</span>"МакетДляПечатиВWord"<span class="vue-r">);
            КонецПроцедуры</span></span>
        </pre>
    </div>
    <p>Если в отладчике посмотреть на тип макета, то он будет называться "ОболочкаActiveDocument". Можно сразу вбить в поиске справочника этот тип и увидим, что макет можно записать в файл. У него всего 2 метода: Записать() и Получить(). Метод Получить() возвращает объект с типом "COMОбъект". Такой тип имеют внешние объекты. <span class="vue-r">Важно!!! Если нужно открыть сформированный документ word на клиенте(показать пользователю), то и COMОбъект нужно создавать на клиенте, а макет нужно получать на сервере</span>. Получим внешний объект из макета:</p>
    <div class="code-style">
        <pre>
            <span class="vue-b">Word <span class="vue-r">=</span> Макет<span class="vue-r">.</span>Получить<span class="vue-r">();</span></span>
        </pre>
    </div>
    <p>В переменной Word теперь лежит объект, который позволяет управлять приложением Word. Чтобы знать какие методы и свойства содержит Word, нужно теперь обращаться к документации Microsoft Word. Если мы напишем такую инструкцию:</p>
    <div class="code-style">
        <pre>
            <span class="vue-b">Word<span class="vue-r">.</span>Application<span class="vue-r">.</span>Visible <span class="vue-r">=</span> Истина<span class="vue-r">;</span></span>
        </pre>
    </div>
    <p>То при клике по команде пользователем запустится приложение Word без открытого документа. Но нам не нужно, чтобы приложение пока запускалось, ведь не видно никакого документа. Поэтому поставим пока Ложь. Т.е. приложение запустится, но не будет видно пользователю. Дальше нужно открыть документ, который мы сделали в макете  и показываем приложение. Делается это инструкциями:</p>
    <div class="code-style">
        <pre>
            <span class="vue-b">Doc <span class="vue-r">=</span> Word<span class="vue-r">.</span>Application<span class="vue-r">.</span>Documents<span class="vue-r">(</span>1<span class="vue-r">);</span>
            Doc<span class="vue-r">.</span>Activate<span class="vue-r">();</span></span>

            <span class="vue-b">Word<span class="vue-r">.</span>Application<span class="vue-r">.</span>Visible <span class="vue-r">=</span> Истина<span class="vue-r">;</span></span>
        </pre>
    </div>
    <p>Теперь при клике откроется Word с открытым документом, именно с тем шаблоном, что у нас в макете. Дальше нужно программно заполнять переменные в макете данными документа, из которого мы и открыли приложение. Но как это сделать? Нам нужно в макет найти и определить куда что вставлять. При работе с Word можно по разному обозначать параметры и по разному заполнять их. Мы будем использовать один из самых удобных способов. Этот способ с использованием закладок. В Word можно устанавливать закладки по тексту и в последующем переключаться по этим закладкам. У нас в строке в макете нужно установить 2 параметра вместо номера и даты. Удалим номер и напишем вместо него переменную с именем НомерДокумента, затем выделим этот параметр, перейдём в панели Word на закладку Вставка и на панели иструментов найдём кнопку Закладка, жмём её. Откроется окошко, где надо написать имя закладки, пишем НомерДокумента и добавляем закладку:</p>
    <img src="../img/1С-1/2023-07-17_13-44-19.png" class="screen" alt="">
    <p>Закладка по умолчанию не выделяется квадратными скобками, а потому не будет видно этих скобок, их можно включить. Чтобы их включить нужно открыть приложение Word, не через 1С, затем Файл - Параметры - Дополнительно и в окне найти флажок "Показывать закладки". Я у себя чёт не нашёл как запустить Word, просто на рабочем столе есть файл вордовский, его запустил и сделал настройки.</p>
    <p>Теперь нам нужно прогрммно подставить значения закладок "НомерДокумента" и "ДатаДокумента":</p>
    <div class="code-style">
        <pre>
            <span class="vue-b"><span class="vue-g">//выбираем закладку "НомерДокумента" и выделяем её</span>
            Word<span class="vue-r">.</span>Bookmarks<span class="vue-r">(</span><span class="vue-bl">"НомерДокумента"</span><span class="vue-r">)</span><span class="vue-r">.</span>Select<span class="vue-r">();</span>
            <span class="vue-g">//и устанавливаем значение текста для этой выделенной закладки 
            //напомню, что на сервере мы можем через ссылку получить любое поле</span>
            Word<span class="vue-r">.</span>Application<span class="vue-r">.</span>Selection<span class="vue-r">.</span>TypeText<span class="vue-r">(</span>ПараметрКоманды<span class="vue-r">.</span>Номер<span class="vue-r">);</span>
            
            <span class="vue-g">//точно также для второй закладки</span>
            Word<span class="vue-r">.</span>Bookmarks<span class="vue-r">(</span><span class="vue-bl">"ДатаДокумента"</span><span class="vue-r">)</span>.Select<span class="vue-r">(</span>);
            Word<span class="vue-r">.</span>Application<span class="vue-r">.</span>Selection<span class="vue-r">.</span>TypeText<span class="vue-r">(</span>Формат<span class="vue-r">(</span>ПараметрКоманды<span class="vue-r">.</span>Дата<span class="vue-r">,</span> <span class="vue-bl">"ДФ=dd.MM.yyyy"</span><span class="vue-r">));</span></span>
        </pre>
    </div>
    <p>Есть другой способ обозначить параметры в макете. Ставим просто в фигурных скобках параметр и локика замены программно уже немного другая.</p>
    <p>Пользователь также сам может поменять закладки на свои данные, а если используются не закладки, а параметры в фигурных скобках, то можно найти все параметры через Ctrl + F или Ctrl + H и заменить. Это так преподователь объяснил. Только я что то пока не понял как пользователь сам может заменить. Ведб если отработает код по подстановке значений вместо параметров, то пользователь уже увидит документ ворд с уже заменёнными значениями, он не увидит ни закладок, ни других параметром. Пока не понятно о чём говорит преподователь. Единственное когда пользователь может увидить закладки, это если мы программно ничего не подставляем. Тогда он сам может поменять.</p>
    <p>Значения параметров можно получать и в запросе, а не через ссылку как мы тут в коде сделали. Итак, общий код работы выглядит так:</p>
    <div class="code-style">
        <pre>
            --модуль команды
            <span class="vue-b"><span class="vue-r">&НаКлиенте
            Процедура</span> ОбработкаКоманды<span class="vue-r">(</span>ПараметрКоманды<span class="vue-r">,</span> ПараметрыВыполненияКоманды<span class="vue-r">)</span>
                ПечатьВWord<span class="vue-r">(</span>ПараметрКоманды<span class="vue-r">);
            КонецПроцедуры


            &НаСервере
            Процедура</span> ПечатьВWord<span class="vue-r">(</span>ПараметрКоманды<span class="vue-r">)</span>
                Макет <span class="vue-r">=</span> Документы<span class="vue-r">.</span>ПродажаТоваровИУслуг<span class="vue-r">.</span>ПолучитьМакет<span class="vue-r">(</span>"МакетДляПечатиВWord"<span class="vue-r">);</span>

                Word <span class="vue-r">=</span> Макет<span class="vue-r">.</span>Получить<span class="vue-r">();</span>
                Word<span class="vue-r">.</span>Application<span class="vue-r">.</span>Visible <span class="vue-r">=</span> Истина<span class="vue-r">;</span>

                Doc <span class="vue-r">=</span> Word<span class="vue-r">.</span>Application<span class="vue-r">.</span>Documents<span class="vue-r">(</span>1<span class="vue-r">);</span>
                Doc<span class="vue-r">.</span>Activate<span class="vue-r">();</span>

                <span class="vue-g">//выбираем закладку "НомерДокумента" и выделяем её</span>
                Word<span class="vue-r">.</span>Bookmarks<span class="vue-r">(</span><span class="vue-bl">"НомерДокумента"</span><span class="vue-r">)</span><span class="vue-r">.</span>Select<span class="vue-r">();</span>
                <span class="vue-g">//и устанавливаем значение текста для этой выделенной закладки 
                //напомню, что на сервере мы можем через ссылку получить любое поле</span>
                Word<span class="vue-r">.</span>Application<span class="vue-r">.</span>Selection<span class="vue-r">.</span>TypeText<span class="vue-r">(</span>ПараметрКоманды<span class="vue-r">.</span>Номер<span class="vue-r">);</span>
                
                <span class="vue-g">//точно также для второй закладки</span>
                Word<span class="vue-r">.</span>Bookmarks<span class="vue-r">(</span><span class="vue-bl">"ДатаДокумента"</span><span class="vue-r">)</span>.Select<span class="vue-r">(</span>);
                Word<span class="vue-r">.</span>Application<span class="vue-r">.</span>Selection<span class="vue-r">.</span>TypeText<span class="vue-r">(</span>Формат<span class="vue-r">(</span>ПараметрКоманды<span class="vue-r">.</span>Дата<span class="vue-r">,</span> <span class="vue-bl">"ДФ=dd.MM.yyyy"</span><span class="vue-r">));</span>

                Word<span class="vue-r">.</span>Application<span class="vue-r">.</span>Visible <span class="vue-r">=</span> Истина<span class="vue-r">;
            КонецПроцедуры</span></span>
        </pre>
    </div>
    <p><span class="vue-d-b">Пример с документом типа Active document</span>.</p>
    <img src="../img/1С-1/2023-07-17_14-25-52.png" class="screen" alt="">
    <p>Не буду описывать этот пример, там в принципе всё то же самое. Скажу только, что когда заказчик присылает шаблон договора в виде word документа, то нам чтобы сделать по нему макет, также копируем всё в шаблоне и вставляем. А потом также размечам места, где будут параметры закладками. Также есть одна мелочь с таблицей. Мы же заранее не знаем сколько в таблице будет товаров, да и рассмотрение заполнения товаров таблицу мы выше не делали, поэтому запишу как заполнять товары.</p>
    <p>При заполнении таблицы в макете, нам нужно обратится к этой таблице. Таблиц в макете может быть несколько, поэтому обращаемся по порядку сверху вниз по числу:</p>
    <div class="code-style">
        <pre>
            //получаем нужную таблицу
            Таблица = Word.Tables.Item(1)

            //организуем цикл по выборке
            НомерСтроки = 1;
            Пока Выборка.Следующий() Цикл
                //добавляем строку в таблицу, начинать будем с добавления 2й строки, потому что первая строка это шапка таблицы
                Row = Таблица.Rows.Add(Таблица.Rows(НомерСтроки + 1));

                //в созданной строке заполняем колонки
                Row.Cells(1).Range.Text = Выборка.Номер;
                Row.Cells(2).Range.Text = Выборка.ПредставлениеТовар;
                Row.Cells(3).Range.Text = "шт.";
                Row.Cells(4).Range.Text = Выборка.Количество;
                Row.Cells(5).Range.Text = Выборка.Цена;
                // и т.д. по шаблону заполняем колонки

                НомерСтроки = НомерСтроки + 1;
            КонецЦикла;
        </pre>
    </div>
    <p>В результате в таблице в Word может оказаться последняя строка пустой и её надо удалить. Как удалить преподаватель не сказал, нужно поискать. Так на вскидку у нас есть число НомерСтроки, к ней прибавим 1 и получим самую последнюю строку и её нужно удалить. Думаю код будет что то вроде Таблица.Rows.Delete(НомерСТроки).</p>
    <p>Вот тут статья про работу с Word - https://infostart.ru/1c/articles/488556/</p>
    <p>На этом про печатные формы пока всё.</p>








    <h3 class="header-style2" id="print-in-form-ex">Как вставить шаблон печатной формы из Excel в 1С</h3>
    <p>Вот в этом видео - https://www.youtube.com/watch?v=_gZ-8JTl948&list=RDCMUC124tAuP11GlaGpK3YGHzlw&start_radio=1</p>
    <p>Или в этом видео - https://www.youtube.com/watch?v=cokJUUHBDk0&list=RDCMUC124tAuP11GlaGpK3YGHzlw&index=2</p>
    <p>С 29 минуты автор видео показывает пример, как из печатной формы в Excel сделать печатную форму для документа в 1С.</p>
    <p>Если кратко, то в конфе 1С через меню Файл открываем файл excel выделяем в нём всё, копируем и вставляем в макет стипом табличный документ.</p>








    <h3 class="header-style2" id="example1">Сделать кнопку Печать для вывода табличной части документа на печать. Первый способ</h3>
    <p>Этот способ предполагает печать документа без сохранения данных документа в базе. Если нас такой способ устраивает и нет необходимости печатать только данные, которые уже есть в базе, то способ не плохой. Бывает нужно, чтобы печатный документ соответствовал тому, который в базе, а тут пользователь может ввести данные в документ, распечатать, потом что то забудет и допечатает и запишет в базу и получатся разные данные в печати и в базе.</p>
    <p>Также у этого способа нет возможности сразу выделить несколько документов в форме списка документа и напечатать их.</p>
    <p>Есть какой-нибудь документ с табличной частью, в которой будут, например, товары. Пользователь только что ввёл товары или открыл документ с уже записанными товарами, не важно, он хочет вывести товары на печать. Делаем форму документа, в форме создаём команду "Печать" и размещаем в командной панели формы. Для команды создадаим обработчик на клиенте с вызовом на сервере. Будем вызывать серверный модуль именно с контекстом, потому что мы не собираемся брать данные из БД, мы хотим взять данные прям из табличной части документа. А контекст формы нам нужен для того, чтобы когда пользователь введёт в табличную часть товары, вдруг он сразу нажмёт на кнопку "Печать", а этих товаров у нас нет ещё ни в БД, ни в копии данных формы на сервере. С контекстом мы передадим эти данные формы на сервер и копия формы на сервере станет идентичной той форме, что на клиенте.</p>
    <p>Теперь на сервере мы можем перебрать табличную часть, это и будут наши данные для табличного документа печати. Также создадим макет для этого вида документа:</p>
    <img src="../img/1С-1/2023-08-30_21-09-22.png" class="screen" alt="">
    <p>И код который мы весь написали в модуле формы документа "СчетНаОплату":</p>
    <div class="code-style">
        <pre>
            --модуль формы

            <span class="vue-b"><span class="vue-r">&НаСервере
            Функция</span> Печать1НаСервере<span class="vue-r">()</span>
                ТабДок <span class="vue-r">= Новый</span> ТабличныйДокумент<span class="vue-r">;</span>
                Макет <span class="vue-r">=</span> Документы<span class="vue-r">.</span>СчётНаОплату<span class="vue-r">.</span>ПолучитьМакет<span class="vue-r">(</span><span class="vue-bl">"Макет"</span><span class="vue-r">);</span>

                ОблШапка <span class="vue-r">=</span> Макет<span class="vue-r">.</span>ПолучитьОбласть<span class="vue-r">(</span><span class="vue-bl">"ОблШапка"</span><span class="vue-r">);</span>	
                ОблСтрока <span class="vue-r">=</span> Макет<span class="vue-r">.</span>ПолучитьОбласть<span class="vue-r">(</span><span class="vue-bl">"ОблСтрока"</span><span class="vue-r">);</span>	
                ОблПодвал <span class="vue-r">=</span> Макет<span class="vue-r">.</span>ПолучитьОбласть<span class="vue-r">(</span><span class="vue-bl">"ОблПодвал"</span><span class="vue-r">);</span>	

                ОблШапка<span class="vue-r">.</span>Параметры<span class="vue-r">.</span>Номер <span class="vue-r">=</span> Объект<span class="vue-r">.</span>Номер<span class="vue-r">;</span>
                ОблШапка<span class="vue-r">.</span>Параметры<span class="vue-r">.</span>Дата <span class="vue-r">=</span> Формат<span class="vue-r">(</span>Объект<span class="vue-r">.</span>Дата<span class="vue-r">,</span> <span class="vue-bl">"ДЛФ=DD"</span><span class="vue-r">);</span>
                ОблШапка<span class="vue-r">.</span>Параметры<span class="vue-r">.</span>Контрагент <span class="vue-r">=</span> Объект<span class="vue-r">.</span>Контрагент<span class="vue-r">;</span>
                ОблШапка<span class="vue-r">.</span>Параметры<span class="vue-r">.</span>Договор <span class="vue-r">=</span> Объект<span class="vue-r">.</span>Договор<span class="vue-r">;</span>
                ТабДок<span class="vue-r">.</span>Вывести<span class="vue-r">(</span>ОблШапка<span class="vue-r">);</span>

                <span class="vue-r">Для каждого</span> Стр <span class="vue-r">Из</span> Объект<span class="vue-r">.</span>Товары <span class="vue-r">Цикл</span>
                    ОблСтрока<span class="vue-r">.</span>Параметры<span class="vue-r">.</span>НомерСтроки <span class="vue-r">=</span> Стр<span class="vue-r">.</span>НомерСтроки<span class="vue-r">;</span>
                    ОблСтрока<span class="vue-r">.</span>Параметры<span class="vue-r">.</span>Товар <span class="vue-r">=</span> Стр<span class="vue-r">.</span>Товар<span class="vue-r">;</span>
                    ОблСтрока<span class="vue-r">.</span>Параметры<span class="vue-r">.</span>ПродажнаяЦена <span class="vue-r">=</span> Стр<span class="vue-r">.</span>ПродажнаяЦена<span class="vue-r">;</span>
                    ОблСтрока<span class="vue-r">.</span>Параметры<span class="vue-r">.</span>Количество <span class="vue-r">=</span> Стр<span class="vue-r">.</span>Количество<span class="vue-r">;</span>
                    ОблСтрока<span class="vue-r">.</span>Параметры<span class="vue-r">.</span>Сумма <span class="vue-r">=</span> Стр<span class="vue-r">.</span>Сумма<span class="vue-r">;</span>

                    <span class="vue-g">//или можно сразу заполнить все данные вот так
                    //ОблСтрока.Параметры.Заполнить(Стр);</span>
            
                    ТабДок<span class="vue-r">.</span>Вывести<span class="vue-r">(</span>ОблСтрока<span class="vue-r">);
                КонецЦикла;</span>

                ОблПодвал<span class="vue-r">.</span>Параметры<span class="vue-r">.</span>СуммаПрописью <span class="vue-r">=</span> ЧислоПрописью<span class="vue-r">(</span>Объект<span class="vue-r">.</span>Товары<span class="vue-r">.</span>Итог<span class="vue-r">(</span><span class="vue-bl">"Сумма"</span><span class="vue-r">), ,</span> <span class="vue-bl">"рубль, рубля, рублей, м, копейка, копейки, копеек, ж, 2"</span><span class="vue-r">);</span>     
                ТабДок<span class="vue-r">.</span>Вывести<span class="vue-r">(</span>ОблПодвал<span class="vue-r">);</span>                                                                                                                       

                ТабДок<span class="vue-r">.</span>ОтображатьСетку <span class="vue-r">=</span> Ложь<span class="vue-r">;</span>
                ТабДок<span class="vue-r">.</span>ОтображатьЗаголовки <span class="vue-r">=</span> Ложь<span class="vue-r">;</span>

                <span class="vue-r">Возврат</span> ТабДок<span class="vue-r">;
            КонецФункции

            &НаКлиенте
            Процедура</span> Печать1<span class="vue-r">(</span>Команда<span class="vue-r">)</span>
                ТабДок <span class="vue-r">=</span> Печать1НаСервере<span class="vue-r">();</span>
                ТабДок<span class="vue-r">.</span>Показать<span class="vue-r">();
            КонецПроцедуры</span>
        </pre>
    </div>









    <h3 class="header-style2" id="example2">Сделать кнопку Печать для вывода табличной части документа на печать. Второй способ</h3>
    <p>Тут стоит задача также печатать документ "СчетНаОплату", но с возможностью печатать сразу несколько документов, выделив их в форме списка документа. А также, чтобы документы были записаны в базу.</p>
    <p>Здесь нам понадобится модуль менеджера. Как я понимаю, модуль менеджера позволяет работать со множеством(со списком) документов одного вида. К уже имеющимся стандартным свойствам, процедурам и функциям модуля менеджера, мы можем добавить и свои процедуры и функции для работы с объектами.</p>
    <p>Вот мы выше описывали такую функцию как: <b>Документы.СчетНаОплату.ПолучитьМакет();</b>. Эта стандартная функция менеджера документов.</p>
    <p>Создадим свою процедуру в модуле менеджера "Печать". После её создания, нам теперь будет доступна эта процедура: <b>Документы.СчетНаОплату.Печать()</b>. Нужно не забывать добавить слово "Экспорт", иначе её вызвать будет невозможно из других мест.</p>
    <p>На самом деле мы можем и не создавать процедуру "Печать" в модуле менеджера, а создать её в обработке команды, только выполняющуюся на сервере и будет работать также. Когда мы обращаемся к конструктору печати, то он создаёт эту процедуру именно в модуле менеджера, зачем, пока не ясно.</p>
    <p>Ну допустим создали процедуру "Печать" в модуле менеджера, далее надо сделать кнопку, по которой будет производится печать документа. В этот раз теперь делаем её не в модуле формы, а в самом прикладном объекте документа.</p>
    <p>Создадим команду "Печать", в свойстве "Группа" нужно выбрать группу, где будет располагаться команда. Нам нужно, чтобы она была в форме документа и в форме списка документа, значит выбираем группу "Командная панель формы.Важное". Если в группе упоминается форма, значит команда будет параметризуемая и свойства ниже станут доступны, такие как "Тип параметра команды" - задаёт для параметра "ПараметрКоманд" обработки команды тип данных, который должен этот параметр принимать; "Режим использования команды" - задаёт то, чем будет параметр "ПараметрКоманды" одной ссылкой или массивом ссылок.</p>
    <p>Указываем для свойства "Тип параметра команды" - ДокументСсылка.СчетНаОплату, теперь команда будет появлять в тех формах документов, где есть поля с таким типом данных. Например, в форме документа "СчетНаОплату" есть поле ссылка с таким типом данных, в форме списка этого документа также есть поле ссылка с таким типом данных, значит в этих формах и появится команда.</p>
    <p>Указываем для свойства "Режим использования команды" значение "Множественный", потому что нам нужна возможность выбрать несколько документов из списка и распечатать их.</p>
    <p>Далее нужно описать логику в модуле команды в обработчике команды. В параметр "ПараметрыКоманды" к нам в обработчик будет прилетать массив с ссылками на выбранные документы, по этим ссылкам нужно получить из базы данные и распечатать их. Не будем всё это делать, дальше и так понятно. За нас это всё может сделать конструктор печати. Пройдя все шаги создания система нам создаст всё тоже самое, что мы прошли чуть выше. Будет таже команда с теме же настройками, только за нас уже будет написан код и создан и нарисован макет. И уже по этим созданным шаблонам мы можем что то подправить.</p>
    <p>Если посмотреть в модуль команды, то видим 2 процедуры, одна на клиенте , другая на сервере. Та что на сервере, вызывает процедуру "Печать" из модуля менеджера. Как я и писал раньше мы могли тут и не вызывать процедуру из модуля менеджера, а прям здесь в этой процедуре получить данные документа. Так зачем же конструктор делает процедуру "Печать" в модуле менеджера и вызывает её? А для того, чтобы была возможность вызывать эту процедуру "Печать" и из других мест системы, например, из какой-нибудь обработки, где мы тоже хотели бы иметь возможность напечатать документ.</p>
    <p><span class="vue-b">При этом способе печати, когда мы в уже существующем и записанном документе добавим в табличную часть товар и сразу нажмём на печать, то только что добаленный товар будет в печати. Система сама записывает документ перед выводом на печать. А вот есть мы создали новый документ и добавили товары и попытаемся нажать печать, то система выдаст предупреждение, что документ ещё не записан в базу. Нужно иметь это ввиду.</span></p>
    <p><span class="vue-r">Грубое нарушение, которое система нам предоставит после использования конструктора это то, что везде в коде в табличный документ будут вставляться параметры ссылки, а не их представления. Особенно в цикле, когда будут подставляться ссылки в наименовании товара, там нужно заранее получить представления товара, чтобы в цикле не было дополнительных запросов. Даже можно сами ссылки не получать, они нам не нужны, нам достаточно будет их представления. Но можно не представления получать, а Наименование, это ведь тоже строка, а не ссылка.</span></p>
    <p><span class="vue-r">Представление можно получить 2мя путями:</span></p>
    <div class="code-style">
        <pre>
            ПРЕДСТАВЛЕНИЕ(СчётНаОплату.Товар) КАК ТоварП
            //или
            СчётНаОплату.Товар.Представление КАК ТоварП
            //Товар это ведь ссылка, а значит доступны все поля через точку, в том числе и поле Представление
        </pre>
    </div>
    <p>На экзаменах за такое снимают балы, если не выбирать сразу представления.</p>


</div>
