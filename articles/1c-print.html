<div class="wrap">
   
    <h2 class="header-style">Печатные формы</h2>

    <ul class="list">
        <li><a href="#print-out-form">Внешняя печатная форма</a></li>
        <li><a href="#print-in-form">Внутренняя печатная форма</a></li>
    </ul>




    <h3 class="header-style2">Внешняя печатная форма(ВПФ)</h3>
    <p>Делаю по видео - https://www.youtube.com/watch?v=LPpZ5hRYpvc&t=7s.   По типовой конфигурации Розница.</p>
    <p>Если открыть Файл - Новый, то в окошке увидим, что внешнее можно создать только обработку и отчёт, внешней печатной формы там нет. Её сделать немного сложней.</p>
    <p>В типовых решениях у многих документов и других объектов есть внутренние печатные формы, но если нам нужно что то в форме подправить, то у нас нету возможности изменить эти формы в типовой, да и в не типовой конфигурации, поэтому и делаются внешние печатные формы, чтобы в этой форме уже можно было под себя изменить форму.</p>
    <p>БСП имеет некий API(программный интерфейс), который позволяет нам подключить внешнюю печатную форму к пользовательскому интерфейсу. Чтобы в меню "Печать" у документа вместе с внутренними печатными формами отображалась и внешняя печатная форма. Чтобы подключить ВПФ нужно следовать некоторым требованиям.</p>
    <p>Как устроенно это взаимодействие? Когда у нас в меню "Печать" уже появится кнопка нашей ВПФ и мы жмём на эту кнопку, то БСП отправляет в нашу ВПФ массив ссылок на документы которые хотим распечатать. Если открыта форма документа то передаётся массив одной ссылки, если мы выделяем в форме списка документа несколько документов, то передаётся массив ссылок на выделенные документы. Наша ВПФ по этой ссылке получает данные из БД этого документа, строит табличный документ, выводит в него все данные и возвращает БСП этот табличный документ. Т.е наша ВПФ получает массив и возвращает табличный документ.</p>
    <p>Так что же такое ВПФ? Это обычная внешняя обработка. Создаём в конфе внешнюю обработку, например, для документа "ЗаказПокупателя" и назовём её "ПечатнаяФормаЗаказаПокупателя". Далее автор видео показал свой сайт, где описаны некоторые объяснения по работе с 1С, вот - <i>https://cs-develop.ru/manuals/</i>. Переходим и выбираем из списка Практики программирования -> Разработка внешних печатных форм для 1С 8.3. На странице будет описан весь процесс создания такой печатной формы. Самая первая функция СведенияОВнешнейОбработке() говорит БСП о своих параметрах, для печати чего она, какая версия, нужна ли безопасность и так далее:</p>
    <div class="code-style">
        <pre>
            --помещаем её в модуль объекта созданной внешней обработки
            <span class="vue-b"><b><span class="vue-r">Функция</span> СведенияОВнешнейОбработке<span class="vue-r">() Экспорт</span>
                ПараметрыРегистрации <span class="vue-r">=</span> ДополнительныеОтчетыИОбработки<span class="vue-r">.</span>СведенияОВнешнейОбработке<span class="vue-r">(</span><span class="vue-bl">"3.1.5.221"</span><span class="vue-r">);</span>
                ПараметрыРегистрации<span class="vue-r">.</span>Вид <span class="vue-r">=</span> ДополнительныеОтчетыИОбработкиКлиентСервер<span class="vue-r">.</span>ВидОбработкиПечатнаяФорма<span class="vue-r">();</span>

                МассивНазначений <span class="vue-r">= Новый</span> Массив<span class="vue-r">;</span>
                МассивНазначений<span class="vue-r">.</span>Добавить<span class="vue-r">(</span><span class="vue-bl">"Документ.РеализацияТоваров"</span><span class="vue-r">);</span>
                ПараметрыРегистрации<span class="vue-r">.</span>Вставить<span class="vue-r">(</span><span class="vue-bl">"Назначение"</span><span class="vue-r">,</span> МассивНазначений<span class="vue-r">);</span>

                ПараметрыРегистрации<span class="vue-r">.</span>Версия <span class="vue-r">=</span> <span class="vue-bl">"21.12.16"</span><span class="vue-r">;</span>
                
                НоваяКоманда <span class="vue-r">=</span> ПараметрыРегистрации<span class="vue-r">.</span>Команды<span class="vue-r">.</span>Добавить<span class="vue-r">();</span>
                НоваяКоманда<span class="vue-r">.</span>Представление <span class="vue-r">=</span> <span class="vue-bl">"Реализация товаров (доработанная)"</span><span class="vue-r">;</span>
                НоваяКоманда<span class="vue-r">.</span>Идентификатор <span class="vue-r">=</span> <span class="vue-bl">"РеализацияТоваровДоработанная"</span><span class="vue-r">;</span>
                НоваяКоманда<span class="vue-r">.</span>Использование <span class="vue-r">=</span> ДополнительныеОтчетыИОбработкиКлиентСервер<span class="vue-r">.</span>ТипКомандыВызовСерверногоМетода<span class="vue-r">();</span>
                НоваяКоманда<span class="vue-r">.</span>ПоказыватьОповещение <span class="vue-r">=</span> Истина<span class="vue-r">;</span>
                
                Разрешение <span class="vue-r">=</span> РаботаВБезопасномРежиме<span class="vue-r">.</span>РазрешениеНаИспользованиеКаталогаВременныхФайлов<span class="vue-r">(</span>Истина<span class="vue-r">,</span> Истина<span class="vue-r">);</span>
                ПараметрыРегистрации<span class="vue-r">.</span>Разрешения<span class="vue-r">.</span>Добавить<span class="vue-r">(</span>Разрешение<span class="vue-r">);</span>
                
                <span class="vue-r">Возврат</span> ПараметрыРегистрации<span class="vue-r">;   
            КонецФункции</span> </b></span>
        </pre>
    </div>















    <h3 class="header-style2" id="print-in-form">Внутренняя печатная форма</h3>
    <p>Поговорим про то как организовать печать документов, как создать печатную форму имея макет в Excel, как создать печатную форму и вывести в текстовый документ, а не в табличный, как организовать печать в Word.</p>
    <p>Печатная форма нужна для того, чтобы данные какого то документа представить в любом печатном виде, чтобы потом распечатать документ на принтере или отправить на электронную почту. Чтобы создать печать документа нужно 3 составляющие: макет, кнопка, код обработки кнопки.</p>
    <p>Саму простую печатную форму можно сделать используя такой инструмент как "Конструктор печати". Найти этот интсрумент можно при выделении объекта документа и в контекстном меню Кострукторы -> Коструктор печати, либо открываем редактор объекта документа и во вкладке Макет справа внизу увидим кнопку с этим коструктором. Конструктор нам создаст стандартную структуру печатной формы:</p>
    <img src="../img/1С-1/2023-07-13_08-48-32.png" class="screen" alt="">
    <p>Понятное дело не все печатные формы построенны по такой структуре, но эта структура как бы часто встречающаяся.</p>
    <p>Итак создадим по конструктору печатную форму. Пройдём по всем шагам конструктора, выберем группу куда хотим добавить команду. Если мы заранее не создавали свою группу в объекте "Группа команд" ветки Общие, то выбираем группу "Командная панель формы.Важное". Всё жмём готово и у нас появится 3 окна: 2 с кодом(в модуле команды и в модуле менеджера) и окно с макетом в табличном документе.</p>
    <p>Более подробно поговорим про макеты. Как говорит преподаватель из IronSkill, <span class="vue-r-b">макет предназначен для хранения в конфигурации различных данных, которые требуются для отображения в процессе работы как всего прикладного решения, так и отдельных его объектов. Также в частности макет позволяет сформировать шаблон печатной формы для последуюущего его заполнения</span>. Пока мне не понятно какие данные хранит в конфигурации макет. Ну наверняка не те данные, что лежат в БД. Нужно будет поинтересоваться. А вот с макетом, который позволяет сформировать шаблон и по этому шаблону потом заполнять табличную часть данными, вроде всё понятно. Такой макет с шаблоном мы и будем использовать для создания печатной формы.</p>

</div>