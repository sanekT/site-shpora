<div class="wrap">
    <h2 class="header-style">Node.js, npm, webpack</h2>
    <h3 class="header-style2">Начало работы</h3>
    
    <p>Будем устанавливать и смотреть сборщик проекта webpack. Этот сборщик собирает файлы воедино из папки src и перегоняет  в папку dist. Gulp это тоже сборщик проектов, но у него есть ещё и функции запуска различных задач(task runner)</p>
    
    <p>Cоздадим папку с проектом на компьютере и откроем в ней терминал. Выполним инициализацию проекта командой <b>npm init</b>. Это делается для того, чтобы создать файл package.json.</p>
    <p>Если нет желания заполнять поля, можно оставить их пустыми, нажимая «Enter» или добавить флаг <b>npm init -y</b>. По окончании заполнения полей, вводим yes и нажмимаем «Enter».</p>
    <p>Проект создан. У нас появился файл «package.json». Это файл манифеста нашего нового проекта, который, помимо той информации, что мы указали в терминале, содержит также информацию о используемых в нашем проекте пакетах и их версиях. Если в дальнейшем нам необходимо будет заново установить все используемые в проекте пакеты, можно будет сделать это всего одной командой <b>npm i</b>. В проект будут автоматически установлены модули соответствующих версий:</p>
    <img src="/site-shpora/img/Node/5.png" alt="" class="screen">
    <p>Далее установим сборщик проекта <b>webpack</b> командой:</p>
    <p><b>npm i webpack --save-dev</b>  или <b>npm i webpack -D</b></p>
    <p>Флаг --save-dev или -D говорит о том что модуль установится локально в файл package.json в категорию devDependencies(модули для разработки). Это удобно тем, что мы можем передать файл package.json другому и он только одной командой <b>npm i</b> установит все модули там прописанные.</p>
    <p>После установки сделается запись в файле package.json о том что наш сборщик установился как зависимость для разработки.</p>
    <img src="/site-shpora/img/Node/6.png" alt="" class="screen">
    <p>В файле package.json есть такая строка как:</p>
    <img src="/site-shpora/img/Node/7.png" alt="" class="screen">
    <p>Это скрипты которые мы можем запускать в консоле вот так:</p>
    <p><b>npm run test</b>  -  и выведется то что написанно в значении этого скрипта</p>
    <p>То есть мы можем дать скрипту какое то название, в примере выше это - test, и назначить какое то выполнение по вызову этой команды.</p>
    <p>Например давайте дадим название build и пусть она вызывает webpack:</p>
    <img src="/site-shpora/img/Node/8.png" alt="" class="screen">
    <p>Зпускаем команду:</p>
    <p><b>npm run build</b></p>
    <img src="/site-shpora/img/Node/9.png" alt="" class="screen">
    <p>Нам говорят что для запуска команды webpack нужен webpack-cli и предлагают его установить.</p>
    <p>Ставим этот пакет:</p>
    <p><b>npm i webpack-cli --save-dev</b></p>
    <p>После установки снова пытаемся запустить наш скрипт build, а он в свою очередь запускает команду webpack. Но после запуска будет ошибка, в котрой говорится что не найден входной модуль(нет точки входа). Для этого создадим в нашем проекте папку src, а в ней создадим файл index.js</p>
    <p>Пробуем снова запустить команду:</p>
    <p><b>npm run build</b></p>
    <p>Теперь всё отработало нормально и у нас в проекте появилась папка dist, а в ней появился файл main.js, в котором webpack заранее написал ряд спомогательных функций для подключеия модулей в дальнейшем.</p>
    <p>Вот первое правило которое делает webpack это перетаскивает код из src/index.js в dist/main.js</p>
    <p>Создадим теперь в проекте файл index.html</p>
    <img src="/site-shpora/img/Node/10.png" alt="" class="screen">
    <p>Чтобы понимать как всё происходит, нужно понимание модулей из js6, импорт и экспорт файлов. Это когда один большой файл можно разбить по частятм и подключать их друг в друга. Например в папке src рядом с нашим файлом index.js есть ещё один файл другого разработчика, например some.js. Но так как webpack перегоняет только файл index.js, то файл другого разработчика может остаться рядом и не тронутым, а нам нужен код и из его файла. Тут нам и поможет новый синтаксис из js6 про модули. Мы идём в файл другого разработчика и видим у него там функции, но некоторые функции не должны быть доступны извне, а только должна быть доступна главная функция. Для этого мы просто экспортируем главную функцию avg.</p>
    <img src="/site-shpora/img/Node/1.jpg" alt="" class="screen"> 
    <p>Теперь нам надо подключить этот модуль some.js и в частности её функцию avg. Для этого идём в файл index.js и пишем там вот так:</p>
    <img src="/site-shpora/img/Node/11.png" alt="" class="screen"> 
    <p>Теперь надо подключить скрипт в файле index.html</p>
    <img src="/site-shpora/img/Node/12.png" alt="" class="screen"> 
    <p>И снова перегоняем все наши файлы подключённые к index.js в main.js:</p>
    <p><b>npm run build</b></p>
    <p>Теперь можно открыть файл index.html в браузере и посмотреть что нам выдало в консоле. В консоле должно отобразиться среднее арифметическое переданных чисел.</p>
    <hr>
    <hr>
    <p>Что теперь делать если нужно подключить сторонние библиотеки, например jQuery. Для этого мы ищем какой командой устанавливается бибилиотека в консоли и устанавливаем её:</p>
    <p><b>npm i jquery --save</b> - ставим флаг --save чтобы установился пакет в категорию dependencies, так как jquery нужен будет и продакшине, а не только для разработки.</p>
    <p>Всё jQuery скачан как модуль и теперь его можно подключить в файле index.js первой строкой <b>import $ from 'jquery';</b>. Ниже в коде теперь можно использовать эту библиотеку. И обратим внимание не надо указывать никакие пути до библиотеки, webpck сам найдёт этут папку с одноимённым названием в папке node_modules, а вот к нашим скриптам нужно указывать пути.</p>
    <img src="/site-shpora/img/Node/13.png" alt="" class="screen"> 
    <p>Всё время нашей работы, когда мы перегоняем index.js в main.js в cmd постоянно выдаётся предупреждение, что не установленна опция mode. В процессе разработке в секции scripts где указан вызов команды webpack нужно указывать флаг --mode prodaction или --mode development:</p>
    <img src="/site-shpora/img/Node/14.png" alt="" class="screen"> 
    <p>Режим development нужен для ускорения перегонки файлов в процессе разработки, а режим prodaction при перегонке файлов минифицирует код.</p>
    <p>Идём далее.</p>
    <p>Чтобы постоянно не писать команду <b>npm run build</b> чтобы увидеть изменения, есть такой модуль как <b>webpack-dev-server</b>, это аналог brousersync, установим его.</p>
    <p><b>npm i webpack-dev-server --save-dev</b></p>
    <p>Установили и теперь допишем в package.json новый скрипт:</p>
    <img src="/site-shpora/img/Node/15.png" alt="" class="screen"> 
    <p>Запустим эту команду:</p>
    <p><b>npm run dev</b></p>
    <p>Теперь запущен режим автоматического обновления страницы браузера при изменении файлов. Нужно перейти по адресу <b>http://localhost:8080</b>. Чтобы автоматом открылся браузер с нужной страницей можно дописать опцию <b>--open</b>:</p>
    <img src="/site-shpora/img/Node/16.png" alt="" class="screen"> 
    <p>Есть небольшая засада с папкой dist, если мы её удалим, то всё вроде отрабатывает, но в браузере мы увидем ошибку. Папка dist создаётся при финальной сборке проекта, а пока мы разрабатываем, webpack как бы создаёт её в своей памяти и браузер не видит файл в папке dist. Поэтому нужно объяснить браузеру откуда его брать, для этого создадим файл с настройками <b>webpack.config.js</b>. Создаём его в общей директории проекта рядом с package.json</p>
    <p>В этом файле создадим объект, который будет объяснять webpackу как мы хотим чтобы он работал и экспортируем этот объект во внешний мир:</p>
    <img src="/site-shpora/img/Node/17.png" alt="" class="screen">
    <p>Далее в этом объекте укажем свойство <b>entry</b>(вход), а в его значении путь до файла, который является точкой входа:</p>
    <img src="/site-shpora/img/Node/18.png" alt="" class="screen">
    <p>Название папки src и файла index.js мы можем менять, только и тут в объекте тоже нужно указать эти изменённые имена. src и index.js по умолчанию создаются с такими именами.</p>
    <p>Итак мы указали точку входа, теперь нужно указать выход, куда мы будем перегонять файлы. Для этого пишем свойство output и он будет объектом, потому что в нём нужно указать 2 вещи. Первая вещь это ключ path, а в его значении путь до папки куда мы будем перегонять, но этот путь должен быть абсолютным. Как же указать абсолютный путь? Один из способов скачать модуль <b>path</b>.</p>
    <p><b>npm i path --save-dev</b></p>
    <p>Затем нужно подключить этот модуль и вызвать метод resolve(это уже серверный язык node.js):</p>
    <img src="/site-shpora/img/Node/19.png" alt="" class="screen">
    <p>Теперь можем проверить и запустить команду</p>
    <p><b>npm run build</b></p>
    <p>Папка dist появилась с файлом внутри. То что мы написали в этом конфигурационном файле можно и не писать, потому как это настройка webpack по умолчанию, но мы это написали для того что теперь можно изменять имена папок и файлов самому и изменять имена точки входа и выхода. Ну и ещё одна причина написания этого конфига, это указание браузеру откуда брать страницу при подключении <b>webpack-dev-server</b>. Для этого укажем 3ю вещь в output:</p>
    <img src="/site-shpora/img/Node/20.png" alt="" class="screen">
    <p>Webpack склеит publicPath и filename и подставит в строку запроса браузера правильный путь до конечного файла. И теперь для проверки удалим папку dist и запустим команду:</p>
    <p><b>npm run dev</b></p>
    <p>В браузере отработало всё нормально и без папки dist, эта папка создалась где то там в памяти. СОздание папки нужно в конце, когда мы запустим команду <b>npm run build</b>, а пока мы пользуемся командой для разработки <b>npm run dev</b>, которая эту папку создаёт пока где то у себя в загашнике. Также теперь прекрасно работает обновление браузера при изменении кода и сохранении его.</p>
    
    
    <h3 class="header-style2">Продолжим</h3>
    <p>Поговорим теперь об ошбках. Сделаем ошибку где нибудь в файле index.js, например забудем написать скобку в jquery:</p>
    <img src="/site-shpora/img/Node/22.png" alt="" class="screen">
    <p>И запустим наш сервер.</p>
    <p><b>npm run dev</b></p>
    <p>Всё отработало как надо и в консоль вывело ошибки, но многие разработчики не любят смотреть ошибки в консоли и в webpack.config.js дописывают такое свойство:</p>
    <img src="/site-shpora/img/Node/21.png" alt="" class="screen">
    <p>Только нужно остановить серсер и заного его запустить, чтобы увидеть новые изменения в конфиге, запускаем и видим вот такой вывод сообщения об ошибках:</p>
    <img src="/site-shpora/img/Node/23.png" alt="" class="screen">
    <p>Ставим скобку обратно сохраняем файл, сервер перезапускает страницу и ошибка исчезает.</p>
    
    
    <h3 class="header-style2">Далее тут перечислю время в видео про остальные модули</h3>
    <p>Видео называется <b>"Webpack 4 - простая сборка проекта" у Дмитрия Лаврика</b>.</p>
    <p><b>00:51:45 - </b>про подключение и настройку Babel</p>
    <p><b>01:08:20 - </b>про подключение и настройку sourcemap(это когда мы делаем ошибку и консоль нам покажет ошибку, но укажет не верную строку с ошибкой, а этот модуль всё исправляет)</p>
    <p><b>01:20:40 - </b>про CSS, как добавить в сборку файл style.css</p>
</div>
