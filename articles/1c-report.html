
<div class="wrap">

    <p>Перейти к оглавлению:</p>
    <ul class="list">
        <li><a href="#chap2">Часть 2</a></li>
        <li><a href="#chap3">Часть 3</a></li>
        <li><a href="#chap4">Часть 4</a></li>
    </ul>


    <p><span class="светло_красный">В формах отчётов можно увидеть, как по другому выводятся пользовательские настройки в быстром доступе. Во-первых в инфобазе Хрусталёвой используется для этой книги используется общая форма отчётов, которая назначена по умолчанию. Во-вторых, чтобы также вывести параметры, нужно вынести из основного реквизита Отчёт пользовательские настройки:</span></p>
    <img src="../img/1С-Для книги по СКД/2025-02-18_08-22-34.png" class="screen" alt="">


    <h3 class="header-style2">Часть 1. Устройство системы компоновки данных.</h3>
    <ul class="list">
        <li><a href="#chapter1">Вступление</a></li>
        <li><a href="#chapter1.1">Схема компоновки данных</a>
            <ul class="list2">
                <li><a href="#chapter1.1.1">Наборы данных</a></li>
                <li><a href="#chapter1.1.2">Связи наборов данных</a></li>
                <li><a href="#chapter1.1.3">Вычисляемые поля</a></li>
                <li><a href="#chapter1.1.4">Ресурсы</a></li>
                <li><a href="#chapter1.1.5">Параметры</a></li>
                <li><a href="#chapter1.1.6">Макеты</a></li>
                <li><a href="#chapter1.1.7">Вложенные схемы</a></li>
                <li><a href="#chapter1.1.8">Настройки</a></li>
            </ul>
        </li>
    </ul>






    <h3 class="header-style2">Часть 2. Примеры разработки отчётов.</h3>
    <ul class="list">
        <li><a href="#chapter2">Вступление</a></li>
        <li><a href="#chapter2.1">Исходные данные для примеров</a></li>
        <li><a href="#chapter2.2">Пример 1. Набор данных - запрос</a>
            <ul class="list2">
                <li><a href="#chapter2.2.1">Наглядное составление отчёта</a></li>
                <li><a href="#chapter2.2.2">Варианты отчёта</a></li>
                <li><a href="#chapter2.2.3">Настройки отдельных группировок</a></li>
            </ul>
        </li>
        <li><a href="#chapter2.3">Пример 2.</a>
            <ul class="list2">
                <li><a href="#chapter2.3.1">Вычисляемые поля</a></li>
                <li><a href="#chapter2.3.2">Парметры. Период отчёта</a></li>
                <li><a href="#chapter2.3.3">Быстрые пользовательские настройки</a></li>
                <li><a href="#chapter2.3.4">Системные поля</a></li>
                <li><a href="#chapter2.3.5">Обязательность использования параметров</a></li>
            </ul>
        </li>
        <li><a href="#chapter2.4">Пример 3. Связь набора данных</a></li>
        <li><a href="#chapter2.5">Пример 4. Связь таблиц внутри набора данных</a>
            <ul class="list2">
                <li><a href="#chapter2.5.1">Связывание таблиц в запросе</a></li>
                <li><a href="#chapter2.5.2">Программный запуск отчёта</a></li>
            </ul>
        </li>
        <li><a href="#chapter2.6">Пример 5. Набор данных  - объединение</a></li>
        <li><a href="#chapter2.7">Пример 6. Автоматическое формирование отчёта и программно установим значения параметров НачалоПериода и КонецПериода</a></li>
        <li><a href="#chapter2.8">Пример 7. <span class="светло_красный">Очень странно описано в книге. Если будет возможность, нужно поузнавать</span>.</a>
            <ul class="list2">
                <li><a href="#chapter2.8.1">Передача параметров в запрос набора данных</a></li>
                <li><a href="#chapter2.8.2">Программная установка параметров отчёта и меняем в сортировке одно поле на другое</a></li>
            </ul>
        </li>
        <li><a href="#chapter2.9">Пример 8. Продажа номенклатуры за указанный период.</a>
            <ul class="list2">
                <li><a href="#chapter2.9.1">Извлечение данных по периодам</a></li>
                <li><a href="#chapter2.9.2">Интерактивное оформление отчета</a></li>
            </ul>
        </li>
        <li><a href="#chapter2.10">Пример 9. Свободная структура таблицы отчёта</a></li>
        <li><a href="#chapter2.11">Пример 10.</a>
            <ul class="list2">
                <li><a href="#chapter2.11.1">Связь наборов данных по периодам</a></li>
                <li><a href="#chapter2.11.2">Функциональные опции</a></li>
            </ul>
        </li>
        <li><a href="#chapter2.12">Пример 11.</a>
            <ul class="list2">
                <li><a href="#chapter2.12.1">Характеристики в отчёте</a></li>
                <li><a href="#chapter2.12.2">Вывод данных в диаграмму</a></li>
            </ul>
        </li>
        <li><a href="#chapter2.13">Пример 12.</a>
            <ul class="list2">
                <li><a href="#chapter2.13.1">Детализация в выбранном периоде</a></li>
                <li><a href="#chapter2.13.2">Выражения для представления полей</a></li>
                <li><a href="#chapter2.13.3">Характеристики в метаданных</a></li>
                <li><a href="#chapter2.13.4">Вывод всех дат в периоде</a></li>
            </ul>
        </li>
        <li><a href="#chapter2.14">Пример 13.</a>
            <ul class="list2">
                <li><a href="#chapter2.14.1">Пользовательские поля</a></li>
                <li><a href="#chapter2.14.2">Вложенный отчет</a></li>
            </ul>
        </li>
        <li><a href="#chapter2.15">Пример 14.</a>
            <ul class="list2">
                <li><a href="#chapter2.15.1">Расчет итогов по полям остатка</a></li>
                <li><a href="#chapter2.15.2">Вывод в диаграмму нескольких ресурсов</a></li>
            </ul>
        </li>
        <li><a href="#chapter2.16">Пример 15.</a>
            <ul class="list2">
                <li><a href="#chapter2.16.1">Набор данных – объект</a></li>
                <li><a href="#chapter2.16.2">Программная компоновка</a></li>
                <li><a href="#chapter2.16.3">Общий макет оформления</a></li>
                <li><a href="#chapter2.16.4">Макет оформления в схеме компоновки</a></li>
            </ul>
        </li>
        <li><a href="#chapter2.17">Пример 16.</a>
            <ul class="list2">
                <li><a href="#chapter2.17.1">Вывод иерархических данных</a></li>
                <li><a href="#chapter2.17.2">Вывод данных в собственной иерархии</a></li>
                <li><a href="#chapter2.17.3">Стандартная расшифровка полей отчета</a></li>
                <li><a href="#chapter2.17.4">Переопределение поля для расшифровки</a></li>
                <li><a href="#chapter2.17.5">Изменение действий расшифровки</a></li>
            </ul>
        </li>
        <li><a href="#chapter2.18">Пример 17.</a>
            <ul class="list2">
                <li><a href="#chapter2.18.1">Язык выражений</a></li>
                <li><a href="#chapter2.18.2">Вывод отчета в общую форму</a></li>
                <li><a href="#chapter2.18.3">Фоновое выполнение отчета</a></li>
            </ul>
        </li>
        <li><a href="#chapter2.19">Пример 18. Работа с системой компоновки данных из встроенного языка</a>
            <ul class="list2">
                <li><a href="#chapter2.19.1">Заполнение наборов данных и компоновка отчета</a></li>
                <li><a href="#chapter2.19.2">Настройка отчета</a></li>
                <li><a href="#chapter2.19.3">Описание схемы компоновки данных</a></li>
            </ul>
        </li>
        <li><a href="#chapter2.20">Пример 19. Консоль системы компоновки данных</a></li>
    </ul>



    <h3 class="header-style2">Часть 3. Справочник разработчика.</h3>









    <h2 class="header-style" id="chapter1">Часть 1. Устройство системы компоновки данных.</h2>
    <p>В данной главе описывается общее устройство системы компоновки данных, рассматривается последовательность и назначение каждого этапа компоновки. Подробно описываются все составляющие схемы компоновки данных, структура отчета и его настроек.</p>
    <p><i>Система компоновки данных</i> – мощный и гибкий инструмент для создания отчетов на основе их декларативного описания. Использование декларативного описания отчетов позволяет воплотить следующие возможности:</p>
    <ul class="list">
        <li>создание отчета без программирования,</li>
        <li>возможность создания различных вариантов отчета,</li>
        <li>возможность задания различных вариантов пользовательских настроек,</li>
        <li>использование автоматически генерируемых форм просмотра и настройки отчета,</li>
        <li>разбиение исполнения отчета на этапы,</li>
        <li>исполнение отдельных этапов построения отчета на различных компьютерах,</li>
        <li>независимое использование отдельных частей системы компоновки данных,</li>
        <li>программное влияние на процесс выполнения отчета,</li>
        <li>настройки структуры отчета,</li>
        <li>совмещение в отчете нескольких таблиц,</li>
        <li>создание вложенных отчетов и др.</li>
    </ul>
    <p>Система компоновки данных состоит из набора элементов, каждый
     из которых имеет свое декларативное описание, возможность программного доступа и сериализации, то есть сохранения в XML или загрузки из XML. Это позволяет гибко управлять всеми этапами выполнения отчета.</p>
    <p>Формирование отчета с использованием системы компоновки данных разбивается на несколько этапов. При этом разбиение на этапы – не логическое, а физическое. То есть в каждый из этих этапов разработчик может вмешаться, программно или визуально, выполнить различные этапы компоновки данных в различных модулях и даже на различных компьютерах:</p>
    <img src="../img/1С-1/2024-05-02_08-35-56.png" class="screen" alt="">
    <p>На схеме представлены следующие этапы формирования отчета:</p>
    <ol class="list">
        <li>Разработчик создает <i>схему компоновки данных</i> и <i>стандартные настройки компоновки</i>, которые содержат полную информацию о компоновке.</li>
        <li>На основе схемы компоновки данных и настроек компоновки <i>компоновщик макета</i> создает <i>макет компоновки данных</i>, который является уже готовым заданием для процессора компоновки. </li>
        <li><i>Процессор компоновки данных</i> в соответствии с макетом компоновки извлекает данные из информационной базы, агрегирует, оформляет эти данные и формирует результат компоновки. Результат компоновки состоит из массива элементов, которые можно получать последовательно, но в большинстве случаев результат компоновки получается целиком.</li>
        <li><i>Процессор вывода</i> обрабатывает <i>результат компоновки</i> и выводит его в различные форматы:
            <ul class="list">
                <li>табличный документ,</li>
                <li>HTML-документ,</li>
                <li>таблица значений,</li>
                <li>дерево значений.</li>
            </ul>
        </li>
    </ol>
    <p>Процесс разработки отчета с помощью системы компоновки данных и его дальнейшего использования на практике реализуется следующим образом.</p>
    <p>Исходя из прикладной задачи, для которой разрабатывается отчет, разработчик создает схему компоновки данных, в которой описывает наборы данных, связи между ними, определяет поля отчета, параметры получения данных и т.п., а также задает <i>стандартные настройки компоновки данных</i> – структуру отчета, порядок, отбор и другие.</p>
    <p>У каждого отчета разработчик может предусмотреть несколько вариантов настроек, представляющих данные в виде диаграммы, таблицы или группировок, имеющих различный состав полей, итогов и т. п. Разработчик может описать, какие настройки отчета будут доступны пользователю (пользовательские настройки) и какие из этих настроек будут присутствовать прямо в форме отчета (быстрые пользовательские настройки). С их помощью пользователь может настроить вариант отчета под себя и сохранить его для дальнейшего использования.</p>
    <p>Пользователь запускает отчет. При его формировании выполняется программная компоновка данных и вывод результатов компоновки пользователю. Данные в отчете выводятся в соответствии со стандартными настройками для основного варианта отчета.</p>
    <p>Пользователь может выбрать вариант отчета, являющийся с его точки зрения наиболее информативным, а может, при желании и соответствующей квалификации, задать собственные настройки и получить другой отчет, основанный на той же схеме компоновки данных. При этом данные будут представлены в соответствии с пользовательскими настройками.</p>
    <p>Таким образом, на основе одной схемы компоновки данных может быть получено множество различных отчетов. Применение настроек компоновки данных, созданных разработчиком или измененных пользователем, к схеме компоновки данных и определяет конечный результат. Этот процесс может быть представлен с помощью следующей схемы.</p>
    <img src="../img/1С-Для книги по СКД/2024-10-31_09-30-39.png" class="screen-2" alt="">




    <h3 class="header-style2" id="chapter1.1">Схема компоновки данных</h3>
    <p>Основой для компоновки отчета является <i>схема компоновки данных</i>. Создание схемы компоновки данных может быть выполнено:</p>
    <ul class="list">
        <li>наглядно при помощи конструктора схемы компоновки данных;</li>
        <li>наглядно при помощи любого редактора, позволяющего редактировать текст XML;</li>
        <li>программно при помощи объектов встроенного языка системы «1С:Предприятие».</li>
    </ul>
    <p>Схема компоновки данных содержит следующие разделы: наборы данных, связи наборов данных, вычисляемые поля, ресурсы, параметры, макеты, вложенные схемы, настройки.</p>

    <p><b id="chapter1.1.1">Наборы данных</b></p>
    <p>Наборы данных являются источниками данных для отчета и описывают способ получения этих данных. Данные можно получить из информационной базы или из некоторых объектов, находящихся в памяти (например, из таблицы значений). Один отчет может использовать одновременно несколько наборов данных, отбирая, объединяя и связывая между собой данные из разных наборов.</p>
    <p>Существуют различные виды наборов данных. Они отличаются тем, откуда получаются данные и как эти данные обрабатываются:</p>
    <ul class="list">
        <li><i>Запрос</i> – содержит запрос к базе данных на языке запросов с использованием дополнительных синтаксических элементов (расширений);</li>
        <li><i>Объект</i> – содержит информацию о внешнем наборе данных, например, таблице значений;</li>
        <li><i>Объединение</i> – объединяет информацию из нескольких наборов данных.</li>
    </ul>
    <p>Разработчик, создавая схему компоновки данных, может добавить в нее наборы данных такого вида и в таком количестве, которые ему необходимы. В зависимости от вида набора данных нужно выполнить различные действия для того, чтобы отчет мог использовать данные этого набора. Например, если используется набор данных – запрос, то в схеме компоновки данных нужно задать текст запроса, обращающегося к информационной базе «1С:Предприятия». Если используется набор данных – объект, то в схеме компоновки нужно описать поля этого набора данных, чтобы система компоновки знала, данные какого типа будут получены из этого набора, затем с помощью встроенного языка создать внешний набор данных и инициализировать им процессор компоновки данных. Если используется набор данных – объединение, то в схеме компоновки данных нужно описать наборы данных, которые входят в это объединение.</p>
    <p>Типичные сценарии использования наборов данных содержатся в первых четырех примерах второй главы.</p>

    <p><b id="chapter1.1.2">Связи наборов данных</b></p>
    <p>Схема компоновки данных может содержать несколько наборов данных. В случае, когда требуется получить связанную информацию из этих наборов, в схеме компоновки данных описывается их связь по какому-то полю. При связывании наборов данных в схеме компоновки используется <i>Левое соединение</i>.</p>
    <p>Однако в случае, если требуется вывести в отчет все записи из обоих наборов данных, используется набор данных – объединение. Такой набор содержит два или более подчиненных набора данных, но информация в них не связывается, а объединяется. По аналогии с языком запросов в этом случае используется <i>Объединение</i>.</p>
    <p>Отличие связывания и объединения наборов данных рассматривается во второй главе.</p>

    <p><b id="chapter1.1.3">Вычисляемые поля</b></p>
    <p>Отчет может содержать не только те поля, которые описаны в наборе данных, но и дополнительные поля, созданные разработчиком и вычисляющиеся на их основе. Значения этих полей получаются в результате вычисления выражений, написанных разработчиком в схеме компоновки данных, или в результате выполнения функций, описанных в общих модулях конфигурации. Напрмиер выводится вычисляемое поле "Прибыль" как разница между полями "СтоимостьПриход" и "СтоимостьРасход".</p>

    <p><b id="chapter1.1.4">Ресурсы</b></p>
    <p>При исполнении отчета с помощью системы компоновки данных из источника данных, например из информационной базы данных, извлекаются данные для отчета. В базе данных они представлены в виде таблиц. Соответственно, все эти данные можно построчно вывести в отчет. Это детальные записи. Но поскольку, как правило, эти данные привязаны к некоторым иерархическим данным (например, в отчет выводятся остатки номенклатуры, где номенклатура содержит многоуровневые группы), то возникает желание сгруппировать записи в отчете и показать остатки номенклатуры по группам (например, сколько на складе телевизоров определенной марки и сколько телевизоров в целом). Для этого система компоновки данных может рассчитывать и добавлять в отчет записи, которые называются итоговыми. Этих записей в явном виде нет в базе данных, но они получаются в результате исполнения отчета, на основании некоторой обработки детальных записей, которую выполняет система компоновки данных.</p>
    <p>Эти групповые итоговые данные называются ресурсами схемы компоновки данных. Обычно данные в отчете группируются по каким-то позициям, например по номенклатуре. Смысл группировки не только в определенном расположении данных, но и в выводе итоговых данных – ресурсов по этой группировке. На основании значений ресурсов формируются общие итоги отчета.</p>
    <p>В приведенном примере детальные записи группируются по складам и выводятся групповые и общие итоги отчета:</p>
    <img src="../img/1С-Для книги по СКД/2024-10-31_10-03-37.png" class="screen-2" alt="">
    <p>В таблице ресурсы выводятся как бы на пересечении соответствующей строки и колонки таблицы, например остатки конкретного товара на конкретном складе. В приведенном примере в отчет выводится таблица, в которой в колонках данные сгруппированы по складам, а в строках – по номенклатуре:</p>
    <img src="../img/1С-Для книги по СКД/2024-10-31_10-07-08.png" class="screen-2" alt="">
    <p>Таким образом, для вывода таблиц и диаграмм обязательно определять ресурсы для отчета. Отчет, выводящий данные в группировку, может и не содержать ресурсов. Например, в случае вывода простых списков, когда групповые итоги не нужны.</p>

    <p><b id="chapter1.1.5">Параметры</b></p>
    <p>Параметры являются критериями получения данных для отчета. Параметры могут быть явно определены в запросе, например вид номенклатуры (&ВидНоменклатуры), а могут быть параметрами виртуальных таблиц базы данных, например начало и конец отчетного периода. Как правило, параметры выводятся пользователю перед формированием отчета. Затем заданные пользователем значения параметров передаются в отчет, и отчет формируется заново, например с новым отчетным периодом:</p>
    <img src="../img/1С-Для книги по СКД/2024-10-31_10-13-09.png" class="screen-2" alt="">

    <p><b id="chapter1.1.6">Макеты</b></p>
    <p>По умолчанию внешний вид отчета формируется системой автоматически. Но разработчик может задать собственное расположение и оформление различных областей отчета. Для этого в схеме компоновки данных создаются предопределенные макеты. В отличие от стандартных макетов оформления, предопределенные макеты привязаны к одному отчету, его конкретным полям и структуре. Можно создавать макеты отдельных полей, группировок, итоговых полей и ресурсов отчета. В приведенном примере группировка по номенклатуре оформлена с помощью предопределенного макета:</p>
    <img src="../img/1С-Для книги по СКД/2024-10-31_10-15-28.png" class="screen-2" alt="">

    <p><b id="chapter1.1.7">Вложенные схемы</b></p>
    <p>Часто бывает нужно использовать данные одного отчета внутри другого. Разработав схему компоновки одного отчета, можно затем многократно использовать ее в других отчетах, связав родительский и вложенный отчеты по общему полю. В приведенном примере выводится список контрагентов с вложенными данными по продажам номенклатуры для каждого из них:</p>
    <img src="../img/1С-Для книги по СКД/2024-10-31_10-18-07.png" class="screen-2" alt="">
    <p>Пример использования вложенного отчета рассматривается во второй главе.</p>

    <p><b id="chapter1.1.8">Настройки</b></p>
    <p>В схеме компоновки данных разработчик задает стандартные настройки, которые определяют, как первоначально будет выглядеть отчет, определяет его иерархическую структуру и настройки как отчета в целом, так и его отдельных элементов.</p>
    <p>На деле то же самое окно настроек, что и в схеме компоновки данных, будет доступно и пользователю при исполнении отчета в режиме 1С:Предприятие по команде "Еще" -> "Изменить вариант…". Но пользоваться этим окном советуется лишь очень опытному пользователю, понимающему, что он делает.</p>
    <p>Иерархическая структура отчета состоит из следующих элементов:</p>
    <ul class="list">
        <li><i>Группировка</i> – предназначена для вывода информации в виде обычного линейного отчета:
        <img src="../img/1С-Для книги по СКД/2024-10-31_10-28-22.png" class="screen-2" alt="">
        </li>
        <li><i>Таблица</i> – предназначена для вывода информации в виде таблицы:
        <img src="../img/1С-Для книги по СКД/2024-10-31_10-07-08.png" class="screen-2" alt="">
        </li>
        <li><i>Диаграмма</i> – предназначена для вывода информации в виде диаграммы:
        <img src="../img/1С-Для книги по СКД/2024-10-31_10-31-25.png" class="screen-2" alt="">
        </li>
        <li><i>Вложенный отчет</i> – предназначен для вывода вложенного отчета</li>
    </ul>
    <p>На первый взгляд элементы структуры отчета <i>Группировка</i> и <i>Таблица похожи</i>. Но в таблице информация группируется по строкам и по столбцам, а на их пересечении выводятся групповые итоговые данные – ресурсы. А также рассчитываются общие итоги по вертикали и горизонтали. В группировке данные группируются по строкам, и общие итоги рассчитываются только по вертикали. Группировку можно вывести в табличном виде (горизонтально), а можно – в виде вертикального списка.</p>
    <p>Для каждого элемента структуры отчета и для всего отчета в целом существуют следующие элементы настроек:</p>
    <ul class="list">
        <li><i>Выбранные поля</i> – с помощью этого элемента настроек разработчик или пользователь может определить список полей, выводящихся в отчет:
        <img src="../img/1С-Для книги по СКД/2024-10-31_10-36-32.png" class="screen-2" alt="">
        </li>
        <li><i>Отбор</i> – с помощью этого элемента настроек разработчик или пользователь может определить условия фильтрации записей в отчете:
        <img src="../img/1С-Для книги по СКД/2024-10-31_10-37-54.png" class="screen-2" alt="">
        </li>
        <li><i>Порядок</i> – с помощью этого элемента настроек разработчик или пользователь может определить порядок записей в отчете:
        <img src="../img/1С-Для книги по СКД/2024-10-31_10-40-03.png" class="screen-2" alt="">
        </li>
        <li><i>Параметры</i> – с помощью этого элемента настроек разработчик или пользователь может задать значения параметров отчета:
        <img src="../img/1С-Для книги по СКД/2024-10-31_10-41-22.png" class="screen-2" alt="">
        </li>
        <li><i>Пользовательские поля</i> – с помощью этого элемента настроек пользователь может создать собственные дополнительные поля:</li>
        <li>Условное оформление – с помощью этого элемента настроек разработчик или пользователь может задать условия оформления записей в отчете:
            <img src="../img/1С-Для книги по СКД/2024-10-31_10-43-18.png" class="screen-2" alt="">
        </li>
        <li>Другие настройки – с помощью этого элемента настроек разработчик или пользователь может задать значения параметров вывода, таких как макет оформления, заголовок, расположение итогов и др.</li>
    </ul>
    <p>В следующем разделе познакомимся с настройками более подробно на примере конкретного отчета.</p>









    <h2 class="header-style" id="chapter2">Часть 2. Примеры разработки отчётов</h2>
    <p>Данная глава содержит набор практических примеров, основанных на реальных задачах. Она будет полезна как для начинающих разработчиков, так и для специалистов, желающих углубить свои знания и навыки по разработке отчетов с помощью системы компоновки данных.</p>



    <h3 class="header-style2" id="chapter2.1">Исходные данные для примеров</h3>
    <p>Разрабатываемые нами отчеты будут основываться на данных о хозяйственной деятельности небольшой фирмы, которая оказывает услуги по сборке, ремонту и продаже компьютеров и комплектующих к ним.</p>
    <p>Приобретение комплектующих отражается в документах ПриходнаяНакладная. Предоставление компьютерных услуг, продажа комплектующих и собранных системных блоков отражаются в документах РасходнаяНакладная. Оба эти документа формируют движения в регистре накопления ОстаткиНоменклатуры, который имеет вид Остатки и содержит два измерения – "Номенклатура" и "Склад" и ресурсы – "Количество" и "Цена".</p>
    <p>Сборка готовых системных блоков отражается в документах СборкаКомпьютера, который формирует движения типа Приход в регистре накопления СобранныеСБ. Этот регистр имеет вид Остатки и содержит два измерения – СБ и Склад, ресурсы – Количество и Стоимость и реквизит – Мастер.</p>
    <p>Одновременно при проведении этого документа формируются движения типа Расход в регистре ОстаткиНоменклатуры. Здесь отражаются комплектующие, которые были израсходованы при сборке.</p>
    <p>Документы РасходнаяНакладная также формируют движения в регистре накопления Продажи. Этот регистр имеет вид Обороты и содержит два измерения – Номенклатура и Контрагент и ресурсы – Количество и Стоимость.</p>
    <p>Документы ПриходнаяНакладная также формируют движения в регистре сведений Цены. Этот регистр является периодическим и имеет измерение Номенклатура и ресурс Цена.</p>
    <p>В базе данных также содержится регистр сведений ДополнительныеХарактеристики для хранения значений характеристик объектов. Этот регистр является непериодическим и имеет два измерения – Объект и ВидХарактеристики и ресурс – ЗначениеХарактеристики.</p>




    <h3 class="header-style2" id="chapter2.2">Пример 1. Набор данных – запрос</h3>
    <p>Практическое знакомство с системой компоновки данных начнем с простого отчета, целиком созданного с помощью наглядных средств разработки. В этом примере подробно, шаг за шагом описываются действия разработчика по наглядному конструированию отчета с помощью системы компоновки данных. В следующих примерах эти действия будут лишь кратко перечисляться. Поэтому данный пример будет полезен для новичков, не знакомых с системой компоновки данных, а остальным просто позволит вспомнить некоторые моменты разработки отчетов.</p>
    <p>После создания отчета мы разработаем другой вариант этого же отчета и на нем покажем возможности настройки отдельных элементов отчета.</p>
    <p>Итак, разработаем отчет, который будет отражать приход, расход и остатки номенклатуры на складах:</p>
    <img src="../img/1С-Для книги по СКД/2024-10-31_13-10-48.png" class="screen" alt="">

    <p><b id="chapter2.2.1">Наглядное составление отчёта</b></p>
    <p>Для наглядного составления отчётов с использованием системы компоновки данных предназначен объект конфигурации "Отчет". Выделим в дереве объектов конфигурации ветвь Отчеты и добавим новый отчет.</p>
    <p>В появившемся окне редактирования назовем отчет ОстаткиНоменклатуры и создадим схему компоновки данных отчета, нажав кнопку "Открыть" схему компоновки данных или кнопку открытия со значком лупы.</p>
    <p>Так как у нашего отчета еще нет схемы компоновки данных, платформа предложит создать новую схему и откроет конструктор макета. В открывшемся окне конструктора макета будет доступен для выбора единственный тип макета – Схема компоновки данных.</p>
    <p>Нажмем кнопку Готово. Платформа создаст макет отчета, содержащий схему компоновки данных, которая в дальнейшем будет доступна на закладке свойств отчета Макеты наряду с другими макетами отчета.</p>
    <p>Затем конструктор макета откроет окно конструктора схемы компоновки данных. В нем происходит основная работа по наглядному составлению отчета. Для этого конструктор предоставляет массу разнообразных возможностей. Но мы пока рассмотрим лишь те из них, которые понадобятся в нашем отчете. Остальные возможности по мере усложнения будут представлены в других примерах.</p>
    <p>Любой отчет основывается на данных, извлекаемых из каких-либо источников по определенным условиям и параметрам. Мы рассмотрим наиболее простой случай, когда используется один набор данных. Он будет содержать запрос к базе данных, сформулированный на специальном языке – <i>языке запросов</i>. </p>
    <p>Итак, на закладке "Наборы данных" добавим новый набор данных – запрос.</p>
    <p>В правом нижнем окне конструктора схемы компоновки данных мы можем создавать и редактировать текст запроса. Текст запроса можно написать вручную, но гораздо проще сделать это с помощью конструктора запроса, нажав кнопку "Конструктор запроса".</p>
    <p>Конструктор запроса позволяет также наглядно составить запрос. Даже пользователь, не знакомый с языком запросов, может с помощью конструктора создать синтаксически правильный запрос.</p>
    <p>Итак, соберём запрос и нажмём ОК, получится так:</p>
    <img src="../img/1С-Для книги по СКД/2024-10-31_13-29-11.png" class="screen" alt="">
    <p>Итак, мы добавили набор данных – запрос и создали текст запроса, выбирающего данные из информационной базы «1С:Предприятия». Текст запроса отображается в поле Запрос. Здесь его можно вручную отредактировать или снова вызвать Конструктор запроса для внесения в него изменений. Так как свойство Автозаполнение включено, платформа автоматически заполнила список доступных полей текущего набора данных исходя из запроса.</p>
    <p>Пока мы не будем рассматривать другие возможности конструктора схемы компоновки данных, а приступим к настройке отчета, то есть к формированию его структуры и внешнего вида.</p>
    <p>Представим наш отчет в виде таблицы, где по строкам данные группируются по позициям номенклатуры, а в колонках – по позициям складов. Групповые итоговые данные – Ресурсы, например остаток конкретного товара на конкретном складе, выводятся в ячейках таблицы.</p>
    <p>Поэтому для того, чтобы увидеть какие-либо значения в таблице, мы должны определить ресурсы схемы компоновки данных.</p>
    <p>На закладке Ресурсы схемы компоновки данных в списке Доступные поля расположены все поля из текущего набора данных отчета. Нажмем кнопку >>, чтобы конструктор выбрал все доступные ресурсы, по которым можно вычислять итоги:</p>
    <img src="../img/1С-Для книги по СКД/2024-10-31_21-26-15.png" class="screen" alt="">
    <p>В колонке "Выражение" здесь содержится выражение, по которому будет вычисляться значение ресурса. По умолчанию предлагается функция Сумма, но доступны и другие распространенные функции агрегирования данных.</p>
    <p>Теперь перейдем на закладку Настройки и создадим стандартные настройки, определяющие, как будет выводиться информация в отчет.</p>
    <p>Выделим корневой элемент Отчет и добавим в него новую таблицу. Для этого нужно нажать кнопку Добавить, расположенную в командной панели окна, или правой кнопкой мыши вызвать контекстное меню элемента Отчет:</p>
    <img src="../img/1С-Для книги по СКД/2024-10-31_21-31-12.png" class="screen-2" alt="">
    <p>В структуре отчета появится элемент Таблица, включающий в себя Строки и Колонки. Выделим элемент Строки и нажмем кнопку Добавить в командной панели или клавишу Ins для добавления новой группировки или через контекстное меню. В появившемся окне выбора поля группировки выберем поле Номенклатура.</p>
    <p>Подобным образом в колонки таблицы добавим группировку по полю Склад. Таким образом мы указали, что в строках таблицы данные будут группироваться по позициям номенклатуры, а в колонках – по позициям складов.</p>
    <p>На закладке Выбранные поля перенесем мышью из списка доступных полей поля, которые будут выводиться в отчет:</p>
    <ul class="list">
        <li>КоличествоНачальныйОстаток,</li>
        <li>КоличествоПриход,</li>
        <li>КоличествоРасход,</li>
        <li>КоличествоКонечныйОстаток.</li>
    </ul>
    <p>Поля Номенклатура и Склад можно не переносить. Они все равно будут выводиться в отчет в составе автополей группировок.</p>
    <p>В результате окно настроек отчета должно принять вид:</p>
    <img src="../img/1С-Для книги по СКД/2024-10-31_21-38-41.png" class="screen" alt="">
    <p>Запустим отчёт и посмотрим результат. Мы видим, что данные в отчете представлены в виде таблицы, строки которой сгруппированы по номенклатуре, а колонки – по складам, а также выведены общие итоги по вертикали и горизонтали.</p>
    <p>Заметьте, что при прокручивании отчета вниз и вправо положение шапки отчета и самой левой колонки остается зафиксированным. Для удобства пользователя платформа автоматически фиксирует табличный документ, в который выводится результат отчета, когда в отчет выводится одна таблица (ФиксацияСлева и ФиксацияСверху) или одна группировка (ФиксацияСверху).</p>
    <p>Таким образом, мы быстро и легко создали простой отчет Остатки номенклатуры, представив данные в виде таблицы. На этом примере мы научились создавать и настраивать схему компоновки данных для нового отчета и рассмотрели следующие ее возможности:</p>
    <ul class="list">
        <li>создание набора данных на основе запроса, используя конструктор
            запроса;</li>
        <li>создание иерархической структуры отчета – добавление таблицы и группировок в отчет;
        </li>
        <li>определение ресурсов для расчета групповых итогов отчета.</li>
    </ul>

    <p><b id="chapter2.2.2">Варианты отчёта</b></p>
    <p>Теперь покажем возможности различных настроек отчета. Настройки могут относиться как ко всему отчету в целом, так и к его отдельным элементам – группировкам, таблицам, диаграммам. Последнее может быть полезно, чтобы выделить разные элементы индивидуальными стилями оформления, установить для каждого элемента свой отбор, сортировку и т.д.</p>
    <p>При установке настроек отчета в средней части окна, под деревом структуры отчета, должна быть выделена кнопка, соответствующая режиму настроек. Кнопка "Отчет" – для настройки отчета в целом или кнопка с именем группировки, например Детальные записи, если настройки относятся только к ней.</p>
    <p>Создадим новый вариант отчета "Остатки номенклатуры" и на его примере покажем несколько вариантов настройки различных элементов структуры отчета.</p>
    <p>У одного и того же отчета может существовать несколько вариантов, представляющих одни и те же данные в различном виде. Например, для отчета "Динамика продаж" одним вариантом отчета может служить диаграмма, показывающая продажи товаров по периодам, а другим – табличный отчет, показывающий продажи товаров в разрезе покупателей. При этом каждый вариант отчета обладает своим набором пользовательских настроек.</p>
    <p>Вернемся в конфигуратор и откроем схему компоновки данных на закладке "Настройки". В левой части окна находится список вариантов отчета. При создании настроек отчета в первый раз система компоновки данных по умолчанию создает "Основной" вариант настроек. Чтобы добавить новый вариант, нажмем кнопку Добавить над этим списком. Зададим имя варианта и его представление как "Оформление":</p>
    <img src="../img/1С-Для книги по СКД/2024-10-31_21-53-11.png" class="screen-2" alt="">
    <p>Мы видим, что структура отчета и все его настройки очистились. Но они не пропали, а стали невидимы, так как относятся к основному варианту настроек. Если у отчета есть несколько вариантов, то мы видим и можем изменять настройки того варианта, который выделен в данный момент. Причем вся остальная информация в схеме компоновке данных (ресурсы, параметры, наборы данных) осталась без изменений. Данные для отчета будут получены с помощью того же запроса к базе данных. Изменятся лишь настройки, которые определят, как будет представлен отчет.</p>
    <p>Добавим в структуру отчета новый элемент Группировка и покажем возможности настройки отдельных элементов отчета. Элемент Группировка позволяет выводить в отчете не только сгруппированную каким-то образом информацию, но и обычные <i>детальные записи</i>, выбранные платформой из источников данных согласно нашему запросу.</p>
    <p>Выделим корневой элемент "Отчет" и добавим в него новую группировку. В появившемся окне выбора поля группировки оставим поле ввода "Поле" пустым, так как мы не хотим группировать записи в отчете. Такая группировка называется "Детальные записи".</p>
    <p>На закладке "Выбранные поля" перенесем мышью из списка доступных полей поля, которые будут выводиться в отчет.</p>
    <p>Сначала покажем настройки отчета в целом. Дадим заголовок отчету. Перейдем на закладку "Другие настройки". В средней части окна настроек выделим кнопку "Отчет" и введем остатки номенклатуры в строку "Заголовок".</p>
    <img src="../img/1С-Для книги по СКД/2025-01-30_13-01-11.png" class="screen" alt="">
    <p>Установим для параметра "Макет оформления" значение "Море".</p>
    <p>Важным элементом настроек является присвоение более коротких и понятных для пользователя заголовков полей отчета. Это можно сделать на закладке "Наборы данных".</p>
    <p>Мы видим, что так как свойство "Автозаполнение" включено, платформа автоматически заполнила колонки "Поле", "Путь" и "Заголовок" полей текущего набора данных исходя из запроса. Поясним их назначение:</p>
    <ul class="list">
        <li>в колонке "Поле" отображается нередактируемое значение имени поля, которое платформа автоматически сформировала из текста запроса (из псевдонима полей, как я понимаю). Это внутреннее имя поля, использующееся только в тексте запроса;</li>
        <li>в колонке "Путь" содержится строка, содержащая путь к данным, по которому к нему можно обратиться в других закладках конструктора схемы компоновки данных. Оно может быть отредактировано. Имена полей, описанные в этой колонке, появляются для разработчика на закладке выбора полей в отчете, описания вычисляемых полей, полей группировки и др., поэтому имеет смысл настроить их понятнее для себя;</li>
        <li>"Заголовок" содержит название поля, под которым поле будет фигурировать в настройках отчета в режиме 1С:Предприятие и в шапке отчета.</li>
    </ul>
    <p>Отредактируем заголовки полей, сделаем их более короткими и понятными. Для этого нужно установить флажок слева от заголовка поля:</p>
    <img src="../img/1С-Для книги по СКД/2025-01-30_13-08-57.png" class="screen" alt="">
    <p>Запустим отчет на исполнение в режиме 1С:Предприятие. В открывшемся окне отчета нажмем кнопку "Выбрать вариант…". В окне вариантов отчета мы видим теперь два варианта – "Основной" и только что созданный нами вариант "Оформление". Выделим его и нажмем кнопку Выбрать.</p>
    <p>Нажмем кнопку "Сформировать". Отчет примет следующий вид:</p>
    <img src="../img/1С-Для книги по СКД/2025-01-30_13-11-46.png" class="screen-2" alt="">
    <p>Мы видим, что в отчет выведена группировка в виде простых детальных записей. Отчет имеет заголовок, и все его элементы оформлены макетом оформления "Море".</p>
    <p>Заметьте, что при прокручивании отчета вниз положение шапки отчета остается зафиксированным. Так происходит потому, что у табличного документа в форме отчета, в который по умолчанию выводится отчет, автоматически установлено свойство "ФиксацияСверху".</p>

    <p><b id="chapter2.2.3">Настройка отдельных группировок</b></p>
    <p>Теперь посмотрим настройку отдельных элементов отчета. Настроим элемент отчета "Детальные записи". Для этого выделим режим настроек отчета "Детальные записи" и на закладке "Другие настройки" дадим заголовок группировке – "Список номенклатуры на складах", а также установим значения параметров "Расположение общих итогов по вертикали" – "Нет" и "Макет оформления" – "Яркий":</p>
    <img src="../img/1С-Для книги по СКД/2025-01-30_15-15-06.png" class="screen" alt="">
    <p>На закладке "Сортировка" отсортируем записи группировки в порядке убывания конечного остатка номенклатуры. Для этого перенесем из списка доступных полей поле "КоличествоКонечныйОстаток" и установим направление сортировки – По убыванию:</p>
    <img src="../img/1С-Для книги по СКД/2025-01-30_15-16-35.png" class="screen-2" alt="">
    <p>На закладке "Условное оформление" выделим цветом записи группировки с конечным остатком меньше или равным единице. Для этого нажмем кнопку "Добавить", расположенную в правом верхнем углу окна настроек. Сначала укажем "Оформление" для выделения полей. Нажмем кнопку выбора в поле "Оформление" и установим красный цвет текста и желтый цвет фона:</p>
    <img src="../img/1С-Для книги по СКД/2025-01-30_15-18-34.png" class="screen-2" alt="">
    <p>Затем укажем условие, при наступлении которого будет применяться оформление. Нажмем кнопку выбора в поле "Условие" и в появившемся окне добавим новый элемент отбора. Для этого нажмем кнопку "Добавить" и укажем в графе "Левое значение" поле "КоличествоКонечныйОстаток", в графе "Вид сравнения" – Меньше или равно, а в графе "Правое значение" – 1:</p>
    <img src="../img/1С-Для книги по СКД/2025-01-30_15-22-57.png" class="screen-2" alt="">
    <p>Затем зададим список оформляемых полей. Если мы хотим выбрать все поля отчета, то можно оставить этот список пустым. Можно указать конкретные поля, нажав кнопку выбора в поле "Оформляемые поля". Для этого в появившемся окне, нажимая кнопку "Добавить", нужно выбрать поля, например, Номенклатура и КоличествоКонечныйОстаток:</p>
    <img src="../img/1С-Для книги по СКД/2025-01-30_15-26-08.png" class="screen-2" alt="">
    <p>Затем зададим представление условного оформления как "Маленький запас". Это является хорошим тоном при создании стандартных настроек для пользователя. В результате, открыв окно пользовательских настроек, вместо непонятной строки "Конечный остаток меньше или равно 1" пользователь увидит осмысленное выражение, которое задано в поле "Представление". В результате окно условного оформления должно принять вид:</p>
    <img src="../img/1С-Для книги по СКД/2025-01-30_15-28-33.png" class="screen-2" alt="">
    <p>В заключение перейдем на закладку "Выбранные поля" и раскроем список полей "Автополя". Для этого выделим его, вызовем его контекстное меню и выберем пункт "Развернуть".</p>
    <p>Здесь мы видим список полей детальной группировки отчета. Так как начального остатка по номенклатуре у нас нет, уберем признак использования у поля "КоличествоНачальныйОстаток", или можно просто удалить его из списка:</p>
    <img src="../img/1С-Для книги по СКД/2025-01-30_15-31-38.png" class="screen-2" alt="">
    <p>Теперь для наглядности добавим в отчет еще одну группировку (внешне похожую на таблицу) и настроим ее по-другому.</p>
    <p>Выделим корневой элемент "Отчет" и добавим в него группировку по полю "Склад". Выделим группировку "Склад" и добавим подчиненную ей группировку "Номенклатура".</p>
    <p>Переместим группировку "Склад" вместе с вложенной в нее группировкой "Номенклатура" в самый верх структуры отчета. Это можно сделать кнопкой Вверх в командной панели настроек отчета или перетаскиванием мышью.</p>
    <p>Перейдем к настройкам группировки "Номенклатура". Для этого выделим режим настроек этой группировки в средней части окна настроек.</p>
    <p>На закладке "Отбор" установим отбор записей для группировки "Номенклатура" с конечным остатком больше единицы. Для этого перенесем из списка доступных полей поле "КоличествоКонечныйОстаток". Установим "Вид сравнения" – Больше, а "Правое значение" – 1. Условие отбора примет вид:</p>
    <img src="../img/1С-Для книги по СКД/2025-01-30_15-35-33.png" class="screen" alt="">
    <p>В заключение выделим корневой элемент структуры отчета "Отчет" и на закладке "Другие настройки" установим параметр "Расположение полей группировок" в значение "Отдельно и только в итогах". Это придаст группировке "Склад" табличный вид.</p>
    <p>Запустим отчет на исполнение в режиме 1С:Предприятие. Нажмем кнопку "Сформировать". Отчет примет следующий вид:</p>
    <img src="../img/1С-Для книги по СКД/2025-01-30_15-38-28.png" class="screen" alt="">
    <p>Итак, мы видим, что у каждого элемента структуры отчета теперь есть свое оформление.</p>
    <p>В верхней группировке записи сгруппированы по складам и номенклатуре. В результате отбора отражаются только записи с конечным остатком номенклатуры больше единицы. Заметьте, что заголовок над группировкой, так же как и макет оформления и список полей отчета, относится не к этой конкретной группировке, а ко всему отчету в целом. Но поскольку для самой группировки эти элементы оформления не установлены, она их наследует от главного отчета.</p>
    <p>Детальный список выводится без общих итогов, в порядке убывания конечного остатка номенклатуры. Записи с конечным остатком меньше или равным единице выделены цветом. В списке отсутствует поле Начальный остаток. Также список выводится со своим заголовком и макетом оформления.</p>





    <h3 class="header-style2" id="chapter2.3">Пример 2.</h3>
    <p>Дальнейшие возможности системы компоновки данных будем изучать на примере отчета, который будет отражать информацию по собранным и проданным системным блокам за указанный период:</p>
    <img src="../img/1С-Для книги по СКД/2025-01-30_15-47-16.png" class="screen" alt="">
    <p>Создадим новый объект конфигурации Отчет и назовем его "ОтчетПоСистемнымБлокам". Откроем конструктор схемы компоновки данных и добавим новый набор данных – запрос. Откроем конструктор запроса. В качествеисточника данных для запроса выберем виртуальную таблицу регистра накопления СобранныеСБ.ОстаткиИОбороты. В список полей перенесем поля из этой таблицы: КоличествоНачальныйОстаток, КоличествоКонечныйОстаток, КоличествоПриход, КоличествоРасход, СтоимостьПриход, СтоимостьРасход, СБ, Склад.</p>
    <p>Нажмем ОК и вернемся в конструктор схемы компоновки данных. Изменим заголовки и пути полей на более понятные: Системный Блок (СБ), Начальный остаток, Конечный остаток. Напомним, что заголовки будут отражаться в шапке отчета и окне настроек пользователя, а пути – в настройках разработчика, в выражениях вычисляемых полей, ресурсов и т. п.</p>
    <p></p>

    <p><b id="chapter2.3.1">Вычисляемые поля</b></p>
    <p>В отчете мы хотим видеть прибыль от продажи собранных системных блоков, то есть разницу между его продажной стоимостью (поле регистра СтоимостьРасход) и стоимостью комплектующих и услуг, израсходованных на сборку компьютера (поле регистра СтоимостьПриход). Значит, для этого нам понадобится создать вычисляемое поле (стр. 358). Перейдем на закладку Вычисляемые поля и добавим его кнопкой Добавить. Дадим ему имя (Путь к данным) – Прибыль, в колонку Выражение введем текст. Заголовок для отображения в отчете формируется по умолчанию, но его можно изменить:</p>
    <img src="../img/1С-Для книги по СКД/2025-01-30_16-53-31.png" class="screen" alt="">
    <p>Перейдем на закладку "Ресурсы" и определим поля ресурсов отчета. Обратите внимание, что созданное ранее вычисляемое поле "Прибыль" тоже добавилось в ресурсы отчета, так как по нему можно подсчитывать групповые итоги:</p>
    <img src="../img/1С-Для книги по СКД/2025-01-30_16-55-50.png" class="screen" alt="">

    <p><b id="chapter2.3.2">Параметры. Период отчёта.</b></p>
    <p>Теперь определим параметры отчета. Для этого перейдем на закладку "Параметры". Мы видим, что платформа уже создала два параметра: НачалоПериода и КонецПериода. Эти параметры используются практически в каждом отчете, так как пользователя интересуют данные о хозяйственной деятельности за определенный период. Первым параметром в отчет передается дата начала периода расчета итогов, вторым – конец отчетного периода. В результате отчет будет содержать только данные за указанный период. Мы можем также добавить свой параметр, но в данном случае нас устраивает список параметров, предложенный нам по умолчанию:</p>
    <img src="../img/1С-Для книги по СКД/2025-01-30_16-59-52.png" class="screen" alt="">
    <p>Поле "Заголовок" можно изменить, так как эти заголовки выводятся при запросе параметров у пользователя. Мы оставим их по умолчанию, но изменим колонку "Тип". Дело в том, что если в отчет передается параметр, содержащий значение типа "Дата", то дата всегда содержит и время с точностью до секунды. Однако пользователя, как правило, не интересуют данные в отчете с такой точностью. И ему незачем указывать еще и время при вводе даты. Поэтому в колонке "Тип" нажмем кнопку выбора и в нижней части окна редактирования типа данных установим состав даты в значение "Дата" для обоих параметров:</p>
    <img src="../img/1С-Для книги по СКД/2025-01-30_17-02-32.png" class="screen-2" alt="">
    <p>Но в таком случае, если пользователь задаст даты периода как 01.12.2011 и 11.12.2011, итоги регистра будут рассчитаны с начала дня 01.12.2011 00:00:00 по начало дня 11.12.2011 00:00:00. То есть данные за 11-е число, отличные от начала дня, в отчет не попадут, а пользователь, конечно, подразумевал этот день включить. Чтобы этого избежать, внесем в поле "Выражение" для параметра "КонецПериода" следующий текст:</p>
    <img src="../img/1С-Для книги по СКД/2025-01-30_17-04-38.png" class="screen" alt="">
    <p>Это выражение, сформулированное на языке выражений системы компоновки данных, содержит функцию КонецПериода(), возвращающую дату, соответствующую концу какого-либо периода, например дня.</p>
    <p>Подробное описание языка выражений системы компоновки данных содержится во встроенной справке системы, в разделе Справка > Содержание справки > Встроенный язык > Общие объекты > Система компоновки данных > Язык выражений системы компоновки данных.</p>
    <p>Заметим, что у параметров снят флажок "Ограничение доступности". Это значит, что эти параметры будут видны в окне настроек пользователя. Также снят флажок "Запрещать незаполненные значения". В случае установки этого флажка при использовании параметров в отчете (признак использования слева от параметра) система проверяет обязательное заполнение параметра. Если значение параметра не указано, то будет выдана ошибка. В нашем случае флажок "Запрещать незаполненные значения" не установлен, поэтому отчет будет формироваться без ошибки и с пустым значением параметра.</p>
    <p>Определим структуру отчета. На закладке "Настройки" выделим корневой элемент Отчет и добавим в него группировку по полю "Склад". Выделим группировку "Склад" и добавим подчиненную ей группировку "СистемныйБлок". Затем на закладке "Выбранные поля" перенесем из списка доступных полей поля:</p>
    <img src="../img/1С-Для книги по СКД/2025-01-30_17-09-03.png" class="screen" alt="">
    <p>На закладке "Другие настройки" дадим заголовок отчету – "Отчет по системным блокам" и установим Макет оформления – Арктика.</p>

    <p><b id="chapter2.3.3">Быстрые пользовательские настройки</b></p>
    <p>В заключение мы должны предоставить пользователю возможность задавать отчетный период перед формированием отчета. То есть параметры "Начало периода" и "Конец периода" должны быть включены в состав пользовательских настроек. Причем эти настройки должны находиться непосредственно в отчетной форме, поскольку задавать отчетный период требуется практически всегда. На закладке "Параметры" установим для каждого из параметров признак использования (флажок слева от параметра). Затем нажмем кнопку "Свойства элемента пользовательских настроек", расположенную в правом нижнем углу окна настроек. Установим флажок "Включать в пользовательские настройки" и оставим предложенное по умолчанию для свойства Режим редактирования значение "Быстрый доступ":</p>
    <img src="../img/1С-Для книги по СКД/2025-01-30_17-13-40.png" class="screen" alt="">
    <p>Флажок "Включать в пользовательские настройки" означает, что эта настройка будет доступна пользователю в отдельном окне (2) при нажатии кнопки "Настройка" (то есть такая настройка, которой он может пользоваться, но не очень часто). А режим редактирования, установленный в значение "Быстрый доступ", означает, что эта настройка будет быстрой пользовательской настройкой, которая будет автоматически отображаться непосредственно в отчетной форме (1). Это настройка, которая нужна пользователю постоянно, чуть ли не при каждом запуске отчета, поэтому она всегда на виду:</p>
    <img src="../img/1С-Для книги по СКД/2025-01-30_17-15-59.png" class="screen-2" alt="">
    <p>Запустим отчет на исполнение в режиме 1С:Предприятие. В открывшейся отчетной форме зададим период отчета с 01.12.2011 по 11.12.2011. Нажмем кнопку "Сформировать". Отчет примет следующий вид:</p>
    <img src="../img/1С-Для книги по СКД/2025-01-30_18-32-38.png" class="screen" alt="">
    <p>Поскольку в базе есть документы по сборке и продаже системных блоков за 11.12.2011, мы видим, что эти данные попали в отчет.</p>
    
    <p><b id="chapter2.3.4">Системные поля</b></p>
    <p>Немного усовершенствуем наш отчет. Уберем признак использования у поля "НачальныйОстаток". Добавим в список выбранных полей отчета вычисляемое поле, сформированное платформой, показывающее процент прибыли по каждому системному блоку от ее общей суммы. Для этого раскроем поле "Прибыль" и перенесем поле "ПроцентОбщий":</p>
    <img src="../img/1С-Для книги по СКД/2025-01-30_18-55-15.png" class="screen" alt="">
    <p>Выделим режим настроек группировки "СистемныйБлок" и добавим нумерацию внутри нее. Для этого раскроем список "Системные поля" и перенесем поле "НомерПоПорядку" так, чтобы поле было первым в списке:</p>
    <img src="../img/1С-Для книги по СКД/2025-01-30_19-08-17.png" class="screen" alt="">
    <p>Запустим отчет на исполнение в режиме 1С:Предприятие. В открывшейся отчетной форме зададим период отчета с 01.12.2011 по 11.12.2011. Нажмем кнопку Сформировать. Отчет примет следующий вид:</p>
    <img src="../img/1С-Для книги по СКД/2025-01-30_19-10-32.png" class="screen" alt="">

    <p><b id="chapter2.3.5">Обязательность использования параметров</b></p>
    <p>Если отчетный период для пользователя не важен, то он может снять признак использования параметров (флажок слева от параметра). В этом случае отчет будет формироваться по всем записям регистра "СобранныеСБ", находящихся в базе данных.</p>
    <p>При включенном признаке использования параметров также можно не задавать их значения. В этом случае отчет будет формироваться без ошибки, поскольку у параметров отчетного периода флажок "Запрещать незаполненные значения" не установлен</p>
    <p>Если же, наоборот, отчетный период нужно вводить всегда, то у параметров в поле "Использование" можно задать "Всегда":</p>
    <img src="../img/1С-Для книги по СКД/2025-01-31_09-04-06.png" class="screen" alt="">
    <p>Таким образом, на примере этого отчета мы научились:</p>
    <ul class="list">
        <li>создавать вычисляемые поля,</li>
        <li>работать с параметрами отчета,</li>
        <li>использовать в отчете системные поля.</li>
    </ul>
    <p>Также мы разработали для отчета удобный пользовательский интерфейс, позволяющий вводить параметры отчета непосредственно в отчетной форме. Позднее мы рассмотрим примеры, задающие в форме пользовательских настроек другие настройки отчета – сортировку, отбор и т. д. Также мы научимся программно задавать значения настроек и передавать их в отчет.</p>







    <h3 class="header-style2" id="chapter2.4">Пример 3. Связь наборов данных</h3>
    <p>Отчет, разработанный с помощью системы компоновки данных, может использовать данные из нескольких (в нашем случае двух) наборов данных. Эти наборы данных описываются каждый по отдельности, а затем в схеме компоновки данных указывается, каким образом они связаны между собой.</p>
    <p>Для показа этой возможности системы компоновки данных разработаем отчет, отражающий информацию о последних ценах поступления товаров, а также связанную с ней информацию о поставщиках, датах и номерах документов, которые произвели движения в регистре сведений "Цены":</p>
    <img src="../img/1С-Для книги по СКД/2025-01-31_11-51-14.png" class="screen-2" alt="">
    <p>Для этого создадим набор данных, получающий информацию из документов "Приходная накладная", и свяжем его с исходным набором, получающим данные из регистра сведений "Цены". Затем мы выведем полученные данные в табличный документ с помощью конструктора настроек.</p>
    <p>Создадим новый объект конфигурации Отчет и назовем его "ЦеныКомплектующихОтПоставщиков". Откроем конструктор схемы компоновки данных и добавим новый набор данных – запрос. Он будет назван по умолчанию НаборДанных1. Для большей наглядности назовем его "Цены". Чтобы ввести новое имя набора данных, можно дважды щелкнуть по его названию.</p>
    <p>Откроем конструктор запроса. В качестве источника данных для запроса выберем виртуальную таблицу регистра сведений Цены.СрезПоследних. В список полей перенесем поля из этой таблицы: Номенклатура, Цена, Регистратор.</p>
    <p>Поле "Регистратор" нам понадобится в качестве ссылки на документ "ПриходнаяНакладная", который произвел движения в регистре сведений "Цены", чтобы установить связь со вторым набором данных. Нажмем ОК и вернемся в конструктор схемы компоновки данных. Таким образом, в этом наборе данных мы получим информацию о последних ценах поступления товаров. Но нам нужна еще другая, связанная с ней более детальная информация из документов "Приходная накладная". </p>
    <p>Выделим корневой элемент дерева наборов данных и добавим еще один набор данных – запрос. Назовем его "Поставщики". Откроем конструктор запроса. В качестве источника данных для запроса выберем объектную таблицу документа "ПриходнаяНакладная". В список полей перенесем поля из этой таблицы: Ссылка, Номер, Дата, Контрагент.</p>
    <p>Поле Ссылка нам понадобится, чтобы установить связь с первым набором данных. Нажмем ОК и вернемся в конструктор схемы компоновки данных. </p>
    <p>Если в схеме компоновки данных присутствуют несколько наборов данных, то между ними требуется установить связь. На закладке "Связи наборов данных" добавим новую строку. Связей в общем случае может быть несколько, даже если набора данных только два. В поле "Источник связи", то есть в качестве родительского набора данных, укажем "Цены", в поле "Приемник связи", то есть в качестве зависимого набора данных, укажем "Поставщики". В поле "Выражение источник" выберем из полей родительского набора поле "Регистратор", а в поле "Выражение приемник" – поле зависимого набора данных – Ссылка:</p>
    <img src="../img/1С-Для книги по СКД/2025-01-31_12-00-13.png" class="screen" alt="">
    <p>Все связи, созданные в схеме компоновки данных, считаются Левыми внешними соединениями, то есть в отчет будут включены записи из обоих наборов данных, удовлетворяющих условию связи Регистратор = Ссылка.</p>
    <img src="../img/1С-Для книги по СКД/2025-01-31_14-43-52.png" class="screen-2" alt="">
    <p>Кроме того, у родительского набора данных Цены будут отражаться в отчете все записи, независимо от того, найден ли соответствующий им документ в наборе данных Поставщики или нет. Поэтому при определении связей наборов данных требуется внимательно обдумать, какой из наборов данных будет родительским, а какой – зависимым.</p>
    <p>Для быстрого создания стандартных настроек воспользуемся конструктором настроек, который вызывается нажатием кнопки "Открыть конструктор настроек" на закладке "Настройки" схемы компоновки данных:</p>
    <img src="../img/1С-Для книги по СКД/2025-01-31_14-45-23.png" class="screen" alt="">
    <p>Сначала выберем тип отчета "Список", что соответствует элементу структуры отчета Группировка, где информация выводится по строкам</p>
    <p>Нажмем кнопку Далее. На следующем шаге определим поля, выводящиеся в отчет. Список доступных полей включает поля из обоих наборов данных. Мышью перетащим из него поля:</p>
    <img src="../img/1С-Для книги по СКД/2025-01-31_14-48-21.png" class="screen-2" alt="">
    <p>Нажмем кнопку Далее. На следующем шаге мы определим, по какому полю будем группировать. Мышью перетащим из списка доступных полей поле Номенклатура:</p>
    <img src="../img/1С-Для книги по СКД/2025-01-31_14-55-06.png" class="screen-2" alt="">
    <p>Нажмем кнопку Далее. На следующем шаге определим поля для сортировки записей в отчете. Мышью перетащим из списка доступных полей поле Дата:</p>
    <img src="../img/1С-Для книги по СКД/2025-01-31_14-56-49.png" class="screen-2" alt="">
    <p>Нажмем ОК. В результате наших действий в окне настроек появилась группировка "Номенклатура" и вложенная в нее группировка "Детальные записи", определен список выбранных полей и задано поле сортировки.</p>
    <p>Запустим отчет на исполнение в режиме 1С:Предприятие. Нажмем кнопку Сформировать.</p>









    <h3 class="header-style2" id="chapter2.5">Пример 4. Связь таблиц внутри набора данных</h3>
    <p>На этом примере мы познакомимся с работой системы компоновки данных с помощью встроенного языка. Разработаем отчет, отражающий список номенклатуры с остатками на складах, и реализуем его программный запуск из списка номенклатуры:</p>
    <img src="../img/1С-Для книги по СКД/2025-01-31_15-05-19.png" alt="">
    <p>Создадим новый объект конфигурации Отчет и назовем его "СписокНоменклатуры". Откроем конструктор схемы компоновки данных и добавим новый набор данных – запрос. Откроем конструктор запроса. В качестве источника данных для запроса выберем объектную ссылочную таблицу "Номенклатура" и виртуальную таблицу регистра накопления ОстаткиНоменклатуры.Остатки. Чтобы исключить неоднозначность имен в запросе, переименуем таблицу "Номенклатура" в "спрНоменклатура". Для этого выделим ее в списке Таблицы и вызовем ее контекстное меню:</p>
    <img src="../img/1С-Для книги по СКД/2025-01-31_15-08-11.png" class="screen-2" alt="">
    <p>В список полей перенесем поля из этих таблиц: Ссылка, Родитель, ВидНоменклатуры, Склад, КоличествоОстаток.</p>

    <p><b id="chapter2.5.1">Связывание таблиц в запросе</b></p>
    <p>Перейдем на закладку "Связи". Так как в запросе теперь участвуют несколько таблиц, требуется определить связь между ними. По умолчанию платформой уже будет создана связь по полю "Номенклатура". Но нам нужно снять флажок "Все" у таблицы "ОстаткиНоменклатуры.Остатки" и установить его у таблицы "спрНоменклатура". Тем самым мы задаем тип связи как Левое соединение, то есть в результат запроса будут включены записи обеих таблиц, удовлетворяющих условию связи по полю "Номенклатура". Кроме того, у таблицы "спрНоменклатура", которая будет слева в тексте запроса, будут отражаться в отчете все записи, независимо от того, найдено ли им соответствие в таблице справа "ОстаткиНоменклатуры.Остатки" или нет. Это нужно потому, что в регистре "ОстаткиНоменклатуры" отражаются записи только по материалам, а отчет выводится по всем видам номенклатуры:</p>
    <img src="../img/1С-Для книги по СКД/2025-01-31_15-10-11.png" class="screen" alt="">
    <p>Перейдем на закладку "Условия" и на уровне запроса установим отбор, чтобы наименования групп не попадали в отчет. Для этого раскроем таблицу "спрНоменклатура", перетащим мышью поле "ЭтоГруппа" в список условий, установим флажок "Произвольное" и внесем в поле "Условие" следующий текст:</p>
    <img src="../img/1С-Для книги по СКД/2025-01-31_15-26-39.png" class="screen" alt="">
    <p><span class="светло_красный">Совет!!! Отбор можно применять и в самом запросе, и в настройках отчета. То же касается сортировки и группировки. Отбор лучше применять в запросе, если записи, не удовлетворяющие условию запроса, наверняка не понадобятся в отчете. Сортировку и группировку лучше применять уже в настройках отчета, чтобы сделать его более гибким.</span></p>
    <p>На закладке "Объединения/Псевдонимы" изменим имена у полей запроса на более понятные.</p>
    <p><span class="светло_красный">Имена полей лучше изменять в запросе, так как в этом случае в схему компоновки данных они перенесутся сразу в три колонки: Поле, Путь и Заголовок, и не нужно будет лишний раз их изменять.</span></p>
    <p>Нажмем ОК и вернемся в конструктор схемы компоновки данных. Текст запроса, сформированный платформой, примет вид:</p>
    <div class="code-style">
        <pre>
            ВЫБРАТЬ
                спрНоменклатура.Ссылка КАК Номенклатура,
                спрНоменклатура.Родитель КАК Группа,
                спрНоменклатура.ВидНоменклатуры КАК Вид,
                ОстаткиНоменклатурыОстатки.Склад,
                ОстаткиНоменклатурыОстатки.КоличествоОстаток КАК Остаток
            ИЗ
                Справочник.Номенклатура КАК спрНоменклатура
                ЛЕВОЕ СОЕДИНЕНИЕ РегистрНакопления.ОстаткиНоменклатуры.Остатки КАК ОстаткиНоменклатурыОстатки
                ПО ОстаткиНоменклатурыОстатки.Номенклатура = спрНоменклатура.Ссылка
            ГДЕ
                спрНоменклатура.ЭтоГруппа = ЛОЖЬ
        </pre>
    </div>
    <p>Для решения нашей задачи – вывода списка номенклатуры с остатками – мы выбрали вариант соединения двух таблиц в запросе, чтобы продемонстрировать эту возможность системы компоновки данных. Но эту же задачу можно решить с использованием двух связанных наборов данных – данных из справочника "Номенклатура" и регистра накопления "ОстаткиНоменклатуры.Остатки".</p>
    <p>Второй вариант лучше использовать в том случае, если получение данных одним запросом породит слишком сложный запрос, когда необходимо выводить в отчет данные с расчетом итогов, без учета дублирующихся записей, при выводе в результат данных из различных типов наборов данных (например, из запроса и таблицы значений).</p>
    <p>Определим структуру отчета. На закладке "Настройки" выделим корневой элемент Отчет и добавим в него группировку по полю "Группа". Выделим группировку "Группа" и добавим подчиненную ей группировку, не указывая группировочное поле, – "Детальные записи". Затем на закладке "Выбранные поля" перенесем из списка доступных полей поля: Номенклатура, Вид, Склад, Остаток:</p>
    <img src="../img/1С-Для книги по СКД/2025-01-31_15-35-02.png" class="screen" alt="">
    <p>На закладке "Другие настройки" установим "Макет оформления" – Яркий. Запустим отчет на исполнение в режиме 1С:Предприятие. Нажмем кнопку Сформировать. Наш отчет примет следующий вид:</p>
    <img src="../img/1С-Для книги по СКД/2025-01-31_15-05-19.png" class="screen-2" alt="">

    <p><b id="chapter2.5.2">Программный запуск отчета</b></p>
    <p>Теперь воплотим вызов нашего отчета из формы списка справочника Номенклатура. Для этого создадим основную форму списка справочника и отредактируем ее. Создадим команду Печать и соответствующую ей кнопку формы, по нажатию которой содержимое отчета СписокНоменклатуры будет выводиться в табличный документ и показываться пользователю. В обработчике команды напишем следующий код:</p>
    <div class="code-style">
        <pre>
            <span class="светло_синий">&НаКлиенте
            Процедура Печать(Команда)
                Результат = ВывестиСписокНоменклатуры();
                Результат.ОтображатьСетку = Ложь;
                Результат.ОтображатьЗаголовки = Ложь;
                Результат.Показать();
            КонецПроцедуры    


            &НаСервереБезКонтекста
            Функция ВывестиСписокНоменклатуры()
                <span class="зелёный">// В качестве схемы компоновки данных используем макет отчета "СписокНоменклатуры".</span>
                СхемаКомпоновкиДанных =
                Отчеты.СписокНоменклатуры.ПолучитьМакет(<span class="серый">"ОсновнаяСхемаКомпоновкиДанных"</span>);

                <span class="зелёный">// Получим настройки по умолчанию.</span>
                Настройки = СхемаКомпоновкиДанных.НастройкиПоУмолчанию;

                <span class="зелёный">// Сформируем макет компоновки данных.</span>
                КомпоновщикМакета = Новый КомпоновщикМакетаКомпоновкиДанных;
                МакетКомпоновки = КомпоновщикМакета.Выполнить(СхемаКомпоновкиДанных, Настройки);

                <span class="зелёный">// Выполним компоновку данных.</span>
                ПроцессорКомпоновкиДанных = Новый ПроцессорКомпоновкиДанных;
                ПроцессорКомпоновкиДанных.Инициализировать(МакетКомпоновки);

                <span class="зелёный">// Выведем результат компоновки в табличный документ.</span>
                ДокументРезультат = Новый ТабличныйДокумент;
                ПроцессорВывода = Новый ПроцессорВыводаРезультатаКомпоновкиДанныхВТабличныйДокумент;
                ПроцессорВывода.УстановитьДокумент(ДокументРезультат);
                ПроцессорВывода.Вывести(ПроцессорКомпоновкиДанных);

                Возврат ДокументРезультат;
            КонецФункции</span>
        </pre>
    </div>
    <p>Из комментариев в тексте обработчика видно, что здесь программно воплощаются все этапы компоновки данных, которые были описаны в первой главе.</p>
    <p>Запустим «1С:Предприятие». Откроем справочник Номенклатура и нажмем кнопку Печать. На экране появится новый табличный документ с данными отчета.</p>
    <p>В данном случае результат отчета выводится в новый табличный документ. Это сделано, чтобы показать изнутри процесс формирования отчета:</p>
    <img src="../img/1С-Для книги по СКД/2025-01-31_19-07-00.png" class="screen" alt="">
    <p>Но можно просто программно открыть форму отчета и при этом передать в нее параметр СформироватьПриОткрытии, установленный в значение Истина, чтобы отчет выводился сразу без нажатия кнопки Сформировать.</p>
    <div class="code-style">
        <pre>
            <span class="светло_синий">&НаКлиенте
            Процедура Отчет(Команда)
                ПараметрыФормы = Новый Структура(<span class="серый">"СформироватьПриОткрытии"</span>, Истина);
                ОткрытьФорму("Отчет.СписокНоменклатуры.Форма", ПараметрыФормы);
            КонецПроцедуры</span>
        </pre>
    </div>
    <p>Запустим «1С:Предприятие». Откроем справочник Номенклатура и нажмем кнопку Отчет. На экране появится наш отчет:</p>
    <img src="../img/1С-Для книги по СКД/2025-01-31_19-05-54.png" class="screen" alt="">
    <p>Результат отчета будет тот же, но поскольку в последнем случае открывается форма отчета, то пользователю предоставляется стандартный сервис – выбор варианта отчета, открытие формы пользовательских настроек, работа с расшифровкой и т. п.</p>
    <p>Однако во втором случае результат отчета стандартно выводится в реквизит формы отчета типа ТабличныйДокумент. Если же требуется выводить результат отчета в другие форматы – таблицу значений, дерево значений и т. п., то нужно использовать первый вариант.</p>
    <p>Таким образом, на этом примере мы научились:</p>
    <ul class="list">
        <li>объединять в запросе несколько таблиц и устанавливать связь между ними;</li>
        <li>создавать условия отбора, псевдонимы полей на уровне запроса;</li>
        <li>запускать и программно формировать отчет из формы списка справочника.
        </li>
    </ul>







    <h3 class="header-style2" id="chapter2.6">Пример 5.  Набор данных – объединение</h3>
    <p>Набор данных – объединение предназначен для разработки отчета, содержащего объединенную информацию из различных наборов данных. Такой набор содержит два или более подчиненных набора данных, но информация в них не связывается, а объединяется.</p>
    <p>В третьем примере (стр. 58) данной главы объяснялось, что при связывании наборов данных в схеме компоновки используется Левое соединение. То есть в отчете будут показаны все записи из левого набора данных, описанного в выражении связи, а из правого набора будут показаны только те записи, которые соответствуют условию связывания. Если же требуется вывести в отчет все записи из обоих наборов данных, используется набор данных – объединение.</p>
    <p>Для примера создадим отчет, объединяющий информацию о поступлении и продаже номенклатуры. В нем мы сгруппируем полученные данные по позициям номенклатуры и выведем их в табличный документ с помощью конструктора настроек:</p>
    <img src="../img/1С-Для книги по СКД/2025-01-31_19-13-17.png" class="screen" alt="">
    <p>Создадим новый объект конфигурации Отчет и назовем его АнализПоступленияПродаж. Откроем конструктор схемы компоновки данных и добавим новый набор данных – объединение:</p>
    <img src="../img/1С-Для книги по СКД/2025-01-31_19-31-05.png" class="screen" alt="">
    <p>В схеме компоновки данных будет создан набор данных типа Объединение с именем НаборДанных1. Выделим его в дереве наборов данных и, вызвав его контекстное меню или нажав кнопку Добавить, добавим в него новый набор данных – запрос:</p>
    <img src="../img/1С-Для книги по СКД/2025-01-31_19-32-25.png" class="screen" alt="">
    <p>Назовем его Поступление:</p>
    <img src="../img/1С-Для книги по СКД/2025-01-31_19-37-13.png" class="screen-2" alt="">
    <p>Откроем конструктор запроса. В качестве источника данных для запроса выберем табличную часть "ПереченьНоменклатуры" таблицы документа "ПриходнаяНакладная". В список полей перенесем поля из табличной части этого документа: Номенклатура, Количество, Сумма.</p>
    <p>На закладке "Объединения/Псевдонимы" изменим имя у поля Количество на Поступило, Сумма на СуммаПоступления.</p>
    <p>Нажмем ОК и вернемся в конструктор схемы компоновки данных. Затем выделим родительский набор данных НаборДанных1 в дереве наборов данных и добавим в него еще один набор данных – запрос. Назовем его Расход. Откроем конструктор запроса. В качестве источника данных для запроса выберем табличную часть ПереченьНоменклатуры таблицы документа РасходнаяНакладная. В список полей перенесем поля из табличной части этого документа: Номенклатура, Количество, Сумма.</p>
    <p>На закладке "Объединения/Псевдонимы" изменим имя у поля Количество на Продано, Сумма на СуммаПродажи. Нажмем ОК и вернемся в конструктор схемы компоновки данных.</p>
    <p>На закладке "Ресурсы" схемы компоновки данных, в списке "Доступные поля" расположены все поля из объединенного набора данных отчета. Нажмем кнопку >>, чтобы конструктор выбрал все доступные ресурсы, по которым можно вычислять итоги.</p>
    <p>Для быстрого создания стандартных настроек воспользуемся конструктором настроек. Нажмем ОК. В результате наших действий в окне настроек появилась группировка Номенклатура и определен список выбранных полей:</p>
    <img src="../img/1С-Для книги по СКД/2025-01-31_19-43-35.png" class="screen" alt="">
    <p>Запустим отчет на исполнение в режиме 1С:Предприятие. Нажмем кнопку Сформировать. Наш отчет примет следующий вид:</p>
    <img src="../img/1С-Для книги по СКД/2025-01-31_19-13-17.png" class="screen-2" alt="">
    <p>Мы видим, что записи в отчете сгруппированы по полю Номенклатура, и для каждой позиции номенклатуры выводятся суммарные значения количества и суммы ее поступления и продажи. Эти данные попадают в отчет путем объединения информации из документов "Приходная накладная" и "Расходная накладная".</p>
    <p>Чтобы было понятней, то можно посмотреть у меня в разделе про запросы 1 часть в конце про объединения. Тут по тому же принципу делает система.</p>







    <h3 class="header-style2" id="chapter2.7">Пример 6. Автоматическое формирование отчета</h3>
    <p>Теперь на основе полученных знаний усовершенствуем отчет "ОтчетПоСистемнымБлокам" так, чтобы при открытии отчета задавались значения параметров по умолчанию и передавались в отчет. Также было бы удобно, чтобы отчет формировался самостоятельно, без нажатия кнопки Сформировать. Напомним как выглядел отчет:</p>
    <img src="../img/1С-Для книги по СКД/2025-01-30_15-47-16.png" alt="">
    <p>Для воплощения этих возможностей создадим основную форму отчета "ОтчетПоСистемнымБлокам". Создадим обработчик события формы "ПриСозданииНаСервере" и заполним его следующим образом:</p>
    <div class="code-style">
        <pre>
            &НаСервере
            Процедура ПриСозданииНаСервере(Отказ, СтандартнаяОбработка)
                Параметры.СформироватьПриОткрытии = Истина;
            КонецПроцедуры   
        </pre>
    </div>
    <p>В обработчике события параметр СформироватьПриОткрытии устанавливается в значение Истина. Таким образом, отчет будет формироваться сразу при открытии формы отчета.</p>
    <p>Теперь программно установим значения параметров НачалоПериода и КонецПериода и передадим их в отчет.</p>
    <p>Для этого сначала представим последовательность событий, которые возникают в модуле формы отчета и в модуле объекта отчета при формировании отчета при его открытии:</p>
    <img src="../img/1С-Для книги по СКД/2025-01-31_20-20-42.png" class="screen-2" alt="">
    <p>Сначала у формы отчета вызывается событие ПриСозданииНаСервере. В нем мы задаем необходимость формирования отчета сразу же при его открытии. Затем происходят четыре события, поставляемые расширением управляемой формы для отчета.</p>
    <p>Сначала выполняется загрузка настроек варианта отчета (основного или выбранного пользователем при последнем формировании отчета) в компоновщик настроек. При этом вызываются события ПередЗагрузкойВариантаНаСервере и ПриЗагрузкеВариантаНаСервере. Очевидно, нам нужно создать обработчик события ПередЗагрузкойВариантаНаСервере, чтобы в нем изменить параметры настроек перед их загрузкой в компоновщик:</p>
    <div class="code-style">
        <pre>
            <span class="светло_синий">&НаСервере
            Процедура ПередЗагрузкойВариантаНаСервере(Настройки)
                Настройки.ПараметрыВывода.УстановитьЗначениеПараметра(<span class="серый">"Заголовок"</span>,
                <span class="серый">"Продажа системных блоков"</span>);
                Настройки.ПараметрыДанных.УстановитьЗначениеПараметра(<span class="серый">"НачалоПериода"</span>, '20111201');
                Настройки.ПараметрыДанных.УстановитьЗначениеПараметра(<span class="серый">"КонецПериода"</span>, '20111231');
            КонецПроцедуры</span>    
        </pre>
    </div>
    <img src="../img/1С-Для книги по СКД/2025-02-01_08-46-21.png" class="screen" alt="">
    <p>В параметре "Настройки" в обработчик передаются настройки варианта отчета, имеющие тип "НастройкиКомпоновкиДанных". В данном обработчике методом УстановитьЗначениеПараметра() изменен заголовок отчета, а также установлены значения параметров начала и конца отчетного периода. Однако если настройки являются пользовательскими (в нашем случае – это параметры отчетного периода) и пользователь хоть раз задавал их значения в форме отчета, то устанавливать их в этом обработчике бесполезно.</p>
    <p>Это происходит потому, что после загрузки настроек варианта отчета восстанавливаются пользовательские настройки, сделанные пользователем при последнем формировании отчета и автоматически сохраненные платформой. Пользовательские настройки накладываются на настройки варианта и загружаются в компоновщик настроек. При этом вызываются события ПередЗагрузкойПользовательскихНастроекНаСервере и ПриЗагрузкеПользовательскихНастроекНаСервере.</p>
    <p>Так как в схеме компоновки данных мы указали параметры "НачалоПериода" и "КонецПериода" в составе быстрых пользовательских настроек, то нам нужно создать обработчик события ПередЗагрузкойПользовательскихНастроекНаСервере, чтобы в нем изменить параметры пользовательских настроек перед их загрузкой в компоновщик:</p>
    <div class="code-style">
        <pre>
            <span class="светло_синий">&НаСервере
            Процедура ПередЗагрузкойПользовательскихНастроекНаСервере(Настройки)
                Настройки.Элементы[0].Значение = '20111201';
                Настройки.Элементы[0].Использование = Истина;
                Настройки.Элементы[1].Значение = '20111231';
                Настройки.Элементы[1].Использование = Истина;
            КонецПроцедуры  </span>  
        </pre>
    </div>
    <p>В параметре "Настройки" в обработчик передаются настройки варианта отчета, имеющие тип ПользовательскиеНастройкиКомпоновкиДанных. Так как параметра всего два, то можно обращаться к ним по индексу (0, 1) в коллекции элементов пользовательских настроек. Мы устанавливаем значения параметров начала и конца отчетного периода и задаем для них признак использования. Эти настройки загружаются в компоновщик настроек, и отчет формируется с заданными параметрами.</p>
    <p>Дальше платформа автоматически вызывает метод СкомпоноватьРезультат(), и происходит событие отчета ПриКомпоновкеРезультата. Отчет компонуется и выводится пользователю.</p>
    <p>Запустим «1С:Предприятие» и откроем наш отчет.</p>
    <p>Как мы видим, отчет формируется сразу же при его открытии, и параметрам Начало периода и Конец периода по умолчанию присвоены значения – начало и конец месяца. Дальше пользователь может произвольно их менять и переформировывать отчет, пользуясь кнопкой Сформировать.</p>
    <p></p>








    <h3 class="header-style2" id="chapter2.8">Пример 7. Очень странно описано в книге.</h3>
    <p>На примере этого отчета мы покажем использование в схеме компоновки данных данные из двух (нескольких) наборов данных, а также передачу параметров в объектную (ссылочную) таблицу запроса. Отчет должен отражать информацию о собранных системных блоках за период с детализацией информации по номеру, дате и мастеру сборки:</p>
    <img src="../img/1С-Для книги по СКД/2025-02-01_09-20-54.png" class="screen-2" alt="">
    <p>Создадим новый объект конфигурации Отчет и назовем его СборкаСистемныхБлоков. Откроем конструктор схемы компоновки данных и добавим новый набор данных – запрос. Он будет назван по умолчанию НаборДанных1. Откроем конструктор запроса. В качестве источника данных для запроса выберем объектную таблицу регистра накопления СобранныеСБ. В список полей перенесем поля из этой таблицы: СБ, Количество, Стоимость, Мастер, Регистратор.</p>
    <p>Поле "Регистратор" нам понадобится в качестве ссылки на документ СборкаКомпьютера, который произвел движения в регистре накопления СобранныеСБ, чтобы установить связь со вторым набором данных. Перейдем на закладку Условия, раскроем таблицу СобранныеСБ и перетащим мышью поле ВидДвижения в список условий. Оставим предложенное условие по умолчанию. Это условие нам нужно, чтобы в отчете отражались данные из регистра с видом движения Приход, т.е мы будем показывать все собранные системные блоки за период:</p>
    <img src="../img/1С-Для книги по СКД/2025-02-01_14-21-05.png" class="screen" alt="">
    <p>На закладке "Объединения/Псевдонимы" изменим имя у поля СБ на СистемныйБлок. Нажмем ОК и вернемся в конструктор схемы компоновки данных. Таким образом, в этом наборе данных мы получим информацию о собранных системных блоках, их количестве, стоимости, мастере, выполнившем сборку. Но нам нужна еще другая, связанная с ней более детальная информация из документов по сборке системных блоков. Есть несколько путей осуществления этой задачи, но мы будем получать эти данные из связанного набора данных.</p>
    <p>Добавим еще один набор данных – запрос. Он будет назван НаборДанных2. Чтобы добавление стало доступным, нужно выделить корневой элемент дерева наборов данных.</p>
    <p>В качестве источника данных для этого набора выберем в запросе объектную таблицу документа СборкаКомпьютера. В список полей перенесем поля из этой таблицы: Дата, Номер, Ссылка.</p>
    <p>Поле Ссылка нам понадобится, чтобы установить связь с первым набором данных. Нажмем ОК и вернемся в конструктор схемы компоновки данных.</p>
    <p>С точки зрения эффективности исполнения отчета лучше получать в дочернем наборе(из набора документов) сразу только те записи, которые удовлетворяют условию связи наборов данных. Т.е. в первом наборе мы по указанному периоду передадим промежуток вермени, из которого выберутся записи из регистра. Регистраторы, которые попали в этот промежуток это и есть массив ссылок документов, нужные нам для отбора во втором наборе. Это нужно чтобы во втором наборе не выбирались все документы, а только те, которые есть в первом наборе. Для этого нужно указать в запросе дочернего набора параметр связи и использовать его в схеме компоновки при описании связи. Иначе в дочернем наборе будет получено много лишних записей, которые затем будут откидываться как не удовлетворяющие условию связи:</p>
    <img src="../img/1С-Для книги по СКД/2025-02-17_10-11-22.png" class="screen-2" alt="">
    <p>В текст запроса добавим условие с параметром Ссылка:</p>
    <div class="code-style">
        <pre>
            ВЫБРАТЬ
                СборкаКомпьютера.Дата,
                СборкаКомпьютера.Номер,
                СборкаКомпьютера.Ссылка
            ИЗ
                Документ.СборкаКомпьютера КАК СборкаКомпьютера
            ГДЕ
                <span class="светло_красный">СборкаКомпьютера.Ссылка В (&Ссылка)</span>
        </pre>
    </div>
    <p>Для большей наглядности назовем первый набор данных "РегистрСБ", второй – "ДокументСБ". Чтобы ввести новое имя набора данных, можно дважды щелкнуть мышью по его названию. Если в схеме компоновки данных присутствуют несколько наборов данных, то между ними требуется установить связь.</p>
    <p>На закладке Связи наборов данных добавим новую строку. В поле Источник связи, то есть в качестве родительского набора данных, укажем РегистрСБ, в поле Приемник связи, то есть в качестве зависимого набора данных, укажем ДокументСБ. В поле Выражение источник выберем из полей родительского набора поле Регистратор, а в поле Выражение приемник – поле зависимого набора данных – Ссылка. В поле Параметр выберем из списка параметров параметр Ссылка.</p>
    <p>Все связи, созданные в схеме компоновки данных, считаются Левыми внешними соединениями, то есть в отчет будут включены записи из обоих наборов данных, удовлетворяющих условию связи Регистратор = Ссылка. Кроме того, у родительского набора данных РегистрСБ будут отражаться в отчете все записи, независимо от того, найден ли соответствующий им документ в наборе данных ДокументСБ или нет. Поэтому при определении связей наборов данных требуется внимательно обдумать вопрос, какой из наборов данных будет родительским, а какой – зависимым.</p>

    <p><b id="chapter2.8.1">Передача параметров в запрос набора данных</b></p>
    <p>Перейдем на закладку "Ресурсы" и определим доступные поля ресурсов отчета. На закладке "Параметры" мы видим параметры компоновки данных, созданные платформой:</p>
    <img src="../img/1С-Для книги по СКД/2025-02-17_11-06-11.png" class="screen-2" alt="">
    <p><span class="светло_красный">Мне пока не понятно, что система указала в качестве значения для параметра Ссылка. Как я понимаю нужно передать массив ссылок, а тут написано - "Документ.СборкаКомпьютера.", ещё и с точкой на конце, вообще не понятно.</span></p>
    <p>Параметру ВидДвижения по умолчанию установлен тип СистемныеПеречисления.ВидДвиженияНакопления, присвоено значение Приход, и установлена его недоступность для пользователя. Также недоступен параметр Ссылка, который служит для получения значения связи наборов данных, используемых в схеме компоновки данных отчета.</p>
    <p>Это нас устраивает, но мы не видим здесь автоматически созданных параметров начала и конца периода, так как в обоих наборах данных мы использовали объектные, а не виртуальные таблицы. В этом случае мы должны явно задать эти параметры в запросе родительского набора данных. Откроем конструктор запроса набора РегистрСБ и перейдем на закладку "Условия". Раскроем таблицу СобранныеСБ и перетащим в список условий поле "Период". Отметим, что условие является произвольным, и внесем в поле "Условие" следующий текст:</p>
    <div class="code-style">
        <pre>
            СобранныеСБ.Период >= &НачалоПериода
            СобранныеСБ.Период &lt;= &КонецПериода
        </pre>
    </div>
    <p>Нажмем ОК. Зададим настройки параметров так же, как и во втором примере. На закладке "Параметры" для параметров НачалоПериода и КонецПериода в колонке "Тип" нажмем кнопку выбора и в нижней части окна редактирования типа данных установим "Состав даты" в значение "Дата". Для параметра КонецПериода зададим значение колонки "Выражение", чтобы данные за последний день отчета были включены в расчет:</p>
    <p>Снимем флажок "Ограничение доступности" у этих параметров, так как они будут задаваться пользователем при формировании отчета. А также установим для них свойство "Использование" в значение "Всегда". Так как параметры передаются в запрос всегда, то установка обязательного использования параметров позволит сформировать отчет без ошибки, даже если значения параметров не указаны. В результате параметры компоновки данных примут вид:</p>
    <img src="../img/1С-Для книги по СКД/2025-02-17_11-15-00.png" class="screen" alt="">
    <p>Определим структуру отчета. На закладке "Настройки" выделим корневой элемент "Отчет" и добавим в него группировку по полю СистемныйБлок. Затем добавим вложенную в нее группировку Мастер. Выделим группировку Мастер и добавим вложенную в нее группировку без указания группировочного поля ДетальныеЗаписи. Затем на закладке "Выбранные поля" перенесем из списка доступных полей поля: Количество, Стоимость, Дата, Номер:</p>
    <img src="../img/1С-Для книги по СКД/2025-02-17_11-24-42.png" class="screen" alt="">
    <p>На закладке Сортировка зададим порядок сортировки записей в отчете.  Для этого перенесем мышью из списка доступных полей поля Дата и Номер. Тем самым мы установили, что внутри группировки детальные записи будут сортироваться по дате, а в пределах одной даты – по номеру документа. Поля группировок автоматически упорядочиваются по группировочному полю. Нажмем кнопку Свойства элемента пользовательских настроек, расположенную вверху, в командной панели окна настроек, и включим настройку Порядок в состав пользовательских настроек отчета:</p>
    <img src="../img/1С-Для книги по СКД/2025-02-18_07-23-49.png" class="screen" alt="">
    <p>Усовершенствуем внешний вид отчета. На закладке Наборы данных выделим набор данных ДокументСБ и в колонке Оформление зададим формат поля Дата, чтобы дата отображалась без времени. Вызовем диалог Формат поля и в строку Формат введем выражение. Для этого можно также воспользоваться конструктором.</p>
    <div class="code-style">
        <pre>
            ДФ=dd.MM.yyyy   
        </pre>
    </div>
    <p>На закладке Параметры включим параметры Начало периода и Конец периода в состав быстрых пользовательских настроек. На закладке "Другие настройки" установим заголовок отчета Сборка Системных Блоков, а макет оформления отчета – Арктика.</p>
    <p>А также покажем возможность управлять расположением ресурсов. Стандартной позицией ресурсов является позиция – "После всех полей".</p>
    <p>Мы установим параметр "Авто позиция ресурсов" в значение "Не использовать" и включим эту настройку в состав обычных пользовательских настроек, доступных в форме "Настройка":</p>
    <img src="../img/1С-Для книги по СКД/2025-02-18_07-24-01.png" class="screen-2" alt="">
    <p>При этом значении параметра поля ресурсов будут располагаться в порядке расположения в отчете – сначала поля группировок, потом в том порядке, в котором они расположены на закладке "Выбранные поля" настроек отчета. Запустим «1С:Предприятие» и сформируем отчет за период 01.12.2011– 31.12.2011:</p>
    <img src="../img/1С-Для книги по СКД/2025-02-18_07-24-10.png" class="screen" alt="">

    <p><b id="chapter2.8.2">Программная установка параметров отчёта</b></p>
    <p>Теперь разработаем специальную отчетную форму для автоматического запуска отчета и инициализации параметров при открытии формы.</p>
    <p>Для воплощения этих возможностей создадим основную форму отчета СборкаСистемныхБлоков. Создадим обработчик события формы ПриСозданииНаСервере и заполним его следующим образом:</p>
    <div class="code-style">
        <pre>
            &НаСервере
            Процедура ПриСозданииНаСервере(Отказ, СтандартнаяОбработка)
                Параметры.СформироватьПриОткрытии = Истина;
            КонецПроцедуры   
        </pre>
    </div>
    <p>В обработчике события параметр СформироватьПриОткрытии устанавливается в значение Истина. Таким образом, отчет будет формироваться сразу при открытии формы отчета.</p>
    <p>Теперь программно установим значения параметров НачалоПериода и КонецПериода и передадим их в отчет.</p>
    <p>Так как в схеме компоновки данных мы указали параметры НачалоПериода и КонецПериода в составе быстрых пользовательских настроек, то нам нужно создать обработчик события формы ПередЗагрузкойПользовательскихНастроекНаСервере, чтобы в нем изменить параметры пользовательских настроек перед их загрузкой в компоновщик:</p>
    <div class="code-style">
        <pre>
        &НаСервере
        Процедура ПередЗагрузкойПользовательскихНастроекНаСервере(Настройки)
            Настройки.Элементы[0].Значение = НачалоМесяца('20111210');
            Настройки.Элементы[1].Значение = КонецНедели('20120110');

            ПорядокНомер = Настройки.Элементы[2].Элементы[1];
            ПорядокНомер.Использование = Ложь;

            Если Настройки.Элементы[2].Элементы.Количество() &lt;= 2 Тогда
                ЭлементПорядка = Настройки.Элементы[2].Элементы.
                Добавить(Тип("ЭлементПорядкаКомпоновкиДанных"));
                ЭлементПорядка.Поле = Новый ПолеКомпоновкиДанных("Стоимость");
                ЭлементПорядка.Использование = Истина;
            КонецЕсли;
        КонецПроцедуры    
        </pre>
    </div>
    <img src="../img/1С-Для книги по СКД/2025-02-18_07-32-27.png" class="screen" alt="">
    <p>В параметре Настройки в обработчик передаются настройки варианта отчета, имеющие тип ПользовательскиеНастройкиКомпоновкиДанных.  Сначала мы устанавливаем значения параметров начала и конца отчетного периода (с индексами 0, 1 в коллекции элементов пользовательских настроек), причем можно не задавать для них признак использования, поскольку параметры используются всегда. Затем отключаем использование в сортировке (с индексом 2 в коллекции элементов пользовательских настроек) поля Номер. Его индекс в коллекции настроек сортировки равен 1. После этого добавляем поле Стоимость в коллекцию настроек сортировки.</p>
    <p>В случае, если пользовательские настройки отчета еще ни разу не сохранялись, их нужно задавать в обработчике события ПередЗагрузкойВариантаНаСервере:</p>
    <div class="code-style">
        <pre>
            &НаСервере
            Процедура ПередЗагрузкойВариантаНаСервере(Настройки)
                Настройки.ПараметрыДанных.УстановитьЗначениеПараметра("НачалоПериода", НачалоМесяца('20111210'));
                Настройки.ПараметрыДанных.УстановитьЗначениеПараметра("КонецПериода", КонецНедели('20120110'));
            КонецПроцедуры    
        </pre>
    </div>
    <p>В результате настройки, программно установленные при открытии формы отчета, загружаются в компоновщик настроек, и отчет формируется с заданными параметрами. На этом всё.</p>















    <h3 class="header-style2" id="chapter2.9">Пример 8. Продажа номенклатуры за указанный период.</h3>
    <img src="../img/1С-Для книги по СКД/2025-02-18_08-26-52.png" class="screen-2" alt="">
    <p>Для этого нам потребуется извлечь данные из оборотного регистра Продажи. Создадим новый объект конфигурации Отчет и назовем его ПродажиНоменклатуры. Откроем конструктор схемы компоновки данных и добавим новый набор данных – запрос. Откроем конструктор запроса.</p>

    <p><b id="chapter2.9.1">Извлечение данных по периодам</b></p>
    <p>В качестве источника данных для запроса выберем виртуальную таблицу регистра накопления Продажи.Обороты. Вызовем диалог параметров виртуальной таблицы. Для этого в списке Таблицы нужно нажать кнопку "Параметры виртуальной таблицы"</p>
    <p>В открывшемся окне параметров зададим значение параметра Периодичность – День:</p>
    <img src="../img/1С-Для книги по СКД/2025-02-18_08-41-40.png" class="screen-2" alt="">
    <p>В список полей перенесем поля из таблицы Продажи.Обороты: Период, Номенклатура, Контрагент, КоличествоОборот, СтоимостьОборот.</p>
    <p>На закладке "Объединения/Псевдонимы" изменим имя у поля КоличествоОборот на Остаток и СтоимостьОборот на Стоимость.</p>
    <p>Нажмем ОК и вернемся в конструктор схемы компоновки данных. Обратите внимание, что в тексте запроса указана периодичность выбираемых данных – День:</p>
    <div class="code-style">
        <pre>
            ИЗ РегистрНакопления.Продажи.Обороты(, , День, ) КАК ПродажиОбороты    
        </pre>
    </div>
    <p>Благодаря этому мы можем указать в полях запроса поле Период.</p>
    <p>Перейдем на закладку Ресурсы и определим доступные поля ресурсов отчета:</p>
    <img src="../img/1С-Для книги по СКД/2025-02-18_08-46-59.png" class="screen" alt="">
    <p>Для ресурса Количество в колонке "Рассчитывать по" нажмем кнопку выбора и укажем поле Номенклатура и НоменклатураИерархия:</p>
    <img src="../img/1С-Для книги по СКД/2025-02-18_08-49-23.png" class="screen-2" alt="">
    <p>Сделал вот картинку, на которой показано слева это расчёт итогов по "Номенклатуре" и "Номенклатуре иерархия", а справа не указано по чему рассчитывать, поэтому система рассчитывает по всем полям. Из-за этого в правой мы видим что появились итоги и общие и для контрагента по ресурсу Количество:</p>
    <img src="../img/1С-Для книги по СКД/2025-02-18_08-49-24.png" class="screen" alt="">
    <p>Это сделано для того, чтобы итоги по количеству выводились для конкретной номенклатуры и ее иерархических группировок, так как не имеет смысла складывать количество услуг с количеством комплектующих. Как я понял, имеется ввиду складывание их в общих итогах и по контрагенту не нужно.</p>
    <p>На закладке Параметры будем действовать так же, как и в предыдущих примерах. Для параметров НачалоПериода и КонецПериода в колонке Тип нажмем кнопку выбора и в нижней части окна редактирования типа данных установим "Состав даты" в значение Дата.</p>
    <p>Для параметра КонецПериода зададим значение колонки Выражение, чтобы данные за последний день отчета были включены в расчет:</p>
    <div class="code-style">
        <pre>
            КонецПериода(&КонецПериода, "День")   
        </pre>
    </div>
    <p>Определим структуру отчета. На закладке Настройки выделим корневой элемент Отчет и добавим в него группировку по полю Контрагент. Затем добавим вложенную в нее группировку Номенклатура. Выделим группировку Номенклатура и добавим вложенную в нее группировку Период. Затем на закладке "Выбранные поля" перенесем из списка доступных полей поля Количество, Стоимость:</p>
    <img src="../img/1С-Для книги по СКД/2025-02-18_09-05-44.png" class="screen-2" alt="">
    <p>Теперь усовершенствуем немного внешний вид отчета. На закладке Другие настройки дадим заголовок отчету – Продажи товаров и услуг.</p>
    <p>На закладке Наборы данных в списке полей набора данных в колонке Оформление зададим формат поля Количество:</p>
    <img src="../img/1С-Для книги по СКД/2025-02-18_09-08-38.png" class="screen" alt="">
    <p>Аналогично зададим формат поля Период:</p>
    <img src="../img/1С-Для книги по СКД/2025-02-18_09-09-34.png" class="screen" alt="">
    <p>В заключение предоставим пользователю возможность задавать отчетный период перед формированием отчета. Включим параметры "Начало периода" и "Конец периода" в состав быстрых пользовательских настроек. То есть эти настройки будут находиться непосредственно в отчетной форме. На закладке Параметры выделим каждый из параметров и нажмем кнопку Свойства элемента пользовательских настроек, расположенную в правом нижнем углу окна настроек. Установим флажок "Включать в пользовательские настройки" и оставим предложенное по умолчанию для свойства "Режим редактирования" значение "Быстрый доступ".</p>

    <p><b id="chapter2.9.2">Интерактивное оформление отчета</b></p>
    <p>Теперь предоставим пользователю возможность задавать отбор и условное оформление отчета. Для этого вернемся в конфигуратор и сначала создадим эти настройки в схеме компоновки данных отчета. Откроем закладку Настройки.</p>
    <p>На закладке Отбор установим отбор записей отчета по определенному виду номенклатуры. Для этого в списке доступных полей раскроем поле Номенклатура и выберем поле ВидНоменклатуры. Остальные параметры отбора оставим по умолчанию – Вид сравнения – Равно, а Правое значение – Перечисление.ВидыНоменклатуры.ПустаяСсылка. Условие отбора примет вид:</p>
    <img src="../img/1С-Для книги по СКД/2025-02-18_18-26-06.png" class="screen" alt="">
    <p>Включим настройку отбора в состав быстрых пользовательских настроек. Для этого нажмем кнопку "Свойства элемента пользовательских настроек", расположенную в правом нижнем углу окна настроек, и установим флажок "Включать в пользовательские настройки".</p>
    <p>На закладке "Условное оформление" выделим цветом записи отчета со стоимостью продаж меньше 3000 руб. Подробно процесс создания условного оформления описан в первом примере. Перечислим кратко наши действия. Далее не буду перечислять действияЮ там вроде понятно всё.</p>
    <p></p>
    <p></p>
    <p></p>
    <p></p>
    <p></p>











    <h3 class="header-style2" id="chapter2.9">Пример 8.</h3>
    <p></p>
    <p></p>
    <p></p>
    <p></p>
    <p></p>
    <p></p>
    <p></p>

    <p><b id="chapter2.9.1"></b></p>
    <p><b id="chapter2.9.2"></b></p>

</div>
