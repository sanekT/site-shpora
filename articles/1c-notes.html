<div class="wrap">
   
    <h2 class="header-style">Разные заметки</h2>

    <p><b>В форме элемента справочника</b></p>
    <ul class="list">
        <li><a href="#1f">Убираем отображение секунд в поле с типом Дата в режиме Время</a></li>
        <li><a href="#2f">Как отключить командную панель в форме или в табличной части формы</a></li>
        <li><a href="#3f">Запрещаем добавлять новые строки в табличную часть</a></li>
        <li><a href="#4f">Как убрать заголовок поля в форме и поставить вместо него картинку</a></li>
        <li><a href="#5f">Как у поля с типом дата в форме убрать открытие календаря</a></li>
        <li><a href="#6f">Как првильно удалить команду из ситемы, чтобы она не оставляла свои следы в форме</a></li>
        <li><a href="#"></a></li>
        <li><a href="#"></a></li>
    </ul> 
    <p><b>События модуля формы</b></p>
    <ul class="list">
        <li><a href="#form-event1">НачалоВыбора</a></li>
        <li><a href="#form-event2"></a></li>
        <li><a href="#form-event3"></a></li>
        <li><a href="#form-event4"></a></li>
        <li><a href="#"></a></li>
        <li><a href="#"></a></li>
        <li><a href="#"></a></li>
        <li><a href="#"></a></li>
    </ul>
    <p><b>События модуля объекта</b></p>
    <ul class="list">
        <li><a href="#1m">ОбработкаЗаполнения</a></li>
        <li><a href="#2m">ОбработкаПроверкиЗаполнения</a></li>
        <li><a href="#3m">ПриЗаписи</a></li>
        <li><a href="#4m">ОбработкаПроведения</a></li>
        <li><a href="#"></a></li>
        <li><a href="#"></a></li>
        <li><a href="#"></a></li>
        <li><a href="#"></a></li>
    </ul>
    <p><b>Методы подсчета секунд:</b></p>
    <ul class="list">
        <li><a href="#time">ПодключитьОбработчикОжидания(), ОтключитьОбработчикОжидания()</a></li>
    </ul>
    <p><b>Метод оповещения</b></p>
    <ul class="list">
        <li><a href="#1op">Оповестить(), ОбработкаОповещения()</a></li>
        <li><a href="#2op">ОповеститьОбИзменении()</a></li>
        <li><a href="#3op"></a></li>
        <li><a href="#4op"></a></li>
        <li><a href="#"></a></li>
        <li><a href="#"></a></li>
        <li><a href="#"></a></li>
        <li><a href="#"></a></li>
    </ul>
    <p><b>WebЦвета</b></p>
    <ul class="list">
        <li><a href="#1wz">Выбираем цвет</a></li>
        <li><a href="#2wz"></a></li>
        <li><a href="#3wz"></a></li>
        <li><a href="#4wz"></a></li>
        <li><a href="#"></a></li>
        <li><a href="#"></a></li>
        <li><a href="#"></a></li>
        <li><a href="#"></a></li>
    </ul>





    <h2 class="header-style" id="1f">Убираем отображение секунд в поле с типом Дата в режиме Время</h2>
    <p>У нас есть поле с типом Дата, в свойстве "СоставДаты" выбрано "Время". При вводе часов и минут нужно ввести и секунды. Выглядит по умолчанию это так:</p>
    <table border="1" style="margin-top: 0px;margin-bottom: 10px;font-size: 12px;">
        <tr>
            <td>Начало работы</td>
        </tr>
        <tr>
            <td>08:40:00</td>
        </tr>
    </table>
    <p>А должно стать так:</p>
    <table border="1" style="margin-top: 0px;margin-bottom: 40px;font-size: 12px;">
        <tr>
            <td>Начало работы</td>
        </tr>
        <tr>
            <td>08:40</td>
        </tr>
    </table>
    <p>Для этого используем свойство элемента формы <b>"Формат"</b> и <b>"ФорматРедактирования"</b> во вкладке "Основные". И там и там надо указать одинаковое значение. Справа по кнопке "..." откроем конструктор форматной строки, выберем вкладку Дата и в поле "Формат даты" укажем "ЧЧ:мм" и нажмём клавишу Ввод. Там же по центру в области "Пример", нам покажется результат. Ну и в самом низу будет значение формата, нахмём ОК и в свойства подставится это значение. Далее когда мы будем где то добавлять в поле дату, например, '000101010940', то по нашему установленному формату год, месяц, день и секунды отбросятся и останется только время 09:40, так что дату можно от балды написать, главное время правильное указать.</p>




    <h2 class="header-style" id="2f">Как отключить командную панель в форме или в табличной части формы</h2>
    <p>В форме слева в окне элементов выделяем командную панель, обычно она так и называется "Командная панель" и в её свойствах убираем галочку  <b>"Автозаполнение"</b>.</p>



    <h2 class="header-style" id="3f">Запрещаем добавлять/удалять новые строки в табличную часть</h2>
    <p>Выделаяем в форме табличну часть и в её свойствах во вкладке "Использование" снимаем галочку со свойства <b>"ИзменятьСоставСтрок"</b>. Это мы запрещаем добавление/удаление строк в пользовательском режиме.</p>



    <h2 class="header-style" id="4f">Как убрать заголовок поля в форме и поставить вместо него картинку</h2>
    <p>Выделаяем элемент в форме и в его свойствах в закладке "Основные" изменим значение свойства <b>"ПоложениеЗаголовка"</b> в положение "Нет". Чтобы задать картинку переходим на вкладку "Оформление" свойств и в свойстве <b>"КартинкаШапки"</b> выбираем картинку. Там во вкладке "ИзБиблиотеки" можно выбрать загрузку в конфигурацию с компа, либо выбрать стандартную зайдя в одноимённую вкладку.</p>



    <h2 class="header-style" id="5f">Как у поля с типом дата в форме убрать открытие календаря</h2>
    <p>Если поле имеет тип Дата, то у неё справа появится кнопка с картинкой календаря. Бывает случаи, когда не надо открывать календарь по клику на эту кнопку. Ну, например, в поле вводится время и нам не надо открывать календарь. Событие, которое отрабатывает по клику на эту кнопку называется &lt;НачалоВыбора>. Создадим обработчик для этого события нашего поля и в обработчик система сама в параметры передаст несколько аргументов. Один из аргументов это "СтандартнаяОбработка", присвоим этой переменной значение Ложь и всё, кнопка перестанет открывать календарь.</p>



    <h2 class="header-style" id="6f">Как првильно удалить команду из ситемы, чтобы она не оставляла свои следы в форме</h2>
    <p>У меня частенько было такое. Создаю команду у справочника или у документа, указываю группу, где она будет распологаться, это в основном в командной панели формы или в панели навигации формы. Затем указываю "Тип параметра команды", всё. Потом за ненадобностью удаляю эту команду из дерева конфигурации, позже открываю форму объекта, у которого до недавнево времени создавал и удалил команду и в форме вижу отображается эта команда. Также на закладке "Командный интерфейс" вижу остатки этой команду и на закладке "Команды" - "Глобальные команды" - "Параметрезуемые" тоже видны остатки команды. Как их убрать? Первой, это при удалении команды нужно очистить свойства "Группа" и "Тип параметра команды" от значечний, а потом удалять команду из дерева конфигурации. Второе, можно почистить кеш программы 1С.</p>
    <p>Как показали в интернете нужно зайти по этому адресу - C:\Users\Professional\AppData\Local\1C\1cv8t Папка AppData может быть скрыта. Заходим по этому адресу и удаляем там временные папки, выглядят они как набор букв и цифр - 34j5hkj34g5k34jg5ks8df9. Ещё один способ очистить кеш. При запуске 1с открывается список баз, создаём новую базу в списке и прикрепляем её к той же инфобазе, что и старая и просто даём ей новое название. Этот способ тоже помог.</p>




















    <h2 class="header-style" id="form-event1">НачалоВыбора</h2>
    <p>Возникает в момент нажатия кнопки выбора или клавиши F4. Также вызывается при активизации поля ввода, у которого включен режим быстрого выбора, мышью. Также вызывается при нажатии на надписи "Выбрать из списка" или по клавише F4 в выпадающем списке поля ввода формы клиентского приложения.</p>
    <p>Например, есть поле ввода Дата или Время с типом Дата. У такого поля по умолчанию справа от поля появляется картинка календаря, при клике на неё открывается календарь, т.е. при клике на эту картинку срабатывает событие &lt;НачалоВыбора>. Это событие срабатывает и на другие кнопки выбора.</p>
    <p><i>Пример 1</i></p>
    <p>Решим такую задачу, нужно в табличную часть документа добавить поле "СрокГодности". При начале выбора пользователю по кнопке выбора должен открыться список сроков годности товара в небольшом окне.</p>
    <p>Зададим для таб. части реквизит "СрокГодности" и укажем тип Дата, потому что получать мы будем список данных из регистра накопления "СрокГодности" и у них тип Дата. У реквизита по умолчанию справа от поля добавился значок календаря, это можно сказать реквизит уже систомой расширился кнопкой выбора. Если нужно самому добавить кнопку выбора для поля ввода, то добавить её можно в палитре свойств для этого реквизита в элементах формы. Свойство называется "Кнопка выбора", надо поставить ему значение Да.</p>
    <p>Теперь нужно обработать клик по этой кнопке, для этого есть событие "НачалоВыбора", задаём для кнопки обработчик этого события. В обработчике система нам предоставляет 3 аргумента: Элемент, ДанныеВыбора и СтандартнаяОбработка. Сейчас по клику на кнопку системой откроется окошко календаря, если мы хотим выводить что то своё, то нужно сразу задать аргументу СтандартнаяОбработка значение Ложь. Как я понимаю, то выводить по клику можно многое разное, можно выводить формы, диалоги, а можно ничего из этого не выводить, а просто заполнить аргумент ДанныеВыбора списком значений, потому что он принимает в себя только этот тип данных. Если мы заполним его списком значений, то систама сама выведет простенькое окошко со списком того, что в нём будет. В нашем случае нам подойдёт этот способоб со списком значений.</p>
    <p>Вот код из процедуры и функции, в процедуре мы обрабатываем клик и вызываем функцию на сервере, чтобы получить там данные из регистра остатки измерения "СрокГодности".</p>
    <p>Вкратце, что делается в коде, у нас списывается товар и его себестоимость партионным способом, а поле "СрокГодности" мы вводим, чтобы предоставить пользователю список из партий(сроков годностей) для данного товара, чтобы он мог выбрать конкретный срок годности и мы хотим, чтобы этот выбранный срок годности списывался первым, а затем уже в порядке других сроков годности:</p>
    <div class="code-style">
        <pre>
            --модуль формы документа "ПродажаТоваров"
            <span class="vue-b">&НаКлиенте
            Процедура ТоварыСрокГодностиНачалоВыбора(Элемент, ДанныеВыбора, СтандартнаяОбработка)
                СтандартнаяОбработка = Ложь;
                Если Объект.Проведен Тогда
                    Сообщить("В проведённом документе нельзя изменять партию товара");
                    Возврат;
                КонецЕсли;

                ТекДанные = Элементы.Товары.ТекущиеДанные;
                ДанныеВыбора = ПолучитьСрокиГодностиТовара(ТекДанные.Товар);
                
                Если ДанныеВыбора.Количество() = 0 Тогда
                    Сообщить("Сроки годности для товара отсутствуют");	
                КонецЕсли;		
            КонецПроцедуры    

            &НаСервереБезКонтекста
            Функция ПолучитьСрокиГодностиТовара(СсылкаНаТовар)
                Запрос = Новый Запрос;
                Запрос.Текст = 
                    <span class="vue-bl">"ВЫБРАТЬ РАЗЛИЧНЫЕ
                    |	ОстаткиСкоропортящихсяТоваровОстатки.СрокГодности КАК СрокГодности
                    |ИЗ
                    |	РегистрНакопления.ОстаткиСкоропортящихсяТоваров.Остатки(&ДатаДокумента, Товар = &Товар) КАК ОстаткиСкоропортящихсяТоваровОстатки"</span>;
                
                Запрос.УстановитьПараметр("ДатаДокумента", Объект.Дата);
                Запрос.УстановитьПараметр("Товар", СсылкаНаТовар);
                ТЗ = Запрос.Выполнить().Выгрузить(); 

                СЗ = Новый СписокЗначений;
                //тут мы загружаем в список значений массив с данными, который выгружает из себя таблица значений
                СЗ.ЗагрузитьЗначения(ТЗ.ВыгрузитьКолонку("СрокГодности"));
                Возврат СЗ;
            КонецФункции </span>
        </pre>
    </div>









    <h2 class="header-style" id="time">Методы подсчета секунд</h2>
    <p>В 1С есть методы ПодключитьОбработчикОжидания(), ОтключитьОбработчикОжидания(), это как SetTimeout() в JS. <b>Эти методы работают только на клиенте</b>. Вот пример использования:</p>
    <div class="code-style">
        <pre>
            &НаКлиенте
            Процедура ПриОткрытии(Отказ)
                ПодключитьОбработчикОжидания("ОбновитьСписокАвтоматически", 60, Ложь);
            КонецПроцедуры

            &НаКлиенте
            Процедура ПриЗакрытии(ЗавершениеРаботы)
                ОтключитьОбработчикОжидания("ОбновитьСписокАвтоматически");
            КонецПроцедуры

            &НаКлиенте
            Процедура ОбновитьСписокАвтоматически()
                Элементы.ЗаказыКлиентов.Обновить(); 
            КонецПроцедуры
        </pre>
    </div>
    <p>На форме есть динамический список, который отображает список документов "ЗаказКлиента". При открытии формы включается сразу метод подсчета и в параметрах указываем, чтобы через 60 секунд был вызвана процедура ОбновитьСписокАвтоматически(). При закрытии формы отключаем обязательно этот метод. Такм способом мы обновляем ДС каждые 60 сек.</p>
    <p>3й параметр метода это однократно или многократно повторять вызов.</p>










    <h2 class="header-style" id="1m">&lt;ОбработкаЗаполнения></h2>
    <p>1) Есть справочник "Подразделения". В пользовательской части хотим при создании нового элемента справочника заполнять какие то поля в новом элементе автоматически. Но нам надо только один раз при создании нового элемента заполнить и всё, при последующих открытиях элемента уже не надо заполнять ничего, потому что заполненые данные запишутся в базу и при следующем открытии данные заполнятся из базы.Таким способом мы помогаем пользователю в заполнении данными формы элемента при её создании.</p>
    <p>Для этих целей, и других, есть событие &lt;ОбработкаЗаполнения> в модуле объекта справочника,  документа. Это событие срабатывает в миг создания нового элемента справочника.</p>
    <p><span class="vue-r">Важно. Естьи другие способы заполнить одноразово форму.</span></p>
    <p>2) Другой пример использования этого события находится в разделе работы со справочниками в статье про добавление автоматом галочки в поле Услуга для создаваемых элементов.</p>


    <h2 class="header-style" id="2m">&lt;ОбработкаПроверкиЗаполнения></h2>
    <p>Пример с этим событием рассматривается в разделе работы со справочником в статье про проверку заполнения реквизитов.</p>


    <h2 class="header-style" id="3m">&lt;ПриЗаписи></h2>
    <p>Возникает при записи объекта. Процедура-обработчик вызывается после записи объекта в базу данных, но до окончания транзакции записи.</p>


    <h2 class="header-style" id="4m">&lt;ОбработкаПроведения></h2>
    <p>Возникает при проведении документа. Выполняется после записи документа в БД.</p>













    <h2 class="header-style" id="1op">Как работает метод Оповестить()</h2>
    <p><b>Методы Оповестить() и ОбработкаОповещения() это чисто клиентские методы.</b></p>
    <p>Метод Оповещение очень похож по своей работе на метод во фреймворке VUE - emit(). Emit создаёт событие, название которому мы сами придумываем и параметры(не обязательно) и посылает это событие вверх к родителю. Родитель перехватывает это событие и что то делает. С оповещением похожая работа. Этот метод также создаёт событие, название мы сами придумываем. Этот метод запускает, например, форма документа в обработчике ПослеЗаписи(мы заполнили форму и нажали "Записать", данные формы пошли записываться в базу и сразу же сработало событие "ПослеЗаписи"). Метод посылает сигнал всем открытым формам на данный миг работы. Другие формы могут поймать этот сигнал через событие "ОбработкаОповещения". В обработчике события "ОбработкаОповещения" 1м параметром передаётся ИмяСобытия, там будет имя события от оповещения, которое посылает сигнал. Не обязательно, что там нужное нам имя события, может этот сигнал для другой формы, поэтому нужно делать проверку на нужное нам имя события. Если имя то что нам нужно, то обрабатываем этот сигнал.</p>
    <p>Если нужно посмотреть как это работает, то в этом видео https://www.youtube.com/watch?v=spclh5KlqYI&t=3287s  начиная с 02:35:40</p>
    <p>Пример работы с методом Оповестить() есть в разделе "Работа с файлами" в статье "Пишем в текстовый файл TXT способ 3". Иван в видео говорит, что этот метод создаётся при событии "ПослеЗаписи" формы, но у меня в примере я этот метод Оповестить вызывают просто из обработчика кнопки и он даёт сигнал другим формам. Может пока чего-то не понимаю.</p>



    <h2 class="header-style" id="2op">Как работает метод ОповеститьОбизменении()</h2> 
    <p>Когда мы на сервере обновили данные справочника, документа или регистра и вернулись на клиент то формы списка не обновляются на новые данные самостоятельно, им нужно указать, чтобы они обновились. Для этого есть эта процедура, которая принимает как единичное значение, так и массив значений. В значениях ссылка на изменённый объект. Процедура оповещает все динамические списки, которые открыты на клиенте и которые могут содержать эту ссылку, о том, что им нужно обновить свои данные</p>
    <p>Даже если передать ссылку на объект, который не менялся, то всё равно динамические списки обновятся.</p>       















    <h2 class="header-style" id="1wz">Выбираем цвет</h2>
    <p>Свойство глобального контекста <b>WebЦвета</b> содержит набор разных цветов, которые можно получить через точку. Доступен и на клиенте и на сервере. Цвета имеют тип "Цвет". Вот например, я пытался получить цвет на сервере через конструктор Новый Цвет(), у меня не вышло, говорят, что на сервере не доступен этот класс, а вот webцвета спокойно можно использовать.</p>






</div>